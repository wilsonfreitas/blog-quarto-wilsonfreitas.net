{
  "hash": "0b6ac52a88dfcbdb7f92d6a381ebf380",
  "result": {
    "markdown": "---\ntitle: \"16 anos de Curva Prefixada\"\ndescription: |\n  Observando a dinâmica da estrutura a termo de juros no Brasil e nos Estados\n  Unidos ao longo dos últimos 16 anos.\nauthor:\n  - name: Wilson Freitas\n    url: {}\ndate: 2022-06-18\ncategories:\n  - R\n  - fixedincome\n  - rb3\n  - opendata\n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(rb3)\nlibrary(bizdays)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'bizdays'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:stats':\n\n    offset\n```\n:::\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(fixedincome)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'fixedincome'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:dplyr':\n\n    first, last\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\n```\n:::\n\n::: {.cell hash='16-anos-de-curva-prefixada_cache/html/load-data_a7facff9b7bfc2beeeaafaa4f9dd11b4'}\n::: {.cell-output .cell-output-stderr}\n```\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/080e2cb9e1e3eb735c8d6dc0c3194e86-parsed.rds that returns NULL.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/1510e962a774e004d248683fd79b1374-parsed.rds that returns NULL.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n⠙ Fetching data points 199/4054 | ■■                                 5% | ETA: …\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/d8595c0a5e74dbf205b6146dcfd9ba03-parsed.rds that returns NULL.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n⠙ Fetching data points 199/4054 | ■■                                 5% | ETA: …\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/18d6b35dd6d2aeb821e9fd9aa07dbc00-parsed.rds that returns NULL.\n⠙ Fetching data points 199/4054 | ■■                                 5% | ETA: …\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/a4320cd9f9477bf8e373e3b6ae21374c-parsed.rds that returns NULL.\n⠙ Fetching data points 199/4054 | ■■                                 5% | ETA: …\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/7b3f5d9f3c7f40d438cfb10527e854b3-parsed.rds that returns NULL.\n⠙ Fetching data points 199/4054 | ■■                                 5% | ETA: …\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/427f326863e9f7e25213268f6330a79e-parsed.rds that returns NULL.\n⠙ Fetching data points 199/4054 | ■■                                 5% | ETA: …\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/1dcfe447ea262e7a22e5e30b1a90ee3a-parsed.rds that returns NULL.\n⠙ Fetching data points 199/4054 | ■■                                 5% | ETA: …\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/96156a38c615d754cc941aa54a434f51-parsed.rds that returns NULL.\n⠙ Fetching data points 199/4054 | ■■                                 5% | ETA: …\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/6c4930212718a60fa6a9094d8c2461a2-parsed.rds that returns NULL.\n⠙ Fetching data points 199/4054 | ■■                                 5% | ETA: …\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/1adc35776bcd63801ee57ce3f8f65667-parsed.rds that returns NULL.\n⠙ Fetching data points 199/4054 | ■■                                 5% | ETA: …\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/99ea0e88b0cc34c835f52cdd0049a999-parsed.rds that returns NULL.\n⠙ Fetching data points 199/4054 | ■■                                 5% | ETA: …\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/479f5927bd05578ed52ef2629cab7056-parsed.rds that returns NULL.\n⠙ Fetching data points 199/4054 | ■■                                 5% | ETA: …\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/631a5c5accec13616555c0a78a9aa7f2-parsed.rds that returns NULL.\n⠙ Fetching data points 199/4054 | ■■                                 5% | ETA: …\n⠸ Fetching data points 754/4054 | ■■■■■■■                           19% | ETA: …\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/dcd47b0a844e38db6b61b9b63c22f6a3-parsed.rds that returns NULL.\n⠸ Fetching data points 754/4054 | ■■■■■■■                           19% | ETA: …\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/60d4032989dff49ad0d0c1c9076aff1a-parsed.rds that returns NULL.\n⠸ Fetching data points 754/4054 | ■■■■■■■                           19% | ETA: …\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/5674c7c054b857c8627674b061592516-parsed.rds that returns NULL.\n⠸ Fetching data points 754/4054 | ■■■■■■■                           19% | ETA: …\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/4faa28330b3585f9be27a543dea59d86-parsed.rds that returns NULL.\n⠸ Fetching data points 754/4054 | ■■■■■■■                           19% | ETA: …\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/f7646668172c0f4a610906fa21a2751c-parsed.rds that returns NULL.\n⠸ Fetching data points 754/4054 | ■■■■■■■                           19% | ETA: …\n⠼ Fetching data points 1058/4054 | ■■■■■■■■■                         26% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/c8c023431cc0d19c3c95942d3a27b73a-parsed.rds that returns NULL.\n⠼ Fetching data points 1058/4054 | ■■■■■■■■■                         26% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/134bc1ec7d0a352b48354d5af68038f0-parsed.rds that returns NULL.\n⠼ Fetching data points 1058/4054 | ■■■■■■■■■                         26% | ETA:…\n⠴ Fetching data points 1364/4054 | ■■■■■■■■■■■                       34% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/117745dce5d5cb4d890e2230f5cca206-parsed.rds that returns NULL.\n⠴ Fetching data points 1364/4054 | ■■■■■■■■■■■                       34% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/68a26da34d9f76552f0305d314d843ef-parsed.rds that returns NULL.\n⠴ Fetching data points 1364/4054 | ■■■■■■■■■■■                       34% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/c465388767a41742d3153041e2aa95f4-parsed.rds that returns NULL.\n⠴ Fetching data points 1364/4054 | ■■■■■■■■■■■                       34% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/2b1a1b2e121587ad6e9c4d8bf75a69b3-parsed.rds that returns NULL.\n⠴ Fetching data points 1364/4054 | ■■■■■■■■■■■                       34% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/03111a15447935a196fccedf36243f1e-parsed.rds that returns NULL.\n⠴ Fetching data points 1364/4054 | ■■■■■■■■■■■                       34% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/199c548401f10e0252e2bef33605625a-parsed.rds that returns NULL.\n⠴ Fetching data points 1364/4054 | ■■■■■■■■■■■                       34% | ETA:…\n⠦ Fetching data points 1652/4054 | ■■■■■■■■■■■■■                     41% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/ae8212a0126585478946aa8eaa3c897d-parsed.rds that returns NULL.\n⠦ Fetching data points 1652/4054 | ■■■■■■■■■■■■■                     41% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/769bdbf6414d30e8695c2559b04f9313-parsed.rds that returns NULL.\n⠦ Fetching data points 1652/4054 | ■■■■■■■■■■■■■                     41% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/2493a7b1b75c928059789157a2afaed6-parsed.rds that returns NULL.\n⠦ Fetching data points 1652/4054 | ■■■■■■■■■■■■■                     41% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/4814b715cfe7655e14c1569734485b13-parsed.rds that returns NULL.\n⠦ Fetching data points 1652/4054 | ■■■■■■■■■■■■■                     41% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/d6a37e4f3970da2216baeeade0e9b962-parsed.rds that returns NULL.\n⠦ Fetching data points 1652/4054 | ■■■■■■■■■■■■■                     41% | ETA:…\n⠧ Fetching data points 1892/4054 | ■■■■■■■■■■■■■■■                   47% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/41aa4082eeec395b7feb3a956bfb1a87-parsed.rds that returns NULL.\n⠧ Fetching data points 1892/4054 | ■■■■■■■■■■■■■■■                   47% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/ced216837f9da99582aadad11ca0773d-parsed.rds that returns NULL.\n⠧ Fetching data points 1892/4054 | ■■■■■■■■■■■■■■■                   47% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/be44ed0ec4186fc2fafdb47cc9614e87-parsed.rds that returns NULL.\n⠧ Fetching data points 1892/4054 | ■■■■■■■■■■■■■■■                   47% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/a2a2abdbb71c86a1941da637bda10f45-parsed.rds that returns NULL.\n⠧ Fetching data points 1892/4054 | ■■■■■■■■■■■■■■■                   47% | ETA:…\n⠇ Fetching data points 2146/4054 | ■■■■■■■■■■■■■■■■■                 53% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/f80d336c7034dca6d280d5300621956a-parsed.rds that returns NULL.\n⠇ Fetching data points 2146/4054 | ■■■■■■■■■■■■■■■■■                 53% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/1921f576fd77dc68dcc361d921f7d33f-parsed.rds that returns NULL.\n⠇ Fetching data points 2146/4054 | ■■■■■■■■■■■■■■■■■                 53% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/56ea48877c8a76f9400c87be31f8028e-parsed.rds that returns NULL.\n⠇ Fetching data points 2146/4054 | ■■■■■■■■■■■■■■■■■                 53% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/3a377df9574995fcea76277cf66229a4-parsed.rds that returns NULL.\n⠇ Fetching data points 2146/4054 | ■■■■■■■■■■■■■■■■■                 53% | ETA:…\n⠏ Fetching data points 2382/4054 | ■■■■■■■■■■■■■■■■■■■               59% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/fbfb62bc5bf85827f6a379f1f90ef457-parsed.rds that returns NULL.\n⠏ Fetching data points 2382/4054 | ■■■■■■■■■■■■■■■■■■■               59% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/f167df23f63004a18ce9b42308f40f82-parsed.rds that returns NULL.\n⠏ Fetching data points 2382/4054 | ■■■■■■■■■■■■■■■■■■■               59% | ETA:…\n⠋ Fetching data points 2662/4054 | ■■■■■■■■■■■■■■■■■■■■■             66% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/125bfbd76261eb5f9fb51caa162ff9d4-parsed.rds that returns NULL.\n⠋ Fetching data points 2662/4054 | ■■■■■■■■■■■■■■■■■■■■■             66% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/1ebdf89b3c235780cffb64e60a8ef85a-parsed.rds that returns NULL.\n⠋ Fetching data points 2662/4054 | ■■■■■■■■■■■■■■■■■■■■■             66% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/26bd082dfaf44bac451a55a5662a2fd6-parsed.rds that returns NULL.\n⠋ Fetching data points 2662/4054 | ■■■■■■■■■■■■■■■■■■■■■             66% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/fa3875cac6688b226e699f5d1be8316e-parsed.rds that returns NULL.\n⠋ Fetching data points 2662/4054 | ■■■■■■■■■■■■■■■■■■■■■             66% | ETA:…\n⠙ Fetching data points 2921/4054 | ■■■■■■■■■■■■■■■■■■■■■■■           72% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/9bae55e162e6d8634116689db1ced4de-parsed.rds that returns NULL.\n⠙ Fetching data points 2921/4054 | ■■■■■■■■■■■■■■■■■■■■■■■           72% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/93cedd658d260591bf4b89f2a301d3a6-parsed.rds that returns NULL.\n⠙ Fetching data points 2921/4054 | ■■■■■■■■■■■■■■■■■■■■■■■           72% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/e5e67b76c7684e229e92ebf31defddb0-parsed.rds that returns NULL.\n⠙ Fetching data points 2921/4054 | ■■■■■■■■■■■■■■■■■■■■■■■           72% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/0cb75e7608014434b910d0f6eed469d6-parsed.rds that returns NULL.\n⠙ Fetching data points 2921/4054 | ■■■■■■■■■■■■■■■■■■■■■■■           72% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/60f1cac688426f3548bde90067ff6b57-parsed.rds that returns NULL.\n⠙ Fetching data points 2921/4054 | ■■■■■■■■■■■■■■■■■■■■■■■           72% | ETA:…\n⠹ Fetching data points 3197/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■         79% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/120615d3cc3e40c40f3da1bc530ee976-parsed.rds that returns NULL.\n⠹ Fetching data points 3197/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■         79% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/efd149e6dea0edb26cab44371a11bd9c-parsed.rds that returns NULL.\n⠹ Fetching data points 3197/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■         79% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/89377ffb8213ffc3f60c414db22f5194-parsed.rds that returns NULL.\n⠹ Fetching data points 3197/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■         79% | ETA:…\n⠸ Fetching data points 3494/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■       86% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/d025aaaff9277d60fad129c2a947d288-parsed.rds that returns NULL.\n⠸ Fetching data points 3494/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■       86% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/e3685c842eb0d208cb90f72e16d525a7-parsed.rds that returns NULL.\n⠸ Fetching data points 3494/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■       86% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/97177d9d007efd4de20b3ce969ced4cb-parsed.rds that returns NULL.\n⠸ Fetching data points 3494/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■       86% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/42878d933ac57df3374a4bafbd048175-parsed.rds that returns NULL.\n⠸ Fetching data points 3494/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■       86% | ETA:…\n⠼ Fetching data points 3752/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■     93% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/2b812e5506888e8c931cb540ae305b09-parsed.rds that returns NULL.\n⠼ Fetching data points 3752/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■     93% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/55ca03ce272d07db0c5ac475424add1a-parsed.rds that returns NULL.\n⠼ Fetching data points 3752/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■     93% | ETA:…\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Automatic coercion from double to character was deprecated in purrr 1.0.0.\nℹ Please use an explicit call to `as.character()` within `map_chr()` instead.\nℹ The deprecated feature was likely used in the rb3 package.\n  Please report the issue at <https://github.com/wilsonfreitas/rb3/issues>.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n⠴ Fetching data points 3931/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■    97% | ETA:…\n⠦ Fetching data points 3938/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■    97% | ETA:…\n⠧ Fetching data points 3945/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■    97% | ETA:…\n⠇ Fetching data points 3950/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■    97% | ETA:…\n⠏ Fetching data points 3956/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■    98% | ETA:…\n⠋ Fetching data points 3962/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■    98% | ETA:…\n⠙ Fetching data points 3968/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■    98% | ETA:…\n⠹ Fetching data points 3973/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■    98% | ETA:…\n⠸ Fetching data points 3979/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■    98% | ETA:…\n⠼ Fetching data points 3985/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■    98% | ETA:…\n⠴ Fetching data points 3991/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■   98% | ETA:…\n⠦ Fetching data points 3997/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■   99% | ETA:…\n⠧ Fetching data points 4003/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■   99% | ETA:…\n⠇ Fetching data points 4009/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■   99% | ETA:…\n⠏ Fetching data points 4014/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■   99% | ETA:…\n! Removed C:\\Users\\wilso\\R\\rb3-cache/AjustesDiarios/8efc8696de8165690ea4be9abff3bfe8.html - It hasn't valid content.\n⠏ Fetching data points 4014/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■   99% | ETA:…\n⠋ Fetching data points 4020/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■   99% | ETA:…\n⠙ Fetching data points 4026/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■   99% | ETA:…\n⠹ Fetching data points 4032/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■   99% | ETA:…\n⠸ Fetching data points 4037/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■  100% | ETA:…\n⠼ Fetching data points 4042/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■  100% | ETA:…\n⠴ Fetching data points 4048/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■  100% | ETA:…\n⠦ Fetching data points 4053/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■  100% | ETA:…\n```\n:::\n:::\n\n\nO pacote {rb3} faz extrações de dados do site da B3.\nTemos diversas informações disponíveis no site inclusive o histórico de diversos dados.\n\nUm conjunto de dados que mais utilizo são os preços de ajuste dos contratos futuros.\nEste histórico é um dos mais antigos disponível.\n\nVou baixar todo o histórico de contratos futuros desde 2007.\nA partir dos preços de ajuste é possível construir o histórico de curvas prefixadas.\nDepois vou fazer uma segmentação pelo ano da data de referência para que seja possível\nvisualizar, para cada ano, todo o espectro de curvas no ano.\n\nVou começar baixando todos os dados desde 2007 até a última data disponível.\nPara isso vou utilizar a função `rb3::futures_mget`.\n*Isso leva um bom tempo!*\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- futures_mget(\n  first_date = \"2007-01-01\",\n  last_date = preceding(Sys.Date() - 1, \"Brazil/ANBIMA\")\n)\n```\n:::\n\n\nÉ necessário filtrar os contratos futuros de DI1 para construir a curva prefixada.\n\n\n::: {.cell hash='16-anos-de-curva-prefixada_cache/html/unnamed-chunk-2_d314a97a7e36c3dea494df2d60ef8c52'}\n\n```{.r .cell-code}\ndf_di1 <- df |> filter(commodity == \"DI1\")\n```\n:::\n\n\nPara construir a curva prefixada é necessário obter as datas de vencimento dos contratos\nfuturos.\nPara isso utilizo a função `rb3::maturity2date` que converte o código de vencimento\nem data.\nAdicionalmente faço o ajuste da data de referência criando a coluna `fixing`,\ncalculo os dias úteis (coluna `business_days`) e a taxa de juros com base no preço de ajuste `price`\ngerando a coluna `adjusted_tax`.\n\n\n::: {.cell hash='16-anos-de-curva-prefixada_cache/html/unnamed-chunk-3_e03c89c92620ac8e0d19bb29cf1249d5'}\n\n```{.r .cell-code}\ndf_di1_futures <- df_di1 |>\n  mutate(\n    maturity_date = maturity2date(maturity_code),\n    fixing = following(maturity_date, \"Brazil/ANBIMA\"),\n    business_days = bizdays(refdate, fixing, \"Brazil/ANBIMA\"),\n    adjusted_tax = implied_rate(\"discrete\", business_days / 252, 100000 / price)\n  ) |>\n  filter(business_days > 0)\n```\n:::\n\n\nTermino filtrando as linhas com `business_days` maior que zero, pois não me interessam os futuros\nna data de vencimento.\n\nAgora vamos gerar a visualização com ggplot2.\n\n\n::: {.cell fig.fig.width='8' preview='true' hash='16-anos-de-curva-prefixada_cache/html/unnamed-chunk-4_f8ddc6cce2483904723cb2238e4d92c7'}\n\n```{.r .cell-code}\ndf_di1_futures |>\n  mutate(year = as.integer(format(refdate, \"%Y\"))) |>\n  ggplot(aes(\n    x = business_days, y = adjusted_tax,\n    group = refdate\n  )) +\n  geom_line(alpha = 0.2) +\n  facet_wrap(. ~ year) +\n  labs(\n    x = \"Dias Úteis\", y = \"Taxas\",\n    title = \"16 anos de Curva Prefixada\",\n    subtitle = \"Curvas construídas a partir dos preços de ajuste dos contratos Futuros DI1\",\n    caption = \"Fonte: B3 (obtidos com \\U1F4E6 rb3) - wilsonfreitas\"\n  ) +\n  scale_y_continuous(labels = scales::percent)\n```\n\n::: {.cell-output-display}\n![](16-anos-de-curva-prefixada_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nCurioso ver a mudança de *shape* da curva entre os anos e ao longo de cada ano.\nUma coisa curiosa é observar os anos de 2016, 2017 e 2018.\n2016/2017 foram os anos do impechemant da presidente Dilma.\nEm 2016 a parte curta da curva variou pouco e a parte longa variou muito.\nEm 2017 aconteceu o oposto, a parte curta da curva variou mais que a parte longa da curva.\nNestes anos, as mudanças afetam diretamente o *shape* da curva.\nEm 2018, o ano da eleição e da facada do Bolsonaro, há uma grande variação na parte longa\nda curva, mas sem alterar o *shape* da curva.\nAinda é possível avaliar o comportamento da curva com os demais eventos políticos e econômicos.\nEm 2021, por exemplo, onde ocorreu uma elevação da taxa SELIC e uma piora do cenário fiscal,\ntemos um espectro muita amplo do *shape* da curva.\n\nÉ possível construir uma visualização equivalente utilizando dados da curva americana que podem\nser obtidos com o pacote Quandl.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(Quandl)\n\nyc_all <- Quandl(\"USTREASURY/YIELD\")\n```\n:::\n\n::: {.cell hash='16-anos-de-curva-prefixada_cache/html/quandl-data-load_bf4d257fe190e5e027b62621e58432e2'}\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: xts\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: zoo\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'zoo'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    as.Date, as.Date.numeric\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'xts'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:fixedincome':\n\n    first, last\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:dplyr':\n\n    first, last\n```\n:::\n:::\n\n\nOs dados vem no formato *wide* onde cada coluna representa um vértice e cada linha uma curva.\nDessa maneira, faço a conversão dos dados para o formato longo com a função `tidyr::pivot_longer`.\n\n\n::: {.cell hash='16-anos-de-curva-prefixada_cache/html/unnamed-chunk-5_3fb6e958fc22a8109218b17040521915'}\n\n```{.r .cell-code}\nyc_all <- as_tibble(yc_all)\n\nyc_all_longer <- yc_all |>\n  tidyr::pivot_longer(cols = `1 MO`:`30 YR`)\n\nyc_all_longer\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 99,480 × 3\n   Date       name  value\n   <date>     <chr> <dbl>\n 1 2023-02-17 1 MO   4.64\n 2 2023-02-17 2 MO   4.81\n 3 2023-02-17 3 MO   4.84\n 4 2023-02-17 6 MO   4.99\n 5 2023-02-17 1 YR   5   \n 6 2023-02-17 2 YR   4.6 \n 7 2023-02-17 3 YR   4.33\n 8 2023-02-17 5 YR   4.03\n 9 2023-02-17 7 YR   3.95\n10 2023-02-17 10 YR  3.82\n# … with 99,470 more rows\n```\n:::\n:::\n\n\nAqui faço o tratamento dos dados para converter os prazos em números, considerando meses de 30\ndias e anos de 360 dias.\n\n\n::: {.cell hash='16-anos-de-curva-prefixada_cache/html/unnamed-chunk-6_d6871708378f3aea4881ce3a6bdb51bc'}\n\n```{.r .cell-code}\nlibrary(stringr)\n\nn <- str_match(yc_all_longer$name, \"\\\\d+\") |> as.numeric()\np <- str_match(yc_all_longer$name, \"(MO|YR)$\")[, 1]\nyc_all_longer$days <- ifelse(p == \"MO\", 30, 360) * n\n\nyc_all_longer\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 99,480 × 4\n   Date       name  value  days\n   <date>     <chr> <dbl> <dbl>\n 1 2023-02-17 1 MO   4.64    30\n 2 2023-02-17 2 MO   4.81    60\n 3 2023-02-17 3 MO   4.84    90\n 4 2023-02-17 6 MO   4.99   180\n 5 2023-02-17 1 YR   5      360\n 6 2023-02-17 2 YR   4.6    720\n 7 2023-02-17 3 YR   4.33  1080\n 8 2023-02-17 5 YR   4.03  1800\n 9 2023-02-17 7 YR   3.95  2520\n10 2023-02-17 10 YR  3.82  3600\n# … with 99,470 more rows\n```\n:::\n:::\n\n\nAgora fazemos a visualização.\n\n\n::: {.cell fig.fig.width='8' hash='16-anos-de-curva-prefixada_cache/html/unnamed-chunk-7_07c1f9f3397ab6e69012e9d9bb9b91ee'}\n\n```{.r .cell-code}\nyc_all_longer |>\n  mutate(\n    year = as.integer(format(Date, \"%Y\")),\n    value = value / 100\n  ) |>\n  filter(year >= 2007) |>\n  ggplot(aes(\n    x = days, y = value,\n    group = Date\n  )) +\n  geom_line(alpha = 0.2) +\n  facet_wrap(. ~ year) +\n  labs(\n    x = \"Dias Corridos\", y = \"Taxas\",\n    title = \"16 anos de Curva Prefixada Americana\",\n    caption = \"Fonte: US Treasury (obtidos com \\U1F4E6 Quandl) - wilsonfreitas\"\n  ) +\n  scale_y_continuous(labels = scales::percent)\n```\n\n::: {.cell-output-display}\n![](16-anos-de-curva-prefixada_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nJá na curva americana, a dinâmica é muito mais bem comportada.\nA parte longo costuma oscilar, mas mantendo a dinâmica.\nOs anos 2007, 2008 e 2020, onde tivemos crise do subprime e COVID, trouxeram mais volatilidade.",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}