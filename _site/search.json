[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "Sobre",
    "section": "",
    "text": "Eu sou Wilson Freitas.\n\nF√≠sico\nPai de 2 meninos (j√° grandinhos!)\nCorredor\nPadeiro\nGosto de fazer contas\n\nT√¥ tentando deixar um legado em pacotes em R e Python para tornar a vida das pessoas menos miser√°vel."
  },
  {
    "objectID": "bancodedados.html",
    "href": "bancodedados.html",
    "title": "Construindo Banco de Dados Financeiros",
    "section": "",
    "text": "Link para o Curso\nConstruir um banco de dados financeiros com um processo 100% autom√°tico desenvolvido na linguagem R.\nEsta √© a proposta desse curso!\nQuem faz an√°lises com dados financeiros sofre com informa√ß√µes espalhadas em diversos lugares, em formatos distintos e atualizadas em momentos diferentes.\nA constru√ß√£o de um reposit√≥rio √∫nico, onde as informa√ß√µes s√£o padronizadas e podem ser acessadas de maneira simples em um banco de dados √∫nico.\nO curso Construindo Banco de Dados Financeiros tem uma abordagem 100% m√£o na massa para a constru√ß√£o de um banco de dados a partir da coleta automatizada de diversos dados do mercado financeiro.\nOs dados s√£o referentes a diversos contratos negociados no mercado e indicadores financeiros necess√°rios para tarefas apre√ßamento e c√°lculo de risco.\nTodo o conte√∫do do curso √© totalmente desenvolvido com a linguagem de programa√ß√£o e an√°lise de dados R. Passa por diversos pacotes para processamento de dados, leitura de arquivos: texto, json, csv, xml, opera√ß√µes em banco de dados relacional e consumo de APIs on-line.\nO objetivo √© construir um sistema DO ZERO para automatizar o processo de download de dados financeiros de diversas fontes do mercado financeiro (B3, ANBIMA, BACEN, TesouroDireto), criando um reposit√≥rio de dados para o processamento e o enriquecimento dos dados para que sejam usados em diversas an√°lises.\nSer√£o desenvolvidos os processos de download e armazenamento dos dados brutos e, posteriormente, o processo de enriquecimento que transforma os dados brutos em dados estruturados.\nNo fim, ser√£o criadas fun√ß√µes no R para consumir os dados estruturados e utiliz√°-los nas mais diversas an√°lises.\nDura√ß√£o: 07:52:25"
  },
  {
    "objectID": "bancodedados.html#m√≥dulo-1-processo-de-downloads-e-tratamento-de-dados",
    "href": "bancodedados.html#m√≥dulo-1-processo-de-downloads-e-tratamento-de-dados",
    "title": "Construindo Banco de Dados Financeiros",
    "section": "M√≥dulo 1: Processo de Downloads e Tratamento de Dados",
    "text": "M√≥dulo 1: Processo de Downloads e Tratamento de Dados\n\nDesenvolvemos um processo totalmente em R onde o usu√°rio pode, atrav√©s de arquivos de configura√ß√£o YAML, definir os dados que ser√£o baixados e inclu√≠dos no banco de dados.\nO fato do c√≥digo ser 100% R permite que, com o passar das aulas, o aluno compreenda cada passo do processo e seja capaz de realizar suas eventuais interven√ß√µes.\n\n\n\nDura√ß√£o: 00:57:50\n\n\n\n\n\n#\nAula\nDura√ß√£o\n\n\n\n\n1\nApresentando o Projeto\n05:09\n\n\n2\nEstrutura de diret√≥rios do Projeto\n02:06\n\n\n3\nArquivos YAML\n03:18\n\n\n4\nPacote yaml\n03:03\n\n\n5\nPacote logger\n04:17\n\n\n6\nConfigura√ß√£o do Projeto\n06:12\n\n\n7\nCria√ß√£o do MeuDB\n06:53\n\n\n8\nEntendendo a fun√ß√£o load_configs\n03:40\n\n\n9\nExecutando o Pipeline de dados\n04:55\n\n\n10\nEntendendo a fun√ß√£o download_data\n06:04\n\n\n11\nFun√ß√µes de download espec√≠ficas\n03:24\n\n\n12\nWebscraping do CDI da B3\n07:34\n\n\n13\nEncerramento do M√≥dulo 1\n01:10\n\n\n\n\n\n\nDownload e processamento da Taxa DI (CDI) e do √çndice DI (IDI) da B3\nA Taxa DI √© uma das taxa de juros mais importantes utilizadas no Brasil. √â a taxa de juros utilizada em diversos contratos negociados no mercado financeiro, como CDBs, Deb√™ntures, LCI, LCA e outros."
  },
  {
    "objectID": "bancodedados.html#m√≥dulo-2-banco-para-armazenamento-dos-dados-mini-tutorial-de-sql",
    "href": "bancodedados.html#m√≥dulo-2-banco-para-armazenamento-dos-dados-mini-tutorial-de-sql",
    "title": "Construindo Banco de Dados Financeiros",
    "section": "M√≥dulo 2: Banco para Armazenamento dos Dados (Mini Tutorial de SQL)",
    "text": "M√≥dulo 2: Banco para Armazenamento dos Dados (Mini Tutorial de SQL)\nVamos criar um banco de dados SQLite do zero para o armazenamento dos dados baixados.\nMini tutorial de SQL e opera√ß√µes CRUD (Create Read Update Delete)\n\n\n\nDura√ß√£o: 01:13:03\n\n\n\n\n\n\n\n\n\n\n#\nAula\nDura√ß√£o\n\n\n\n\n1\nIntrodu√ß√£o a Banco de Dados\n04:13\n\n\n2\nCriando e inserindo tabelas\n07:58\n\n\n3\nAtualizando tabelas\n02:16\n\n\n4\nConsultas em tabelas\n05:50\n\n\n5\nRemovendo dados de tabelas\n03:02\n\n\n6\nCria√ß√£o de √≠ndices em tabelas\n06:00\n\n\n7\nPacote DBI 1\n05:58\n\n\n8\nPacote DBI 2\n04:31\n\n\n9\nPacote DBI 3\n02:06\n\n\n10\nPacote DBI 4\n04:21\n\n\n11\nPacote dbplyr\n05:29\n\n\n12\nCriando tabelas no banco de dados MeuDB\n03:16\n\n\n13\nExecutando o Pipeline de dados inserindo dados no MeuDB\n04:19\n\n\n14\nEntendendo a fun√ß√£o handle_data\n06:06\n\n\n15\nEntendendo os handlers de parse e insert no Pipeline de dados\n07:32"
  },
  {
    "objectID": "bancodedados.html#m√≥dulo-3-indicadores-financeiros-do-banco-central",
    "href": "bancodedados.html#m√≥dulo-3-indicadores-financeiros-do-banco-central",
    "title": "Construindo Banco de Dados Financeiros",
    "section": "M√≥dulo 3: Indicadores Financeiros do Banco Central",
    "text": "M√≥dulo 3: Indicadores Financeiros do Banco Central\nDownload e processamento de Indicadores Financeiros do Banco Central: IPCA, IGP-M, SELIC e Moedas\nProcessamento para gera√ß√£o do N√∫mero √çndice dos indicadores financeiros: SELIC, IPCA, IGP-M\n\n\n\nDura√ß√£o: 01:06:29\n\n\n\n\n\n\n\n\n\n\n#\nAula\nDura√ß√£o\n\n\n\n\n1\nDownload dos dados da SELIC com o pacote rbcb\n08:39\n\n\n2\nImplementando download da SELIC no Pipeline de dados\n05:32\n\n\n3\nExecutando o Pipeline de dados com download da SELIC\n06:52\n\n\n4\nImplementando parse e insert da SELIC no Pipeline de dados\n07:56\n\n\n5\nImplementando download de IPCA e IGP-M no Pipeline de dados\n05:28\n\n\n6\nExecutando o Pipeline de dados com download de IPCA e IGP-M\n02:25\n\n\n7\nExecutando fun√ß√µes dinamicamente no R\n03:39\n\n\n8\nDownload de dados de moedas com o pacote rbcb\n05:09\n\n\n9\nListando moedas dispon√≠veis com o rbcb\n02:38\n\n\n10\nExecutando o Pipeline de dados com download do USD\n03:49\n\n\n11\nImplementando insert do USD no Pipeline de dados\n04:01\n\n\n12\nImplementando o EUR no Pipeline de dados\n02:43\n\n\n13\nMudan√ßa nos downloaders com rbcb\n02:18\n\n\n14\nExecutando Pipeline de dados em BATCH\n05:14"
  },
  {
    "objectID": "bancodedados.html#m√≥dulo-4-indicadores-financeiros-da-anbima",
    "href": "bancodedados.html#m√≥dulo-4-indicadores-financeiros-da-anbima",
    "title": "Construindo Banco de Dados Financeiros",
    "section": "M√≥dulo 4: Indicadores Financeiros da ANBIMA",
    "text": "M√≥dulo 4: Indicadores Financeiros da ANBIMA\nProje√ß√µes de Infla√ß√£o (IGP-M e IPCA) da ANBIMA VNA de T√≠tulos P√∫blicos da ANBIMA Pre√ßos e Taxas T√≠tulos P√∫blicos da ANBIMA\n\n\n\nDura√ß√£o: 00:59:20\n\n\n\n\n\n\n\n\n\n\n#\nAula\nDura√ß√£o\n\n\n\n\n1\nWebscraping de proje√ß√µes de infla√ß√£o da ANBIMA 1\n04:21\n\n\n2\nWebscraping de proje√ß√µes de infla√ß√£o da ANBIMA 2\n11:08\n\n\n3\nCria√ß√£o de tabela para proje√ß√µes de infla√ß√£o da ANBIMA no MeuDB\n02:13\n\n\n4\nExecutando o Pipeline de dados com proje√ß√µes de infla√ß√£o da ANBIMA\n03:02\n\n\n5\nWebscraping de VNA de t√≠tulos p√∫blicos da ANBIMA 1\n04:14\n\n\n6\nWebscraping de VNA de t√≠tulos p√∫blicos da ANBIMA 2\n02:13\n\n\n7\nWebscraping de VNA de t√≠tulos p√∫blicos da ANBIMA 3\n04:29\n\n\n8\nWebscraping de VNA de t√≠tulos p√∫blicos da ANBIMA 4\n02:34\n\n\n9\nWebscraping de VNA de t√≠tulos p√∫blicos da ANBIMA 5\n05:43\n\n\n10\nCria√ß√£o de tabela para VNA no MeuDB\n01:41\n\n\n11\nExecutando o Pipeline de dados com VNA de t√≠tulos p√∫blicos da ANBIMA\n02:31\n\n\n12\nWebscraping de Pre√ßos e Taxas de t√≠tulos p√∫blicos da ANBIMA 1\n05:20\n\n\n13\nWebscraping de Pre√ßos e Taxas de t√≠tulos p√∫blicos da ANBIMA 2\n05:54\n\n\n14\nCria√ß√£o de tabela para T√≠tulos P√∫blicos no MeuDB\n01:40\n\n\n15\nExecutando o Pipeline de dados com T√≠tulos P√∫blicos da ANBIMA\n02:11"
  },
  {
    "objectID": "bancodedados.html#m√≥dulo-5-cadastro-de-instrumentos-da-b3",
    "href": "bancodedados.html#m√≥dulo-5-cadastro-de-instrumentos-da-b3",
    "title": "Construindo Banco de Dados Financeiros",
    "section": "M√≥dulo 5: Cadastro de Instrumentos da B3",
    "text": "M√≥dulo 5: Cadastro de Instrumentos da B3\nDownload e processamento do arquivo de Cadastro de Instrumentos (dados cadastrais de instrumentos) da B3 para A√ß√µes e Futuros\n\n\n\nDura√ß√£o: 00:57:25\n\n\n\n\n\n\n\n\n\n\n#\nAula\nDura√ß√£o\n\n\n\n\n1\nWebscraping da p√°gina de Pesquisa do Preg√£o da B3\n04:12\n\n\n2\nExecutando o Pipeline de dados com download do arquivo de Cadastro de Instrumentos da B3\n01:40\n\n\n3\nUnzip do arquivo de Cadastro de Instrumentos da B3\n04:32\n\n\n4\nVerificando integridade do arquivo zip do site de Pesquisa do Preg√£o da B3\n02:41\n\n\n5\nPacote XML\n09:18\n\n\n6\nVerificando a gera√ß√£o dos arquivos de Cadastro de Instrumentos da B3\n04:02\n\n\n7\nParsing do arquivo de Cadastro de Instrumentos da B3 - Dados de Equities (A√ß√µes)\n10:36\n\n\n8\nParsing do arquivo de Cadastro de Instrumentos da B3 - Dados de Futuros\n04:07\n\n\n9\nCria√ß√£o de tabelas para Equities e Futuros no MeuDB\n01:54\n\n\n10\nExecutando o Pipeline de dados com dados de Equities e Futuros\n04:27\n\n\n11\nInvestigando os Dados de Equities\n05:48\n\n\n12\nInvestigando os Dados de Futuros\n03:07\n\n\n13\nPlanilha com C√≥digos de Cadastro de Instrumentos da B3\n00:55"
  },
  {
    "objectID": "bancodedados.html#m√≥dulo-6-boletim-de-negocia√ß√£o-da-b3",
    "href": "bancodedados.html#m√≥dulo-6-boletim-de-negocia√ß√£o-da-b3",
    "title": "Construindo Banco de Dados Financeiros",
    "section": "M√≥dulo 6: Boletim de Negocia√ß√£o da B3",
    "text": "M√≥dulo 6: Boletim de Negocia√ß√£o da B3\nDownload e processamento do arquivo Boletim de Negocia√ß√£o da B3 (Dados di√°rios) para A√ß√µes e Futuros\n\n\n\nDura√ß√£o: 00:28:26\n\n\n\n\n\n\n\n\n\n\n#\nAula\nDura√ß√£o\n\n\n\n\n1\nWebScraping e download do arquivo PricingReport (arquivo de Pre√ßos) da B3\n04:21\n\n\n2\nCria√ß√£o de tabelas para dados de Pre√ßos (PricingReport) no MeuDB\n02:42\n\n\n3\nInserindo os dados de Pre√ßos no MeuDB\n05:43\n\n\n4\nExecutando o Pipeline de dados com dados de Pre√ßos (PricingReport)\n03:36\n\n\n5\nWebScraping e download do arquivo IndexReport (arquivo de √çndices) da B3 1\n03:32\n\n\n6\nWebScraping e download do arquivo IndexReport (arquivo de √çndices) da B3 2\n04:51\n\n\n7\nCria√ß√£o de tabelas para dados de √çndices (IndexReport) no MeuDB\n01:15\n\n\n8\nExecutando o Pipeline de dados com dados de √çndices (IndexReport)\n02:24"
  },
  {
    "objectID": "bancodedados.html#m√≥dulo-7-c√°lculo-do-pre√ßo-ajustado-de-a√ß√µes",
    "href": "bancodedados.html#m√≥dulo-7-c√°lculo-do-pre√ßo-ajustado-de-a√ß√µes",
    "title": "Construindo Banco de Dados Financeiros",
    "section": "M√≥dulo 7: C√°lculo do Pre√ßo Ajustado de A√ß√µes",
    "text": "M√≥dulo 7: C√°lculo do Pre√ßo Ajustado de A√ß√µes\nAjuste de retornos de A√ß√µes devido aos eventos corporativos (desdobramento, grupamento, etc)\n\n\n\nDura√ß√£o: 01:16:55\n\n\n\n\n\n\n\n\n\n\n#\nAula\nDura√ß√£o\n\n\n\n\n1\nImportando hist√≥rico de Equities no MeuDB\n05:04\n\n\n2\nImportando hist√≥rico de Pre√ßos no MeuDB\n05:04\n\n\n3\nImportando hist√≥rico de Futuros no MeuDB\n04:15\n\n\n4\nImportando hist√≥rico de √çndices no MeuDB\n03:00\n\n\n5\nGerando hist√≥rico de retorno de a√ß√µes\n12:06\n\n\n6\nCalculando EWMA para retornos da B3SA3\n06:08\n\n\n7\nCalculando EWMA para retornos de todos os ativos\n07:49\n\n\n8\nExecutando o c√°lculo do EWMA no Pipeline de dados\n07:14\n\n\n9\nConstruindo s√©rie de pre√ßos de a√ß√µes ajustados 1\n08:32\n\n\n10\nConstruindo s√©rie de pre√ßos de a√ß√µes ajustados 2\n04:11\n\n\n11\nExecutando o c√°lculo dos pre√ßos ajustados no Pipeline de dados\n05:52\n\n\n12\nDetectando eventos corporativos nos dados de Equities\n07:35"
  },
  {
    "objectID": "bancodedados.html#m√≥dulo-8-curvas-de-juros",
    "href": "bancodedados.html#m√≥dulo-8-curvas-de-juros",
    "title": "Construindo Banco de Dados Financeiros",
    "section": "M√≥dulo 8: Curvas de Juros",
    "text": "M√≥dulo 8: Curvas de Juros\nProcessamento para gera√ß√£o da Curva de Juros PrefixadaDownload e processamento das Curvas da ANBIMA\n\n\n\nDura√ß√£o: 00:52:54\n\n\n\n\n\n\n\n\n\n\n#\nAula\nDura√ß√£o\n\n\n\n\n1\nConstru√ß√£o da Curva de Juros Prefixados de Mercado (com dados de Futuros de Taxa DI)\n09:36\n\n\n2\nConstru√ß√£o da Curva de Juros Prefixados Padronizada em v√©rtices fixos (para risco de mercado)\n06:46\n\n\n3\nExecutando a constru√ß√£o de curvas de juros no Pipeline de dados\n04:29\n\n\n4\nWebscraping da ANBIMA para Obter Curvas de Juros de Governo 1\n11:36\n\n\n5\nWebscraping da ANBIMA para Obter Curvas de Juros de Governo 2\n14:52\n\n\n6\nExecutando o Pipeline de dados com dados das curvas de juros da ANBIMA\n05:34\n\n\n\n\n\n\n Link para o Curso"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Wilson Freitas",
    "section": "",
    "text": "20 anos de retornos de a√ß√µes no Brasil\n\n\n\n\n\n\n\nR\n\n\nrb3\n\n\nbcb\n\n\nopendata\n\n\n\n\nNo Brasil √© muito dif√≠cil fazer an√°lises de investimentos em a√ß√µes para per√≠odos muito longos. N√£o h√° um hist√≥rico longo, como 50 anos de dados, para realizarmos uma an√°lise de longo prazo. Apresento aqui uma an√°lise para 20 anos, no per√≠odo entre 2000 e 2019 completos. A an√°lise traz retornos em d√≥lar, nominais, reais e pr√™mio de risco, para investimentos em juros, e alguns √≠ndices de mercado.\n\n\n\n\n\n\nNov 25, 2023\n\n\nWilson Freitas\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nQuantLib: Curva de Cupom Cambial\n\n\n\n\n\n\n\npython\n\n\nquantlib\n\n\nbrasa\n\n\nB3\n\n\n\n\nComo construir as curvas de cupom cambial, limpo e sujo, usando QuantLib com Python.\n\n\n\n\n\n\nAug 1, 2023\n\n\nWilson Freitas\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nQuantLib, zero curves\n\n\n\n\n\n\n\npython\n\n\nquantlib\n\n\nbrasa\n\n\nB3\n\n\n\n\nA QuantLib t√™m diversos tipos de interpola√ß√£o para estruturas a termo de taxas de juros. Neste post vou mostrar como utilizar a ZeroCurve.\n\n\n\n\n\n\nJul 26, 2023\n\n\nWilson Freitas\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nQuantLib, dez anos depois ‚Ä¶\n\n\n\n\n\n\n\npython\n\n\nquantlib\n\n\nbrasa\n\n\n\n\nVoltei a mexer com a QuantLib, desta vez com Python, e n√£o C++, que √© a implementa√ß√£o original da biblioteca. Vamos ver aqui como a implementa√ß√£o em Python da QuantLib simplifica bastante as coisas.\n\n\n\n\n\n\nJul 19, 2023\n\n\nWilson Freitas\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nC√°lculo da taxa de juro real no Brasil\n\n\n\n\n\n\n\nR\n\n\nfixedincome\n\n\nbcb\n\n\nopendata\n\n\n\n\nAs taxas de juros de mercado, a taxa DI e SELIC, s√£o divulgadas em termos nominais. Entretanto, a taxa de juros importante para a economia √© a taxa de juro real, que √© a diferen√ßa entre a taxa de juro nominal praticada na economia descontada pela infla√ß√£o. Como utilizar o R para calcular a s√©rie hist√≥rica da taxa de juro real realizada.\n\n\n\n\n\n\nFeb 19, 2023\n\n\nWilson Freitas\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nDin√¢mica da Volatilidade Impl√≠cita\n\n\n\n\n\n\n\nR\n\n\noptions\n\n\nB3\n\n\nopendata\n\n\n\n\nComo a volatilidade impl√≠cita das op√ß√µes evolui no tempo? H√° diversas formas de se avaliar isso. Aqui veremos como √© a din√¢mica na volatilidade das op√ß√µes ATM no tempo.\n\n\n\n\n\n\nAug 29, 2022\n\n\nWilson Freitas\n\n\n\n\n\n\n  \n\n\n\n\nMovimento da Parte Longa da Curva de Juros\n\n\n\n\n\n\n\nR\n\n\nfixedincome\n\n\nrb3\n\n\nopendata\n\n\n\n\nA reuni√£o do COPOM no come√ßo do m√™s de agosto de 2022 trouxe um tom que influenciou a din√¢mica da parte longa da curva de juros. Aqui apresento uma anima√ß√£o do movimento da curva de juros nas duas primeiras semanas de agosto de 2022.\n\n\n\n\n\n\nAug 17, 2022\n\n\nWilson Freitas\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSuper Datasets para Op√ß√µes de A√ß√µes\n\n\n\n\n\nUm dos super datasets do pacote {rb3} √© o de op√ß√µes de a√ß√µes. Com este dataset √© poss√≠vel realizar diversos c√°lculos com dados de op√ß√µes de a√ß√µes, como calcular a volatilidade impl√≠cita das op√ß√µes, as gregas e at√© mesmo fazer o ajuste de modelos te√≥ricos.\n\n\n\n\n\n\nJun 24, 2022\n\n\nWilson Freitas\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSuper Datasets do Pacote rb3\n\n\n\n\n\nO pacote {rb3} traz fun√ß√µes que retornam super datasets, conjuntos de dados mais ricos juntando a informa√ß√£o de diferentes datasets obtidos com as fun√ß√µes do pacote.\n\n\n\n\n\n\nJun 19, 2022\n\n\nWilson Freitas\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n16 anos de Curva Prefixada\n\n\n\n\n\n\n\nR\n\n\nfixedincome\n\n\nrb3\n\n\nopendata\n\n\n\n\nObservando a din√¢mica da estrutura a termo de juros no Brasil e nos Estados Unidos ao longo dos √∫ltimos 16 anos.\n\n\n\n\n\n\nJun 18, 2022\n\n\nWilson Freitas\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nHist√≥rico de Taxas de Juros em D√≥lar no Brasil\n\n\n\n\n\n\n\nR\n\n\nfixedincome\n\n\nrb3\n\n\nopendata\n\n\n\n\nFoi analisado em um post recente a din√¢mica das taxas de juros, brasileira e americana. Trago neste post a compara√ß√£o entre as taxas de juros em d√≥lar, no Brasil e nos Estados Unidos.\n\n\n\n\n\n\nJun 10, 2022\n\n\nWilson Freitas\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nHist√≥rico de Taxas de Juros de Longo Prazo\n\n\n\n\n\n\n\nR\n\n\nfixedincome\n\n\nrb3\n\n\nopendata\n\n\n\n\nAs taxas de juros de longo prazo s√£o importantes vari√°veis econ√¥micas. Observar a din√¢mica dessas taxas √© fundamental para uma boa compreens√£o do cen√°rio econ√¥mico. Vamos ver como utilizar o pacote {fixedincome} para construir o hist√≥rico da taxa de juros prefixada para o prazo de 10 anos com dados extra√≠dos da B3 com o pacote {rb3}.\n\n\n\n\n\n\nJun 9, 2022\n\n\nWilson Freitas\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCurva de Juros de Americana - US Treasuries Curve\n\n\n\n\n\n\n\nR\n\n\nfixedincome\n\n\nopendata\n\n\n\n\nComo construir a curva de juros americana utilizando dados do Tesouro Americano (US Treasury) e o pacote {fixedincome}.\n\n\n\n\n\n\nJun 6, 2022\n\n\nWilson Freitas\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nIndicadores da Pesquisa Focus\n\n\n\n\n\n\n\nR\n\n\nbcb\n\n\nopendata\n\n\n\n\nAs APIs de Expectativas de Mercado da Pesquisa Focus n√£o informam direito quais indicadores est√£o dispon√≠veis. A documenta√ß√£o √© meio falha e pouco confi√°vel. Dessa maneira, a √∫nica maneira de descobrir o que est√° dispon√≠vel √© investigando a API. √â isso que vou mostrar como fazer neste post.\n\n\n\n\n\n\nJun 5, 2022\n\n\nWilson Freitas\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nExpectativas de Mercado da Pesquisa Focus no R\n\n\n\n\n\n\n\nR\n\n\nbcb\n\n\nopendata\n\n\n\n\nObtendo as expectativas de mercado para os indicadores macroecon√¥micos da Pesquisa Focus utilizando o R e o pacote {rbcb}.\n\n\n\n\n\n\nJun 3, 2022\n\n\nWilson Freitas\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nGr√°ficos de Composi√ß√£o de √çndices da B3\n\n\n\n\n\n\n\nR\n\n\nrb3\n\n\nopendata\n\n\n\n\nCom o pacote {rb3} √© poss√≠vel obter a composi√ß√£o dos √≠ndices da B3, como o IBOVESPA, por exemplo. Vamos construir alguns gr√°ficos donuts para avaliarmos a distribui√ß√£o da composi√ß√£o dos √≠ndices.\n\n\n\n\n\n\nJun 1, 2022\n\n\nWilson Freitas\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nObtendo Dados do BCB com Python\n\n\n\n\n\n\n\nPython\n\n\nbcb\n\n\nopendata\n\n\n\n\nObter os dados para an√°lise de forma simples √© fundamental e necess√°rio.\n\n\n\n\n\n\nJan 17, 2022\n\n\nWilson Freitas\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/2022-01-17-dados-bcb-com-python/dados-bcb-com-python.html",
    "href": "posts/2022-01-17-dados-bcb-com-python/dados-bcb-com-python.html",
    "title": "Obtendo Dados do BCB com Python",
    "section": "",
    "text": "Obter os dados para an√°lise de forma simples √© fundamental e necess√°rio.\nDepois de passar alguns anos mantendo o pacote {rbcb} que faz a integra√ß√£o do R com as APIs de dados abertos do Banco Central, decidi fazer o port para Python.\nEm parte porque o PyPI (Python Package Index - reposit√≥rio de pacotes do Python) √© bem menos burocr√°tico que o CRAN (reposit√≥rio de pacote do R), mas nos √∫ltimos anos tenho mexido mais com Python e fazia sentido portar algumas ferramentas.\nO pacote {python-bcb} √© a contraparte em Python do pacote {rbcb} do R.\nS√≥ que acabou ficando maior, n√£o por causa do Python, mas por que eu estava com tempo e paci√™ncia e acabei implementando parte da especifica√ß√£o OData. Isso permite de forma bem simples integrar diversas APIs do Banco Central que implementam essa especifica√ß√£o. Na minha √∫ltima contagem tinha 39 APIs nessa estrutura.\nO pacote {python-bcb} traz as seguintes APIs:\n\nSGS\nS√©ries de Moedas do Conversor de Moedas do Banco Central\nExpectativas do FOCUS\nBoletins da PTAX (abertura, 3 intradi√°rios, fechamento)\nDados selecionados de institui√ß√µes financeiras (IFDATA)\n\nAgora o que d√° mais trabalho ao fazer a integra√ß√£o de uma API √© escrever a documenta√ß√£oüòâ dado que as APIs n√£o s√£o padronizadas.\nVou comunicando aqui na medida que novas APIs forem sendo integradas.\nObviamente espero todo o tipo de coment√°rios e sugest√µes.\nDocumenta√ß√£o do projeto: https://wilsonfreitas.github.io/python-bcb/index.html\nLink do projeto: https://github.com/wilsonfreitas/python-bcb\nNo c√≥digo abaixo trago um exemplo que como utilizar a API de Expectativas do FOCUS para obter um DataFrame das expectativas de IPCA de 2021 ao longo de 2021.\n\nfrom bcb import Expectativas\n\nem = Expectativas()\nep = em.get_endpoint(\"ExpectativasMercadoAnuais\")\n\ndf_ipca_2021 = (\n    ep.query()\n      .filter(ep.Indicador == \"IPCA\")\n      .filter(ep.Data >= \"2021-01-01\", ep.Data <= \"2021-12-31\")\n      .filter(ep.DataReferencia == \"2021\", ep.baseCalculo == 1)\n      .orderby(ep.Data.asc())\n      .select(ep.Data, ep.Media, ep.Mediana)\n      .limit(10)\n      .collect()\n)\n\ndf_ipca_2021\n\n\n\n\n\n  \n    \n      \n      Data\n      Media\n      Mediana\n    \n  \n  \n    \n      0\n      2021-01-04\n      3.31\n      3.32\n    \n    \n      1\n      2021-01-05\n      3.29\n      3.30\n    \n    \n      2\n      2021-01-06\n      3.29\n      3.29\n    \n    \n      3\n      2021-01-07\n      3.27\n      3.28\n    \n    \n      4\n      2021-01-08\n      3.35\n      3.35\n    \n    \n      5\n      2021-01-11\n      3.40\n      3.40\n    \n    \n      6\n      2021-01-12\n      3.43\n      3.40\n    \n    \n      7\n      2021-01-13\n      3.48\n      3.44\n    \n    \n      8\n      2021-01-14\n      3.50\n      3.49\n    \n    \n      9\n      2021-01-15\n      3.52\n      3.47"
  },
  {
    "objectID": "posts/2022-06-03-expectativas-focus-com-rbcb/expectativas-focus-com-rbcb.html",
    "href": "posts/2022-06-03-expectativas-focus-com-rbcb/expectativas-focus-com-rbcb.html",
    "title": "Expectativas de Mercado da Pesquisa Focus no R",
    "section": "",
    "text": "√â poss√≠vel obter as expectativas de mercado para diversos indicadores macroecon√¥micos da pesquisa Focus de forma totalmente autom√°tica utilizando o R.\nVamos utilizar o pacote {rbcb} para obter estes dados. O pacote {rbcb} √© uma interface para algumas das diversas APIs do portal de dados abertos do Banco Central (link).\nAs expectativas de mercado para os indicadores macroecon√¥micos da pesquisa Focus s√£o consolidadas em estat√≠sticas di√°rias e divulgadas na API. Estas estat√≠sticas s√£o calculadas com base nas expectativas de mercado de diversos bancos, gestores de recursos e demais institui√ß√µes do mercado financeiro. Os indicadores macroecon√¥micos s√£o referentes a √≠ndices de pre√ßos, crescimento do PIB e da produ√ß√£o industrial, taxa de c√¢mbio, taxa Selic, vari√°veis fiscais e indicadores do setor externo e s√£o publicadas todo primeiro dia √∫til da semana.\nCarregando os pacotes utilizados."
  },
  {
    "objectID": "posts/2022-06-03-expectativas-focus-com-rbcb/expectativas-focus-com-rbcb.html#s√©rie-temporal-das-expectativas-de-ipca",
    "href": "posts/2022-06-03-expectativas-focus-com-rbcb/expectativas-focus-com-rbcb.html#s√©rie-temporal-das-expectativas-de-ipca",
    "title": "Expectativas de Mercado da Pesquisa Focus no R",
    "section": "S√©rie temporal das expectativas de IPCA",
    "text": "S√©rie temporal das expectativas de IPCA\nVamos come√ßar observando a s√©rie temporal das expectativas para cada DataReferencia.\n\ndf |>\n  ggplot(aes(x = Data, y = Mediana, group = DataReferencia, colour = DataReferencia)) +\n  geom_line() +\n  labs(\n    title = \"Expectativas para IPCA em 2021 e 2022\",\n    subtitle = \"M√©dia das expectativas de IPCA\",\n    caption = \"Dados da Pesquisa Focus obtidos com pacote rbcb\",\n    x = \"Data\", y = \"Infla√ß√£o\"\n  )\n\n\n\n\nCurioso ver como as expectativas de infla√ß√£o para 2021 mudaram ao longo de 2021, ou seja, erra-se miseravelmente. As expectativas para 2022 mudam menos, bem, isso at√© virar o ano."
  },
  {
    "objectID": "posts/2022-06-03-expectativas-focus-com-rbcb/expectativas-focus-com-rbcb.html#s√©rie-temporal-com-intervalo-informado",
    "href": "posts/2022-06-03-expectativas-focus-com-rbcb/expectativas-focus-com-rbcb.html#s√©rie-temporal-com-intervalo-informado",
    "title": "Expectativas de Mercado da Pesquisa Focus no R",
    "section": "S√©rie temporal com intervalo informado",
    "text": "S√©rie temporal com intervalo informado\nVamos olhar agora apenas a DataReferencia 2021 e colocar as linhas de m√°ximo e m√≠nimo para termos uma ideia de intervalo para as expectativas.\n\ndf |>\n  filter(DataReferencia == 2021) |>\n  ggplot(aes(x = Data)) +\n  geom_line(aes(y = Mediana), colour = \"black\") +\n  geom_line(aes(y = Maximo), colour = \"grey\") +\n  geom_line(aes(y = Minimo), colour = \"grey\") +\n  geom_ribbon(aes(ymin = Minimo, ymax = Maximo), fill = \"blue\", alpha = 0.3) +\n  labs(\n    title = \"Expectativas para IPCA em 2021\",\n    subtitle = \"M√©dia das expectativas de IPCA com intervalo definido por m√°ximo e m√≠nimo da amostra\",\n    caption = \"Dados da Pesquisa Focus obtidos com pacote rbcb\",\n    x = \"Data\", y = \"Infla√ß√£o\"\n  )\n\n\n\n\nInteressante ver como as pesquisas erram e como, mesmo os mais ousados, n√£o saem muito do consenso. Entendo que esse √© um mecanismo necess√°rio para se colocar o ‚Äúbode na sala‚Äù, e ntretanto, erra-se miseravelmente, s√£o muitos vieses envolvidos."
  },
  {
    "objectID": "posts/2022-06-05-indicadores-da-pesquisa-focus/indicadores-da-pesquisa-focus.html",
    "href": "posts/2022-06-05-indicadores-da-pesquisa-focus/indicadores-da-pesquisa-focus.html",
    "title": "Indicadores da Pesquisa Focus",
    "section": "",
    "text": "√â poss√≠vel obter as expectativas de mercado para diversos indicadores macroecon√¥micos da pesquisa Focus de forma totalmente autom√°tica utilizando o R.\nVamos utilizar o pacote {rbcb} para obter estes dados. O pacote {rbcb} √© uma interface para algumas das diversas APIs do portal de dados abertos do Banco Central (link).\nAs expectativas de mercado para os indicadores macroecon√¥micos da pesquisa Focus s√£o consolidadas em estat√≠sticas di√°rias e divulgadas na API. Estas estat√≠sticas s√£o calculadas com base nas expectativas de mercado de diversos bancos, gestores de recursos e demais institui√ß√µes do mercado financeiro. Os indicadores macroecon√¥micos s√£o referentes a √≠ndices de pre√ßos, crescimento do PIB e da produ√ß√£o industrial, taxa de c√¢mbio, taxa Selic, vari√°veis fiscais e indicadores do setor externo e s√£o publicadas todo primeiro dia √∫til da semana.\nCarregando os pacotes utilizados."
  },
  {
    "objectID": "posts/2022-06-05-indicadores-da-pesquisa-focus/indicadores-da-pesquisa-focus.html#annual",
    "href": "posts/2022-06-05-indicadores-da-pesquisa-focus/indicadores-da-pesquisa-focus.html#annual",
    "title": "Indicadores da Pesquisa Focus",
    "section": "annual",
    "text": "annual\nConsulta 1\n\nget_market_expectations(\"annual\",\n  `$top` = 1,\n  `$select` = \"Data\",\n  `$orderby` = \"Data desc\"\n) |>\n  rmarkdown::paged_table()\n\n\n\n  \n\n\n\nConsulta 2\n\nget_market_expectations(\"annual\",\n  `$select` = \"Data,Indicador,IndicadorDetalhe\",\n  `$filter` = \"Data eq '2022-04-29'\"\n) |>\n  distinct(Indicador, IndicadorDetalhe) |>\n  arrange(Indicador, IndicadorDetalhe) |>\n  rmarkdown::paged_table()\n\n\n\n  \n\n\n\nEste endpoint tem uma coluna IndicadorDetalhe, que √© como uma especifica√ß√£o do indicador. No caso, Balan√ßa Comercial-Saldo ou Balan√ßa Comercial-Exporta√ß√µes, por exemplo."
  },
  {
    "objectID": "posts/2022-06-05-indicadores-da-pesquisa-focus/indicadores-da-pesquisa-focus.html#monthly",
    "href": "posts/2022-06-05-indicadores-da-pesquisa-focus/indicadores-da-pesquisa-focus.html#monthly",
    "title": "Indicadores da Pesquisa Focus",
    "section": "monthly",
    "text": "monthly\nConsulta 1\n\nget_market_expectations(\"monthly\",\n  `$top` = 1,\n  `$select` = \"Data\",\n  `$orderby` = \"Data desc\"\n) |>\n  rmarkdown::paged_table()\n\n\n\n  \n\n\n\nConsulta 2\n\nget_market_expectations(\"monthly\",\n  `$select` = \"Data,Indicador\",\n  `$filter` = \"Data eq '2022-04-29'\"\n) |>\n  distinct(Indicador) |>\n  arrange(Indicador) |>\n  rmarkdown::paged_table()"
  },
  {
    "objectID": "posts/2022-06-05-indicadores-da-pesquisa-focus/indicadores-da-pesquisa-focus.html#quarterly",
    "href": "posts/2022-06-05-indicadores-da-pesquisa-focus/indicadores-da-pesquisa-focus.html#quarterly",
    "title": "Indicadores da Pesquisa Focus",
    "section": "quarterly",
    "text": "quarterly\nConsulta 1\n\nget_market_expectations(\"quarterly\",\n  `$top` = 1,\n  `$select` = \"Data\",\n  `$orderby` = \"Data desc\"\n) |>\n  rmarkdown::paged_table()\n\n\n\n  \n\n\n\nConsulta 2\n\nget_market_expectations(\"quarterly\",\n  `$select` = \"Data,Indicador\",\n  `$filter` = \"Data eq '2022-04-29'\"\n) |>\n  distinct(Indicador) |>\n  arrange(Indicador) |>\n  rmarkdown::paged_table()"
  },
  {
    "objectID": "posts/2022-06-05-indicadores-da-pesquisa-focus/indicadores-da-pesquisa-focus.html#inflation-12-months",
    "href": "posts/2022-06-05-indicadores-da-pesquisa-focus/indicadores-da-pesquisa-focus.html#inflation-12-months",
    "title": "Indicadores da Pesquisa Focus",
    "section": "inflation-12-months",
    "text": "inflation-12-months\nConsulta 1\n\nget_market_expectations(\"inflation-12-months\",\n  `$top` = 1,\n  `$select` = \"Data\",\n  `$orderby` = \"Data desc\"\n) |>\n  rmarkdown::paged_table()\n\n\n\n  \n\n\n\nConsulta 2\n\nget_market_expectations(\"inflation-12-months\",\n  `$select` = \"Data,Indicador\",\n  `$filter` = \"Data eq '2022-04-29'\"\n) |>\n  distinct(Indicador) |>\n  arrange(Indicador) |>\n  rmarkdown::paged_table()"
  },
  {
    "objectID": "posts/2022-06-05-indicadores-da-pesquisa-focus/indicadores-da-pesquisa-focus.html#top5s-annual",
    "href": "posts/2022-06-05-indicadores-da-pesquisa-focus/indicadores-da-pesquisa-focus.html#top5s-annual",
    "title": "Indicadores da Pesquisa Focus",
    "section": "top5s-annual",
    "text": "top5s-annual\nConsulta 1\n\nget_market_expectations(\"top5s-annual\",\n  `$top` = 1,\n  `$select` = \"Data\",\n  `$orderby` = \"Data desc\"\n) |>\n  rmarkdown::paged_table()\n\n\n\n  \n\n\n\nConsulta 2\n\nget_market_expectations(\"top5s-annual\",\n  `$select` = \"Data,Indicador\",\n  `$filter` = \"Data eq '2022-04-29'\"\n) |>\n  distinct(Indicador) |>\n  arrange(Indicador) |>\n  rmarkdown::paged_table()"
  },
  {
    "objectID": "posts/2022-06-05-indicadores-da-pesquisa-focus/indicadores-da-pesquisa-focus.html#top5s-monthly",
    "href": "posts/2022-06-05-indicadores-da-pesquisa-focus/indicadores-da-pesquisa-focus.html#top5s-monthly",
    "title": "Indicadores da Pesquisa Focus",
    "section": "top5s-monthly",
    "text": "top5s-monthly\nConsulta 1\n\nget_market_expectations(\"top5s-monthly\",\n  `$top` = 1,\n  `$select` = \"Data\",\n  `$orderby` = \"Data desc\"\n) |>\n  rmarkdown::paged_table()\n\n\n\n  \n\n\n\nConsulta 2\n\nget_market_expectations(\"top5s-monthly\",\n  `$select` = \"Data,Indicador\",\n  `$filter` = \"Data eq '2022-04-29'\"\n) |>\n  distinct(Indicador) |>\n  arrange(Indicador) |>\n  rmarkdown::paged_table()"
  },
  {
    "objectID": "posts/2022-06-05-indicadores-da-pesquisa-focus/indicadores-da-pesquisa-focus.html#top5s-selic",
    "href": "posts/2022-06-05-indicadores-da-pesquisa-focus/indicadores-da-pesquisa-focus.html#top5s-selic",
    "title": "Indicadores da Pesquisa Focus",
    "section": "top5s-selic",
    "text": "top5s-selic\nConsulta 1\n\nget_market_expectations(\"top5s-selic\",\n  `$top` = 1,\n  `$select` = \"Data\",\n  `$orderby` = \"Data desc\"\n) |>\n  rmarkdown::paged_table()\n\n\n\n  \n\n\n\nConsulta 2\n\nget_market_expectations(\"top5s-selic\",\n  `$select` = \"Data,indicador\",\n  `$filter` = \"Data eq '2022-04-29'\"\n) |>\n  distinct(indicador) |>\n  arrange(indicador) |>\n  rmarkdown::paged_table()\n\n\n\n  \n\n\n\nAqui temos uma pegadinha, a coluna indicador vem com sua inicial min√∫scula, diferente dos demais endpoints."
  },
  {
    "objectID": "posts/2022-06-05-indicadores-da-pesquisa-focus/indicadores-da-pesquisa-focus.html#selic",
    "href": "posts/2022-06-05-indicadores-da-pesquisa-focus/indicadores-da-pesquisa-focus.html#selic",
    "title": "Indicadores da Pesquisa Focus",
    "section": "selic",
    "text": "selic\nConsulta 1\n\nget_market_expectations(\"selic\",\n  `$top` = 1,\n  `$select` = \"Data\",\n  `$orderby` = \"Data desc\"\n) |>\n  rmarkdown::paged_table()\n\n\n\n  \n\n\n\nConsulta 2\n\nget_market_expectations(\"selic\",\n  `$select` = \"Data,Indicador\",\n  `$filter` = \"Data eq '2022-04-29'\"\n) |>\n  distinct(Indicador) |>\n  arrange(Indicador) |>\n  rmarkdown::paged_table()"
  },
  {
    "objectID": "posts/2022-06-08-curva-de-juros-de-americana-us-treasuries-curve/curva-de-juros-de-americana-us-treasuries-curve.html",
    "href": "posts/2022-06-08-curva-de-juros-de-americana-us-treasuries-curve/curva-de-juros-de-americana-us-treasuries-curve.html",
    "title": "Curva de Juros de Americana - US Treasuries Curve",
    "section": "",
    "text": "A curva de juros americana √© uma pe√ßa fundamental do quebra-cabe√ßas econ√¥mico/financeiro. Neste post vamos ver como obter os dados do hist√≥rico da estrutura a termo de juros dos Estados Unidos e como construir uma curva de juros utilizando o pacote {fixedincome}.\nVamos utilizar o Quandl, que hoje √© o Nasdaq Data Link, para obter o hist√≥rico de juros americanos.\n\nlibrary(Quandl)\n\nyc_all <- Quandl(\"USTREASURY/YIELD\")\n\n\n\nLoading required package: xts\n\n\nLoading required package: zoo\n\n\n\nAttaching package: 'zoo'\n\n\nThe following objects are masked from 'package:base':\n\n    as.Date, as.Date.numeric\n\n\nyc_all traz todo o hist√≥rico de juros, as Constant Maturity Treasury rates, que relacionam as taxas de juros ao um conjuto de prazos padronizados: 1, 3, e 6 meses, e 1, 2, 3, 5, 7, 10, 20, e 30 anos.\n\nhead(yc_all)\n\n        Date 1 MO 2 MO 3 MO 6 MO 1 YR 2 YR 3 YR 5 YR 7 YR 10 YR 20 YR 30 YR\n1 2023-02-17 4.64 4.81 4.84 4.99 5.00 4.60 4.33 4.03 3.95  3.82  4.01  3.88\n2 2023-02-16 4.66 4.80 4.84 4.98 4.99 4.62 4.35 4.06 3.98  3.86  4.05  3.92\n3 2023-02-15 4.64 4.79 4.79 4.97 4.96 4.62 4.35 4.04 3.94  3.81  3.97  3.85\n4 2023-02-14 4.63 4.78 4.80 4.98 4.99 4.60 4.32 4.00 3.90  3.77  3.94  3.81\n5 2023-02-13 4.66 4.78 4.81 4.99 4.91 4.52 4.22 3.93 3.84  3.72  3.92  3.79\n6 2023-02-10 4.66 4.77 4.79 4.89 4.89 4.50 4.19 3.93 3.86  3.74  3.96  3.83\n\n\nVamos montar a curva de juros para uma data espec√≠fica utilizando os prazos definidos no hist√≥rico.\n\nlibrary(tidyverse)\n\n‚îÄ‚îÄ Attaching packages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse 1.3.2 ‚îÄ‚îÄ\n‚úî ggplot2 3.4.1     ‚úî purrr   1.0.1\n‚úî tibble  3.1.8     ‚úî dplyr   1.1.0\n‚úî tidyr   1.3.0     ‚úî stringr 1.5.0\n‚úî readr   2.1.4     ‚úî forcats 1.0.0\n‚îÄ‚îÄ Conflicts ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse_conflicts() ‚îÄ‚îÄ\n‚úñ dplyr::filter() masks stats::filter()\n‚úñ dplyr::lag()    masks stats::lag()\n\nrefdate <- as.Date(\"2022-02-04\")\nyc <- yc_all |> filter(Date == refdate)\n\nyc\n\n        Date 1 MO 2 MO 3 MO 6 MO 1 YR 2 YR 3 YR 5 YR 7 YR 10 YR 20 YR 30 YR\n1 2022-02-04 0.05 0.12 0.23 0.56 0.89 1.31 1.55 1.78  1.9  1.93  2.29  2.23\n\n\nComecemos construindo o vetor de prazos da curva. Para isso precisamos interpretar os nomes das colunas e convert√™-los em prazos.\n\nnx <- names(yc)\nterms_names <- nx[-1]\nterms_names\n\n [1] \"1 MO\"  \"2 MO\"  \"3 MO\"  \"6 MO\"  \"1 YR\"  \"2 YR\"  \"3 YR\"  \"5 YR\"  \"7 YR\" \n[10] \"10 YR\" \"20 YR\" \"30 YR\"\n\n\nTemos MO indicando prazos em meses e YR indicando os anos. Vamos utilizar uma simples substitui√ß√£o de texto para converter MO para months e YR para years. Dessa forma podemos utilizar a fun√ß√£o fixedincome::as.term que converte um string em um objeto term (prazo).\n\nlibrary(stringr)\n\nterms_names <- terms_names |>\n  str_replace(\"MO\", \"months\") |>\n  str_replace(\"YR\", \"years\")\n\nterms_names\n\n [1] \"1 months\" \"2 months\" \"3 months\" \"6 months\" \"1 years\"  \"2 years\" \n [7] \"3 years\"  \"5 years\"  \"7 years\"  \"10 years\" \"20 years\" \"30 years\"\n\n\nAp√≥s a convers√£o usamos a fun√ß√£o purrr::map com a fun√ß√£o fixedincome::as.term e assim vamos obter uma lista com diversos objetos term.\n\nlibrary(purrr)\nlibrary(fixedincome)\n\n\nAttaching package: 'fixedincome'\n\n\nThe following objects are masked from 'package:dplyr':\n\n    first, last\n\ncurve_terms <- map(terms_names, as.term)\ncurve_terms\n\n[[1]]\n[1] \"1 month\"\n\n[[2]]\n[1] \"2 months\"\n\n[[3]]\n[1] \"3 months\"\n\n[[4]]\n[1] \"6 months\"\n\n[[5]]\n[1] \"1 year\"\n\n[[6]]\n[1] \"2 years\"\n\n[[7]]\n[1] \"3 years\"\n\n[[8]]\n[1] \"5 years\"\n\n[[9]]\n[1] \"7 years\"\n\n[[10]]\n[1] \"10 years\"\n\n[[11]]\n[1] \"20 years\"\n\n[[12]]\n[1] \"30 years\"\n\n\nObviamente tudo isso poderia ter sido feito de forma direta.\n\ncurve_terms <- nx[-1] |>\n  str_replace(\"MO\", \"months\") |>\n  str_replace(\"YR\", \"years\") |>\n  map(as.term)\n\nPois bem, temos uma lista com prazos em meses e prazos em anos. √â necess√°rio converter os prazos para uma mesma unidade (units). Vou converter todos os prazos para dias. Para fazer isso vou criar um objeto daycount(\"actual/360\"), que √© a regra de contagem de dias que considera dias corridos e anos com 360 dias. Com a regra de contagem de dias conseguimos fazer a convers√£o dos prazos para anos e utilizando a quantidade de dias no ano da regra, 360, fazemos a convers√£o para dias.\n\ndc <- daycount(\"actual/360\")\n\nterms <- curve_terms |>\n  map_dbl(\\(x) dib(dc) * toyears(dc, x)) |>\n  term(\"days\")\n\nterms\n\n [1] \"30 days\"    \"60 days\"    \"90 days\"    \"180 days\"   \"360 days\"  \n [6] \"720 days\"   \"1080 days\"  \"1800 days\"  \"2520 days\"  \"3600 days\" \n[11] \"7200 days\"  \"10800 days\"\n\n\nA fun√ß√£o fixedincome::toyears converte os prazos para um n√∫mero em anos, por exemplo, 6 meses retorna 0.5, e a fun√ß√£o dib retorna a quantidade de dias no ano para a regra, neste caso, 360. Conclu√≠mos criando os objetos de prazo com term.\nAgora que j√° temos os prazos da curva vamos extrair as taxas do data.frame. √â uma opera√ß√£o simples de extra√ß√£o de linhas de um data.frame e converter em um vetor. Fazemos uma verifica√ß√£o de NA por que eventualmente h√° podemos ter valores ausentes para alguns prazos.\n\nrates <- yc[1, -1] |>\n  as.list() |>\n  as.numeric()\nrates <- rates / 100\nix <- !is.na(rates)\n\nrates[ix]\n\n [1] 0.0005 0.0012 0.0023 0.0056 0.0089 0.0131 0.0155 0.0178 0.0190 0.0193\n[11] 0.0229 0.0223\n\n\nTendo os prazos, as taxas e a data de refer√™ncia, podemos construir a curva com a fun√ß√£o fixedincome::spotratecurve. Para a curva de juros americana utilizamos taxa de juros simples (compounding simple), regra de contagem de dias (actual/360) e o calend√°rio de dias corridos (actual).\n\ntr_curve <- spotratecurve(\n  rates[ix], terms[ix],\n  \"simple\", \"actual/360\", \"actual\",\n  refdate = refdate\n)\n\ntr_curve\n\n          SpotRateCurve\n30 days          0.0005\n60 days          0.0012\n90 days          0.0023\n180 days         0.0056\n360 days         0.0089\n720 days         0.0131\n1080 days        0.0155\n1800 days        0.0178\n2520 days        0.0190\n3600 days        0.0193\n# ... with 2 more rows\nsimple actual/360 actual \nReference date: 2022-02-04 \n\n\nNote os prazos em dias. Agora √© s√≥ visualizar a curva de forma graciosa!\n\nplot(tr_curve)"
  },
  {
    "objectID": "posts/2022-06-09-grficos-de-composio-de-ndices-da-b3/grficos-de-composio-de-ndices-da-b3.html",
    "href": "posts/2022-06-09-grficos-de-composio-de-ndices-da-b3/grficos-de-composio-de-ndices-da-b3.html",
    "title": "Gr√°ficos de Composi√ß√£o de √çndices da B3",
    "section": "",
    "text": "Recentemente, eu implementei no pacote {rb3} um conjunto de fun√ß√µes que baixam dados de √≠ndices do site da B3.\nVou mostrar aqui como utilizar a fun√ß√£o rb3::index_weights_get, que retorna um data.frame com todas as a√ß√µes que comp√µem um determinado √≠ndice, juntamente com os seus respectivos pesos no √≠ndice.\nVamos come√ßar carregando os pacotes {rb3} e {tidyverse} que utilizo.\nA ideia aqui √© avaliar a distribui√ß√£o de ativos em alguns √≠ndices, a saber: IBOV, IBXX, IBXL, SMLL e IFIX. Contudo, essa avalia√ß√£o ser√° realizada da seguinte forma: os 10 ativos com a maior participa√ß√£o nos √≠ndices ser√£o selecionados e os demais ativos ser√£o colocado em um grupo definido como Others. Assim vou fazer um gr√°fico de donut (uma pizza com furo no meio) apresentando a participa√ß√£o de cada ativo no √≠ndice. Dessa maneira ser√° poss√≠vel avaliar a concentra√ß√£o dos √≠ndices.\nPara fazer essa sele√ß√£o dos ativos e o agrupemento dos demais eu criei a fun√ß√£o top_weight. Esta fun√ß√£o j√° prepara o data.frame para a fun√ß√£o ggdonut que constroi o gr√°fico de donut."
  },
  {
    "objectID": "posts/2022-06-09-grficos-de-composio-de-ndices-da-b3/grficos-de-composio-de-ndices-da-b3.html#ibovespa",
    "href": "posts/2022-06-09-grficos-de-composio-de-ndices-da-b3/grficos-de-composio-de-ndices-da-b3.html#ibovespa",
    "title": "Gr√°ficos de Composi√ß√£o de √çndices da B3",
    "section": "IBOVESPA",
    "text": "IBOVESPA\n\nindex_name <- \"IBOV\"\nindex_weights_get(index_name) |>\n    top_weight() |>\n    ggdonut(index_name)"
  },
  {
    "objectID": "posts/2022-06-09-grficos-de-composio-de-ndices-da-b3/grficos-de-composio-de-ndices-da-b3.html#ibx-100",
    "href": "posts/2022-06-09-grficos-de-composio-de-ndices-da-b3/grficos-de-composio-de-ndices-da-b3.html#ibx-100",
    "title": "Gr√°ficos de Composi√ß√£o de √çndices da B3",
    "section": "IBX 100",
    "text": "IBX 100\n\nindex_name <- \"IBXX\"\nindex_weights_get(index_name) |>\n    top_weight() |>\n    ggdonut(index_name)"
  },
  {
    "objectID": "posts/2022-06-09-grficos-de-composio-de-ndices-da-b3/grficos-de-composio-de-ndices-da-b3.html#ibx-50",
    "href": "posts/2022-06-09-grficos-de-composio-de-ndices-da-b3/grficos-de-composio-de-ndices-da-b3.html#ibx-50",
    "title": "Gr√°ficos de Composi√ß√£o de √çndices da B3",
    "section": "IBX 50",
    "text": "IBX 50\n\nindex_name <- \"IBXL\"\nindex_weights_get(index_name) |>\n    top_weight() |>\n    ggdonut(index_name)\n\nWarning: Automatic coercion from double to character was deprecated in purrr 1.0.0.\n‚Ñπ Please use an explicit call to `as.character()` within `map_chr()` instead.\n‚Ñπ The deprecated feature was likely used in the rb3 package.\n  Please report the issue at <https://github.com/wilsonfreitas/rb3/issues>."
  },
  {
    "objectID": "posts/2022-06-09-grficos-de-composio-de-ndices-da-b3/grficos-de-composio-de-ndices-da-b3.html#small",
    "href": "posts/2022-06-09-grficos-de-composio-de-ndices-da-b3/grficos-de-composio-de-ndices-da-b3.html#small",
    "title": "Gr√°ficos de Composi√ß√£o de √çndices da B3",
    "section": "SMALL",
    "text": "SMALL\n\nindex_name <- \"SMLL\"\nindex_weights_get(index_name) |>\n    top_weight() |>\n    ggdonut(index_name)"
  },
  {
    "objectID": "posts/2022-06-09-grficos-de-composio-de-ndices-da-b3/grficos-de-composio-de-ndices-da-b3.html#ifix",
    "href": "posts/2022-06-09-grficos-de-composio-de-ndices-da-b3/grficos-de-composio-de-ndices-da-b3.html#ifix",
    "title": "Gr√°ficos de Composi√ß√£o de √çndices da B3",
    "section": "IFIX",
    "text": "IFIX\n\nindex_name <- \"IFIX\"\nindex_weights_get(index_name) |>\n    top_weight() |>\n    ggdonut(index_name)"
  },
  {
    "objectID": "posts/2022-06-09-histrico-de-taxas-de-juros-de-longo-prazo/histrico-de-taxas-de-juros-de-longo-prazo.html",
    "href": "posts/2022-06-09-histrico-de-taxas-de-juros-de-longo-prazo/histrico-de-taxas-de-juros-de-longo-prazo.html",
    "title": "Hist√≥rico de Taxas de Juros de Longo Prazo",
    "section": "",
    "text": "No mercado norte americano h√° cota√ß√µes para taxas de juros em prazos fixos, 1 ano, 5 anos, 10 anos, e assim por diante. Estas estruturas s√£o conhecidas como Constant Term Maturities.\nEstes dados podem ser obtidos do site do Tesouro Americano (US Treasury) com o pacote {Quandl}.\n\nlibrary(Quandl)\n\nyc_all <- Quandl(\"USTREASURY/YIELD\")\n\n\n\n\nPodemos observar um longo hist√≥rico, desde a d√©cada de 90, para estas taxas.\n\nlibrary(tidyverse)\n\nyc_all |>\n    ggplot(aes(x = Date, y = `10 YR` / 100)) +\n    geom_line() +\n    labs(\n        x = NULL, y = NULL,\n        title = \"Hist√≥rico de Taxas de Juros Americanos de 10 Anos (Treasury Bonds)\",\n        caption = \"Dados do US Treasury obtidos com o pacote Quandl - wilsonfreitas\"\n    ) +\n    scale_y_continuous(labels = scales::percent)\n\n\n\n\nNo mercado brasileiro, infelizmente, a vida √© um pouco miser√°vel, e n√£o h√° um hist√≥rico dispon√≠vel com taxas de longo prazo. √â necess√°rio construir na unha e na for√ßa do √≥dio.\nOs ativos l√≠quidos de onde s√£o extra√≠das as taxas de juros de longo prazo s√£o os contratos futuros de taxa DI - DI1, que s√£o cotados diariamente na B3 em seus vencimentos. Entretanto, as taxas de juros obtidas destes contratos apresentam um prazo diferente a cada dia. Assim, √© necess√°rio construir uma curva de juros com estes contratos e realizar uma interpola√ß√£o nos prazos fixos, 1 ano, 5 anos, 10 anos, e por a√≠ vai.\nVamos utilizar o pacote {rb3} para obter o hist√≥rico com as curvas di√°rias de juros prefixados do mercado brasileiro e o pacote {fixedincome} para construir os objetos de curvas de juros e realizar a interpola√ß√£o das curvas nos v√©rtices fixos para obter o hist√≥rico de taxas de juros de longo prazo.\nVamos come√ßar importando os pacotes utilizados nessa jornada.\n\nlibrary(rb3)\nlibrary(bizdays)\nlibrary(fixedincome)\nlibrary(tidyverse)\n\nA fun√ß√£o rb3::yc_mget retorna um data.frame com o hist√≥rico de curvas de juros. Vamos baixar um hist√≥rico desde 2019.\n\ndc <- yc_mget(\n    first_date = \"2019-01-01\",\n    last_date = preceding(Sys.Date() - 1, \"Brazil/ANBIMA\"),\n    cache_folder = \"../../../rb3-data\"\n)\n\nWarning: Automatic coercion from double to character was deprecated in purrr 1.0.0.\n‚Ñπ Please use an explicit call to `as.character()` within `map_chr()` instead.\n‚Ñπ The deprecated feature was likely used in the rb3 package.\n  Please report the issue at <https://github.com/wilsonfreitas/rb3/issues>.\n\n\nDe posse do hist√≥rico, vamos construir as curvas de juros para cada data de refer√™ncia utilizando a fun√ß√£o fixedincome::spotratecurve. A curva de juros prefixada tem as seguintes caracter√≠sticas:\n\nregime de capitaliza√ß√£o: discrete (juros compostos)\nregra de contagem de dias: business/252\ncalend√°rio: Brazil/ANBIMA\ninterpola√ß√£o: flat-forward\n\nAdicionalmente fa√ßo uma limpeza nos eventuais problemas encontrados nos dados, como dias √∫teis zerados e duplicados. Bem, √© de gra√ßa, exigir dados corretos deve ser um pouco demais, n√©?\n\nunique(dc$refdate) |> map(function(date, df) {\n    df_curve <- df |>\n        filter(refdate == date, biz_days > 0) |>\n        filter(!duplicated(biz_days))\n    curve <- spotratecurve(\n        df_curve$r_252,\n        df_curve$biz_days,\n        \"discrete\", \"business/252\", \"Brazil/ANBIMA\",\n        refdate = date\n    )\n    interpolation(curve) <- interp_flatforward()\n    curve\n}, df = dc) -> curves\n\nObtendo um lista com as curvas de juros utilizamos os colchetes [[ para realizar a interpola√ß√£o no prazo fixo de 10 anos. Como estas curvas utilizam a regra de contagem de dias business/252, devemos considerar que 1 ano tem 252 dias √∫teis e portanto, 10 anos tem 2520 dias √∫teis. Por isso, interpolamos a curva no v√©rtice 2520.\n\ncurves |>\n    map_dfr(\\(x) tibble(\n        refdate = x@refdate,\n        r_BRL_10y = as.numeric(x[[2520]])\n    )) -> rates_10y\n\nJ√° aproveito e retorno o hist√≥rico em um data.frame com as colunas refdate e r_BRL_10y. Fa√ßo isso para juntar com os dados de juros americanos de 10 anos e assim comparar a din√¢mica das taxas conjuntamente.\n\nrates_10y <- rates_10y |>\n    left_join(yc_all |> select(Date, `10 YR`), by = c(\"refdate\" = \"Date\")) |>\n    rename(r_USD_us_10y = `10 YR`) |>\n    mutate(r_USD_us_10y = r_USD_us_10y / 100)\n\nNote que eu nomeio a taxa de juros americana com r_USD_us_10y, pois essa √© uma taxa que capitaliza o d√≥lar (USD) nos Estados Unidos (us). Abaixo fa√ßo um malabarismo com tidyr::pivot_longer para preparar os dados para o ggplot e assim visualiz√°-los lado a lado. Note ainda que libero a escala dos gr√°ficos (scales = \"free_y\") para que a diferen√ßa de n√≠vel entre as taxas de juros, brasileira e americana, n√£o afete a an√°lise. O objetivo √© visualizar a din√¢mica das taxas de juros ao longo do tempo.\n\nrates_10y |>\n    tidyr::pivot_longer(\n        c(r_BRL_10y, r_USD_us_10y),\n        names_to = \"rates\"\n    ) |>\n    ggplot(aes(x = refdate, y = value, colour = rates)) +\n    geom_line() +\n    facet_wrap(. ~ rates, scales = \"free_y\") +\n    labs(\n        x = NULL, y = NULL,\n        title = \"Hist√≥rico de Taxas de Juros de 10 Anos\",\n        subtitle = \"Americanos (r_USD_us_10y) e Brasileiro (r_BRL_10y)\",\n        caption = \"wilsonfreitas\"\n    ) +\n    scale_y_continuous(labels = scales::percent) +\n    theme(legend.position = \"none\")"
  },
  {
    "objectID": "posts/2022-06-10-histrico-de-taxas-de-juros-em-dlar-no-brasil/histrico-de-taxas-de-juros-em-dlar-no-brasil.html",
    "href": "posts/2022-06-10-histrico-de-taxas-de-juros-em-dlar-no-brasil/histrico-de-taxas-de-juros-em-dlar-no-brasil.html",
    "title": "Hist√≥rico de Taxas de Juros em D√≥lar no Brasil",
    "section": "",
    "text": "Em um post recente.\n\nlibrary(Quandl)\n\nyc_all <- Quandl(\"USTREASURY/YIELD\")\n\n\n\n\n\nlibrary(rb3)\nlibrary(bizdays)\nlibrary(tidyverse)\nlibrary(fixedincome)\n\n\ndusd <- yc_usd_mget(\n  first_date = \"2019-01-01\",\n  last_date = preceding(Sys.Date() - 1, \"Brazil/ANBIMA\"),\n  cache_folder = \"../../../rb3-data\"\n)\n\n\nunique(dusd$refdate) |> map(function(date, df) {\n  df_curve <- df |>\n    filter(refdate == date, cur_days > 0) |>\n    filter(!duplicated(cur_days))\n  curve <- spotratecurve(\n    df_curve$r_360,\n    df_curve$cur_days,\n    \"simple\", \"actual/360\", \"actual\",\n    refdate = date\n  )\n  interpolation(curve) <- interp_flatforward()\n  curve\n}, df = dusd) -> curves_usd\n\n\ncurves_usd |>\n  map_dfr(\\(x) tibble(\n    refdate = x@refdate,\n    r_USD_br_10y = as.numeric(x[[3600]])\n  )) -> rates_usd_10y\n\n\nyc_all |>\n  rename(refdate = \"Date\", r_USD_us_10y = `10 YR`) |>\n  mutate(r_USD_us_10y = r_USD_us_10y / 100) |>\n  inner_join(rates_usd_10y, by = \"refdate\") |>\n  # filter(!is.na(r_USD_br_10y)) |>\n  tidyr::pivot_longer(c(r_USD_br_10y, r_USD_us_10y),\n    names_to = \"rates\"\n  ) |>\n  ggplot(aes(x = refdate, y = value, colour = rates)) +\n  geom_line() +\n  labs(colour = NULL) +\n  theme(legend.position = \"bottom\") +\n  labs(\n    x = NULL, y = NULL,\n    title = \"Hist√≥rico de Taxas de Juros em D√≥lar de 10 Anos\",\n    subtitle = \"Estados Unidos (r_USD_us_10y) e Brasil (r_USD_br_10y)\",\n    caption = \"wilsonfreitas\"\n  ) +\n  scale_y_continuous(labels = scales::percent) +\n  theme(legend.position = \"bottom\")"
  },
  {
    "objectID": "posts/2022-06-18-16-anos-de-curva-prefixada/16-anos-de-curva-prefixada.html",
    "href": "posts/2022-06-18-16-anos-de-curva-prefixada/16-anos-de-curva-prefixada.html",
    "title": "16 anos de Curva Prefixada",
    "section": "",
    "text": "library(rb3)\nlibrary(bizdays)\n\n\nAttaching package: 'bizdays'\n\n\nThe following object is masked from 'package:stats':\n\n    offset\n\nlibrary(dplyr)\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\nlibrary(fixedincome)\n\n\nAttaching package: 'fixedincome'\n\n\nThe following objects are masked from 'package:dplyr':\n\n    first, last\n\nlibrary(ggplot2)\n\n\n\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/080e2cb9e1e3eb735c8d6dc0c3194e86-parsed.rds that returns NULL.\n\n\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/1510e962a774e004d248683fd79b1374-parsed.rds that returns NULL.\n\n\n‚†ô Fetching data points 199/4054 | ‚ñ†‚ñ†                                 5% | ETA: ‚Ä¶\n\n\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/d8595c0a5e74dbf205b6146dcfd9ba03-parsed.rds that returns NULL.\n\n\n‚†ô Fetching data points 199/4054 | ‚ñ†‚ñ†                                 5% | ETA: ‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/18d6b35dd6d2aeb821e9fd9aa07dbc00-parsed.rds that returns NULL.\n‚†ô Fetching data points 199/4054 | ‚ñ†‚ñ†                                 5% | ETA: ‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/a4320cd9f9477bf8e373e3b6ae21374c-parsed.rds that returns NULL.\n‚†ô Fetching data points 199/4054 | ‚ñ†‚ñ†                                 5% | ETA: ‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/7b3f5d9f3c7f40d438cfb10527e854b3-parsed.rds that returns NULL.\n‚†ô Fetching data points 199/4054 | ‚ñ†‚ñ†                                 5% | ETA: ‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/427f326863e9f7e25213268f6330a79e-parsed.rds that returns NULL.\n‚†ô Fetching data points 199/4054 | ‚ñ†‚ñ†                                 5% | ETA: ‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/1dcfe447ea262e7a22e5e30b1a90ee3a-parsed.rds that returns NULL.\n‚†ô Fetching data points 199/4054 | ‚ñ†‚ñ†                                 5% | ETA: ‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/96156a38c615d754cc941aa54a434f51-parsed.rds that returns NULL.\n‚†ô Fetching data points 199/4054 | ‚ñ†‚ñ†                                 5% | ETA: ‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/6c4930212718a60fa6a9094d8c2461a2-parsed.rds that returns NULL.\n‚†ô Fetching data points 199/4054 | ‚ñ†‚ñ†                                 5% | ETA: ‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/1adc35776bcd63801ee57ce3f8f65667-parsed.rds that returns NULL.\n‚†ô Fetching data points 199/4054 | ‚ñ†‚ñ†                                 5% | ETA: ‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/99ea0e88b0cc34c835f52cdd0049a999-parsed.rds that returns NULL.\n‚†ô Fetching data points 199/4054 | ‚ñ†‚ñ†                                 5% | ETA: ‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/479f5927bd05578ed52ef2629cab7056-parsed.rds that returns NULL.\n‚†ô Fetching data points 199/4054 | ‚ñ†‚ñ†                                 5% | ETA: ‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/631a5c5accec13616555c0a78a9aa7f2-parsed.rds that returns NULL.\n‚†ô Fetching data points 199/4054 | ‚ñ†‚ñ†                                 5% | ETA: ‚Ä¶\n‚†∏ Fetching data points 754/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†                           19% | ETA: ‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/dcd47b0a844e38db6b61b9b63c22f6a3-parsed.rds that returns NULL.\n‚†∏ Fetching data points 754/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†                           19% | ETA: ‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/60d4032989dff49ad0d0c1c9076aff1a-parsed.rds that returns NULL.\n‚†∏ Fetching data points 754/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†                           19% | ETA: ‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/5674c7c054b857c8627674b061592516-parsed.rds that returns NULL.\n‚†∏ Fetching data points 754/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†                           19% | ETA: ‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/4faa28330b3585f9be27a543dea59d86-parsed.rds that returns NULL.\n‚†∏ Fetching data points 754/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†                           19% | ETA: ‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/f7646668172c0f4a610906fa21a2751c-parsed.rds that returns NULL.\n‚†∏ Fetching data points 754/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†                           19% | ETA: ‚Ä¶\n‚†º Fetching data points 1058/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†                         26% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/c8c023431cc0d19c3c95942d3a27b73a-parsed.rds that returns NULL.\n‚†º Fetching data points 1058/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†                         26% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/134bc1ec7d0a352b48354d5af68038f0-parsed.rds that returns NULL.\n‚†º Fetching data points 1058/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†                         26% | ETA:‚Ä¶\n‚†¥ Fetching data points 1364/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†                       34% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/117745dce5d5cb4d890e2230f5cca206-parsed.rds that returns NULL.\n‚†¥ Fetching data points 1364/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†                       34% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/68a26da34d9f76552f0305d314d843ef-parsed.rds that returns NULL.\n‚†¥ Fetching data points 1364/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†                       34% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/c465388767a41742d3153041e2aa95f4-parsed.rds that returns NULL.\n‚†¥ Fetching data points 1364/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†                       34% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/2b1a1b2e121587ad6e9c4d8bf75a69b3-parsed.rds that returns NULL.\n‚†¥ Fetching data points 1364/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†                       34% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/03111a15447935a196fccedf36243f1e-parsed.rds that returns NULL.\n‚†¥ Fetching data points 1364/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†                       34% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/199c548401f10e0252e2bef33605625a-parsed.rds that returns NULL.\n‚†¥ Fetching data points 1364/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†                       34% | ETA:‚Ä¶\n‚†¶ Fetching data points 1652/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†                     41% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/ae8212a0126585478946aa8eaa3c897d-parsed.rds that returns NULL.\n‚†¶ Fetching data points 1652/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†                     41% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/769bdbf6414d30e8695c2559b04f9313-parsed.rds that returns NULL.\n‚†¶ Fetching data points 1652/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†                     41% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/2493a7b1b75c928059789157a2afaed6-parsed.rds that returns NULL.\n‚†¶ Fetching data points 1652/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†                     41% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/4814b715cfe7655e14c1569734485b13-parsed.rds that returns NULL.\n‚†¶ Fetching data points 1652/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†                     41% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/d6a37e4f3970da2216baeeade0e9b962-parsed.rds that returns NULL.\n‚†¶ Fetching data points 1652/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†                     41% | ETA:‚Ä¶\n‚†ß Fetching data points 1892/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†                   47% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/41aa4082eeec395b7feb3a956bfb1a87-parsed.rds that returns NULL.\n‚†ß Fetching data points 1892/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†                   47% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/ced216837f9da99582aadad11ca0773d-parsed.rds that returns NULL.\n‚†ß Fetching data points 1892/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†                   47% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/be44ed0ec4186fc2fafdb47cc9614e87-parsed.rds that returns NULL.\n‚†ß Fetching data points 1892/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†                   47% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/a2a2abdbb71c86a1941da637bda10f45-parsed.rds that returns NULL.\n‚†ß Fetching data points 1892/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†                   47% | ETA:‚Ä¶\n‚†á Fetching data points 2146/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†                 53% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/f80d336c7034dca6d280d5300621956a-parsed.rds that returns NULL.\n‚†á Fetching data points 2146/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†                 53% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/1921f576fd77dc68dcc361d921f7d33f-parsed.rds that returns NULL.\n‚†á Fetching data points 2146/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†                 53% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/56ea48877c8a76f9400c87be31f8028e-parsed.rds that returns NULL.\n‚†á Fetching data points 2146/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†                 53% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/3a377df9574995fcea76277cf66229a4-parsed.rds that returns NULL.\n‚†á Fetching data points 2146/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†                 53% | ETA:‚Ä¶\n‚†è Fetching data points 2382/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†               59% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/fbfb62bc5bf85827f6a379f1f90ef457-parsed.rds that returns NULL.\n‚†è Fetching data points 2382/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†               59% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/f167df23f63004a18ce9b42308f40f82-parsed.rds that returns NULL.\n‚†è Fetching data points 2382/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†               59% | ETA:‚Ä¶\n‚†ã Fetching data points 2662/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†             66% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/125bfbd76261eb5f9fb51caa162ff9d4-parsed.rds that returns NULL.\n‚†ã Fetching data points 2662/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†             66% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/1ebdf89b3c235780cffb64e60a8ef85a-parsed.rds that returns NULL.\n‚†ã Fetching data points 2662/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†             66% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/26bd082dfaf44bac451a55a5662a2fd6-parsed.rds that returns NULL.\n‚†ã Fetching data points 2662/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†             66% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/fa3875cac6688b226e699f5d1be8316e-parsed.rds that returns NULL.\n‚†ã Fetching data points 2662/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†             66% | ETA:‚Ä¶\n‚†ô Fetching data points 2921/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†           72% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/9bae55e162e6d8634116689db1ced4de-parsed.rds that returns NULL.\n‚†ô Fetching data points 2921/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†           72% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/93cedd658d260591bf4b89f2a301d3a6-parsed.rds that returns NULL.\n‚†ô Fetching data points 2921/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†           72% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/e5e67b76c7684e229e92ebf31defddb0-parsed.rds that returns NULL.\n‚†ô Fetching data points 2921/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†           72% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/0cb75e7608014434b910d0f6eed469d6-parsed.rds that returns NULL.\n‚†ô Fetching data points 2921/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†           72% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/60f1cac688426f3548bde90067ff6b57-parsed.rds that returns NULL.\n‚†ô Fetching data points 2921/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†           72% | ETA:‚Ä¶\n‚†π Fetching data points 3197/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†         79% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/120615d3cc3e40c40f3da1bc530ee976-parsed.rds that returns NULL.\n‚†π Fetching data points 3197/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†         79% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/efd149e6dea0edb26cab44371a11bd9c-parsed.rds that returns NULL.\n‚†π Fetching data points 3197/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†         79% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/89377ffb8213ffc3f60c414db22f5194-parsed.rds that returns NULL.\n‚†π Fetching data points 3197/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†         79% | ETA:‚Ä¶\n‚†∏ Fetching data points 3494/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†       86% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/d025aaaff9277d60fad129c2a947d288-parsed.rds that returns NULL.\n‚†∏ Fetching data points 3494/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†       86% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/e3685c842eb0d208cb90f72e16d525a7-parsed.rds that returns NULL.\n‚†∏ Fetching data points 3494/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†       86% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/97177d9d007efd4de20b3ce969ced4cb-parsed.rds that returns NULL.\n‚†∏ Fetching data points 3494/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†       86% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/42878d933ac57df3374a4bafbd048175-parsed.rds that returns NULL.\n‚†∏ Fetching data points 3494/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†       86% | ETA:‚Ä¶\n‚†º Fetching data points 3752/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†     93% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/2b812e5506888e8c931cb540ae305b09-parsed.rds that returns NULL.\n‚†º Fetching data points 3752/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†     93% | ETA:‚Ä¶\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/55ca03ce272d07db0c5ac475424add1a-parsed.rds that returns NULL.\n‚†º Fetching data points 3752/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†     93% | ETA:‚Ä¶\n\n\nWarning: Automatic coercion from double to character was deprecated in purrr 1.0.0.\n‚Ñπ Please use an explicit call to `as.character()` within `map_chr()` instead.\n‚Ñπ The deprecated feature was likely used in the rb3 package.\n  Please report the issue at <https://github.com/wilsonfreitas/rb3/issues>.\n\n\n‚†¥ Fetching data points 3931/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†    97% | ETA:‚Ä¶\n‚†¶ Fetching data points 3938/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†    97% | ETA:‚Ä¶\n‚†ß Fetching data points 3945/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†    97% | ETA:‚Ä¶\n‚†á Fetching data points 3950/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†    97% | ETA:‚Ä¶\n‚†è Fetching data points 3956/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†    98% | ETA:‚Ä¶\n‚†ã Fetching data points 3962/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†    98% | ETA:‚Ä¶\n‚†ô Fetching data points 3968/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†    98% | ETA:‚Ä¶\n‚†π Fetching data points 3973/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†    98% | ETA:‚Ä¶\n‚†∏ Fetching data points 3979/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†    98% | ETA:‚Ä¶\n‚†º Fetching data points 3985/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†    98% | ETA:‚Ä¶\n‚†¥ Fetching data points 3991/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†   98% | ETA:‚Ä¶\n‚†¶ Fetching data points 3997/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†   99% | ETA:‚Ä¶\n‚†ß Fetching data points 4003/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†   99% | ETA:‚Ä¶\n‚†á Fetching data points 4009/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†   99% | ETA:‚Ä¶\n‚†è Fetching data points 4014/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†   99% | ETA:‚Ä¶\n! Removed C:\\Users\\wilso\\R\\rb3-cache/AjustesDiarios/8efc8696de8165690ea4be9abff3bfe8.html - It hasn't valid content.\n‚†è Fetching data points 4014/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†   99% | ETA:‚Ä¶\n‚†ã Fetching data points 4020/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†   99% | ETA:‚Ä¶\n‚†ô Fetching data points 4026/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†   99% | ETA:‚Ä¶\n‚†π Fetching data points 4032/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†   99% | ETA:‚Ä¶\n‚†∏ Fetching data points 4037/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†  100% | ETA:‚Ä¶\n‚†º Fetching data points 4042/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†  100% | ETA:‚Ä¶\n‚†¥ Fetching data points 4048/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†  100% | ETA:‚Ä¶\n‚†¶ Fetching data points 4053/4054 | ‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†‚ñ†  100% | ETA:‚Ä¶\n\n\nO pacote {rb3} faz extra√ß√µes de dados do site da B3. Temos diversas informa√ß√µes dispon√≠veis no site inclusive o hist√≥rico de diversos dados.\nUm conjunto de dados que mais utilizo s√£o os pre√ßos de ajuste dos contratos futuros. Este hist√≥rico √© um dos mais antigos dispon√≠vel.\nVou baixar todo o hist√≥rico de contratos futuros desde 2007. A partir dos pre√ßos de ajuste √© poss√≠vel construir o hist√≥rico de curvas prefixadas. Depois vou fazer uma segmenta√ß√£o pelo ano da data de refer√™ncia para que seja poss√≠vel visualizar, para cada ano, todo o espectro de curvas no ano.\nVou come√ßar baixando todos os dados desde 2007 at√© a √∫ltima data dispon√≠vel. Para isso vou utilizar a fun√ß√£o rb3::futures_mget. Isso leva um bom tempo!\n\ndf <- futures_mget(\n  first_date = \"2007-01-01\",\n  last_date = preceding(Sys.Date() - 1, \"Brazil/ANBIMA\")\n)\n\n√â necess√°rio filtrar os contratos futuros de DI1 para construir a curva prefixada.\n\ndf_di1 <- df |> filter(commodity == \"DI1\")\n\nPara construir a curva prefixada √© necess√°rio obter as datas de vencimento dos contratos futuros. Para isso utilizo a fun√ß√£o rb3::maturity2date que converte o c√≥digo de vencimento em data. Adicionalmente fa√ßo o ajuste da data de refer√™ncia criando a coluna fixing, calculo os dias √∫teis (coluna business_days) e a taxa de juros com base no pre√ßo de ajuste price gerando a coluna adjusted_tax.\n\ndf_di1_futures <- df_di1 |>\n  mutate(\n    maturity_date = maturity2date(maturity_code),\n    fixing = following(maturity_date, \"Brazil/ANBIMA\"),\n    business_days = bizdays(refdate, fixing, \"Brazil/ANBIMA\"),\n    adjusted_tax = implied_rate(\"discrete\", business_days / 252, 100000 / price)\n  ) |>\n  filter(business_days > 0)\n\nTermino filtrando as linhas com business_days maior que zero, pois n√£o me interessam os futuros na data de vencimento.\nAgora vamos gerar a visualiza√ß√£o com ggplot2.\n\ndf_di1_futures |>\n  mutate(year = as.integer(format(refdate, \"%Y\"))) |>\n  ggplot(aes(\n    x = business_days, y = adjusted_tax,\n    group = refdate\n  )) +\n  geom_line(alpha = 0.2) +\n  facet_wrap(. ~ year) +\n  labs(\n    x = \"Dias √öteis\", y = \"Taxas\",\n    title = \"16 anos de Curva Prefixada\",\n    subtitle = \"Curvas constru√≠das a partir dos pre√ßos de ajuste dos contratos Futuros DI1\",\n    caption = \"Fonte: B3 (obtidos com \\U1F4E6 rb3) - wilsonfreitas\"\n  ) +\n  scale_y_continuous(labels = scales::percent)\n\n\n\n\nCurioso ver a mudan√ßa de shape da curva entre os anos e ao longo de cada ano. Uma coisa curiosa √© observar os anos de 2016, 2017 e 2018. 2016/2017 foram os anos do impechemant da presidente Dilma. Em 2016 a parte curta da curva variou pouco e a parte longa variou muito. Em 2017 aconteceu o oposto, a parte curta da curva variou mais que a parte longa da curva. Nestes anos, as mudan√ßas afetam diretamente o shape da curva. Em 2018, o ano da elei√ß√£o e da facada do Bolsonaro, h√° uma grande varia√ß√£o na parte longa da curva, mas sem alterar o shape da curva. Ainda √© poss√≠vel avaliar o comportamento da curva com os demais eventos pol√≠ticos e econ√¥micos. Em 2021, por exemplo, onde ocorreu uma eleva√ß√£o da taxa SELIC e uma piora do cen√°rio fiscal, temos um espectro muita amplo do shape da curva.\n√â poss√≠vel construir uma visualiza√ß√£o equivalente utilizando dados da curva americana que podem ser obtidos com o pacote Quandl.\n\nlibrary(Quandl)\n\nyc_all <- Quandl(\"USTREASURY/YIELD\")\n\n\n\nLoading required package: xts\n\n\nLoading required package: zoo\n\n\n\nAttaching package: 'zoo'\n\n\nThe following objects are masked from 'package:base':\n\n    as.Date, as.Date.numeric\n\n\n\nAttaching package: 'xts'\n\n\nThe following objects are masked from 'package:fixedincome':\n\n    first, last\n\n\nThe following objects are masked from 'package:dplyr':\n\n    first, last\n\n\nOs dados vem no formato wide onde cada coluna representa um v√©rtice e cada linha uma curva. Dessa maneira, fa√ßo a convers√£o dos dados para o formato longo com a fun√ß√£o tidyr::pivot_longer.\n\nyc_all <- as_tibble(yc_all)\n\nyc_all_longer <- yc_all |>\n  tidyr::pivot_longer(cols = `1 MO`:`30 YR`)\n\nyc_all_longer\n\n# A tibble: 99,480 √ó 3\n   Date       name  value\n   <date>     <chr> <dbl>\n 1 2023-02-17 1 MO   4.64\n 2 2023-02-17 2 MO   4.81\n 3 2023-02-17 3 MO   4.84\n 4 2023-02-17 6 MO   4.99\n 5 2023-02-17 1 YR   5   \n 6 2023-02-17 2 YR   4.6 \n 7 2023-02-17 3 YR   4.33\n 8 2023-02-17 5 YR   4.03\n 9 2023-02-17 7 YR   3.95\n10 2023-02-17 10 YR  3.82\n# ‚Ä¶ with 99,470 more rows\n\n\nAqui fa√ßo o tratamento dos dados para converter os prazos em n√∫meros, considerando meses de 30 dias e anos de 360 dias.\n\nlibrary(stringr)\n\nn <- str_match(yc_all_longer$name, \"\\\\d+\") |> as.numeric()\np <- str_match(yc_all_longer$name, \"(MO|YR)$\")[, 1]\nyc_all_longer$days <- ifelse(p == \"MO\", 30, 360) * n\n\nyc_all_longer\n\n# A tibble: 99,480 √ó 4\n   Date       name  value  days\n   <date>     <chr> <dbl> <dbl>\n 1 2023-02-17 1 MO   4.64    30\n 2 2023-02-17 2 MO   4.81    60\n 3 2023-02-17 3 MO   4.84    90\n 4 2023-02-17 6 MO   4.99   180\n 5 2023-02-17 1 YR   5      360\n 6 2023-02-17 2 YR   4.6    720\n 7 2023-02-17 3 YR   4.33  1080\n 8 2023-02-17 5 YR   4.03  1800\n 9 2023-02-17 7 YR   3.95  2520\n10 2023-02-17 10 YR  3.82  3600\n# ‚Ä¶ with 99,470 more rows\n\n\nAgora fazemos a visualiza√ß√£o.\n\nyc_all_longer |>\n  mutate(\n    year = as.integer(format(Date, \"%Y\")),\n    value = value / 100\n  ) |>\n  filter(year >= 2007) |>\n  ggplot(aes(\n    x = days, y = value,\n    group = Date\n  )) +\n  geom_line(alpha = 0.2) +\n  facet_wrap(. ~ year) +\n  labs(\n    x = \"Dias Corridos\", y = \"Taxas\",\n    title = \"16 anos de Curva Prefixada Americana\",\n    caption = \"Fonte: US Treasury (obtidos com \\U1F4E6 Quandl) - wilsonfreitas\"\n  ) +\n  scale_y_continuous(labels = scales::percent)\n\n\n\n\nJ√° na curva americana, a din√¢mica √© muito mais bem comportada. A parte longo costuma oscilar, mas mantendo a din√¢mica. Os anos 2007, 2008 e 2020, onde tivemos crise do subprime e COVID, trouxeram mais volatilidade."
  },
  {
    "objectID": "posts/2022-06-19-super-datasets-do-pacote-rb3/super-datasets-do-pacote-rb3.html",
    "href": "posts/2022-06-19-super-datasets-do-pacote-rb3/super-datasets-do-pacote-rb3.html",
    "title": "Super Datasets do Pacote rb3",
    "section": "",
    "text": "A vers√£o 0.0.3 do pacote {rb3} trouxe fun√ß√µes que retornam super datasets. Estes super datasets s√£o dataframes com dados organizados para um fim espec√≠fico. Por exemplo, a fun√ß√£o rb3::yc_get retorna um dataframe com dados da curva de juros para diversos v√©rtices, dentre os v√©rtices retornados alguns s√£o referentes aos vencimentos dos contratos futuros utilizados para produzir a curva original. Para alguns problemas √© interessante conhecer quais v√©rtices s√£o referentes aos futuros, por exemplo, na cria√ß√£o de fatores primitivos de risco, onde a interpola√ß√£o deve ser realizada utilizando apenas os futuros. Os contratos futuros podem ser obtidos com a fun√ß√£o rb3::futures_get. Dessa maneira, a fun√ß√£o rb3::yc_superset junta os dados retornados pelas fun√ß√µes rb3::yc_get e rb3::futures_get identificando os vencimentos dos contratos futuros na curva de juros. Por isso super dataset, √© um dataset mais rico!\nAtualmente o pacote apresenta as seguintes fun√ß√µes superset:\n\nrb3::yc_superset retorna a curva de juros de prefixados com os contratos fututos DI1 identificados.\nrb3::yc_usd_superset retorna a curva de cupom cambial com os contratos fututos DOL identificados.\nrb3::yc_ipca_superset retorna a curva de juros reais com os contratos fututos DAP identificados.\nrb3::cotahist_equity_options_superset retorna dados de op√ß√µes de a√ß√µes com informa√ß√µes de a√ß√µes e taxas de juros.\n\nVou exemplificar a utiliza√ß√£o de um super dataset com a fun√ß√£o rb3::yc_superset. Vou criar uma curva de juros apenas com os contratos futuros de DI1. Mas antes vou responder uma pergunta que talvez tenha chegado a cabe√ßa dos leitores: Por que criar uma curva de juros apenas com os contratos futuros se j√° tenho uma curva de juros cheia de v√©rtices? Primeiramente, toda curva de juros nasce a partir de um conjunto de contratos, no caso da curva prefixada utiliza-se os contratos futuros DI1, mais a taxa DI no v√©rtice de 1 dia √∫til, assim, estaria retornando a curva ao seu estado original. Logo, todos os demais v√©rtices da curva s√£o obtidos a partir da interpola√ß√£o entre os contratos futuros. Adicionalmente, caso eu precise de um v√©rtice que n√£o est√° na curva ser√° necess√°rio interpolar e como interpolar se n√£o conhe√ßo os v√©rtices referentes aos futuros? Bem, posso interpolar nos v√©rtices presentes, mas assim estaria interpolando sobre v√©rtices interpolados. N√£o √© um grande problema fazer isso, mas isso pode trazer problemas na contru√ß√£o de fatores de risco para taxa de juros, por exemplo.\nDando sequ√™ncia, primeiro utilizamos o {rb3} para obter os dados dos futuros e da curva para a data de refer√™ncia.\n\nlibrary(rb3)\n\nrefdate <- \"2022-06-17\"\n\nfut <- futures_get(refdate)\nyc <- yc_get(refdate)\n\nDepois passo estes dados para a fun√ß√£o yc_superset que junta os dados para indentificar os contratos futuros.\n\ndf <- yc_superset(yc, fut)\ndf |> head()\n\n# A tibble: 6 √ó 7\n  refdate    cur_days biz_days forward_date r_252 r_360 symbol\n  <date>        <int>    <dbl> <date>       <dbl> <dbl> <chr> \n1 2022-06-17        3        1 2022-06-20   0.132 0     <NA>  \n2 2022-06-17        7        5 2022-06-24   0.132 0.134 <NA>  \n3 2022-06-17       12        8 2022-06-29   0.132 0.125 <NA>  \n4 2022-06-17       13        9 2022-06-30   0.132 0.13  <NA>  \n5 2022-06-17       14       10 2022-07-01   0.132 0.134 DI1N22\n6 2022-06-17       21       15 2022-07-08   0.132 0.134 <NA>  \n\n\nTendo o super dataset eu filtro as linhas referentes aos futuros e a linha referente a 1 dia √∫til.\n\nlibrary(dplyr)\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\ndf_curve <- bind_rows(\n  df |> filter(biz_days == 1) |> select(biz_days, r_252),\n  df |> filter(!is.na(symbol)) |> select(biz_days, r_252)\n)\n\ndf_curve |> head()\n\n# A tibble: 6 √ó 2\n  biz_days r_252\n     <dbl> <dbl>\n1        1 0.132\n2       10 0.132\n3       31 0.132\n4       54 0.133\n5       75 0.134\n6       95 0.134\n\n\nPronto! Tenho a curva original novamente.\nApenas para ilustrar, vamos utilizar o pacote {fixedincome} para construir um objeto de curva de juros e visualizar os dados.\n\nlibrary(fixedincome)\n\n\nAttaching package: 'fixedincome'\n\n\nThe following objects are masked from 'package:dplyr':\n\n    first, last\n\ncurve <- spotratecurve(\n  df_curve$r_252, df_curve$biz_days, \"discrete\", \"business/252\", \"Brazil/ANBIMA\",\n  refdate = as.Date(refdate)\n)\n\nVisualizando a curva.\n\nggspotratecurveplot(curve)\n\n\n\n\nVisualizando para um horizonte mais curto e adicionando as taxas a termo.\n\ncurve_2y <- curve |> fixedincome::first(\"2 years\")\nggspotratecurveplot(curve_2y) +\n  ggplot2::autolayer(forwardrate(curve_2y))\n\n\n\n\nBem, os super datasets est√£o a√≠ para ajudar! Entregam dados da B3 mais mastigados para as necessidades dos quants do mercado brasileiro."
  },
  {
    "objectID": "posts/2022-06-24-super-datasets-para-opcoes-de-acoes/super-datasets-para-opcoes-de-acoes.html",
    "href": "posts/2022-06-24-super-datasets-para-opcoes-de-acoes/super-datasets-para-opcoes-de-acoes.html",
    "title": "Super Datasets para Op√ß√µes de A√ß√µes",
    "section": "",
    "text": "Dados de op√ß√µes de a√ß√µes finalmente dispon√≠veis de forma simples e direta. Durante muito tempo busquei isso, os dados de op√ß√µes s√£o mais chatos pois precisam de outros dados para a realiza√ß√£o dos c√°lculos. Ter apenas os dados de pr√™mio das op√ß√µes (pre√ßos das op√ß√µes) n√£o permite que diversas das medidas de interesse associadas a op√ß√µes, como as gregas e a volatilidade impl√≠cita, sejam calculadas. Utilizando Black & Scholes √© necess√°rio ainda ter o pre√ßo do ativo objeto (pre√ßo da a√ß√£o) e as taxas de juros. Com estas informa√ß√µes √© poss√≠vel calcular a volatilidade e a partir da√≠ todas as demais medidas de interesse podem ser calculadas.\nVou mostrar aqui como calcular a volatilidade e as gregas para op√ß√µes a partir de dados obtidos com o pacote {rb3}. Para realizar os c√°lculos com as op√ß√µes eu utilizo o pacote {oplib} que desenvolvi com diversos modelos implementados:\n\nBlack, Scholes & Merto para apre√ßamento das op√ß√µes\nBlack para apre√ßamento de op√ß√µes sobre futuros, utilizado em op√ß√µes sobre √≠ndices de taxas de juros, como IDI\nCorrado-Su para o apre√ßamento de op√ß√µes considerando assimetria e curtose\nentre outros\n\nEste pacote ainda √© experimental, n√£o est√° publicado no CRAN e a documenta√ß√£o ainda est√° em desenvolvimento.\nVamos come√ßar carregando os pacotes\n\nlibrary(rb3)\nlibrary(bizdays)\n\n\nAttaching package: 'bizdays'\n\n\nThe following object is masked from 'package:stats':\n\n    offset\n\nlibrary(tidyverse)\n\n‚îÄ‚îÄ Attaching packages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse 1.3.2\n‚îÄ‚îÄ\n\n\n‚úî ggplot2 3.4.1     ‚úî purrr   1.0.1\n‚úî tibble  3.1.8     ‚úî dplyr   1.1.0\n‚úî tidyr   1.3.0     ‚úî stringr 1.5.0\n‚úî readr   2.1.4     ‚úî forcats 1.0.0\n‚îÄ‚îÄ Conflicts ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse_conflicts() ‚îÄ‚îÄ\n‚úñ dplyr::filter() masks stats::filter()\n‚úñ dplyr::lag()    masks stats::lag()\n\nlibrary(oplib)\n\nVamos selecionar o √∫ltimo dia √∫til para obter os dados di√°rios do arquivo COTAHIST disponibilizado pela B3. O arquivo COTAHIST traz diversas informa√ß√µes do mercado de a√ß√µes e inclui as op√ß√µes. Adicionalmente, precisamos das taxas de juros e utilizo a fun√ß√£o rb3::yc_get para obter a curva de juros para a data de refer√™ncia.\n\nrefdate <- preceding(\"2022-06-24\", \"Brazil/ANBIMA\")\nch <- cotahist_get(refdate, \"daily\")\nyc <- yc_get(refdate)\n\nCom os dados de a√ß√µes e op√ß√µes, pelo arquivo COTAHIST, e com as taxas de juros, utilizo a fun√ß√£o rb3::cotahist_options_by_symbol_superset para obter os dados de op√ß√µes para um s√≠mbolo espec√≠fico. Aqui vou utilizar PETR4 que √© uma das a√ß√µes com maior volume de negocia√ß√£o na bolsa.\n\nsymbol_ <- \"PETR4\"\nop1 <- cotahist_options_by_symbol_superset(symbol_, ch, yc)\n\nNo data.frame op1 temos informa√ß√µes de pre√ßo da a√ß√£o na data de refer√™ncia, pre√ßos das op√ß√µes, taxas de juros, vencimento das op√ß√µes, volumes de negocia√ß√£o e diversas outras informa√ß√µes.\n\nop1\n\n# A tibble: 437 √ó 28\n   refdate    symbol   type  strike maturity_d‚Ä¶¬π  open  high   low close average\n   <date>     <chr>    <fct>  <dbl> <date>       <dbl> <dbl> <dbl> <dbl>   <dbl>\n 1 2022-06-24 PETRA140 Call    1.94 2023-01-20   24.8  24.8  24.8  24.8    24.8 \n 2 2022-06-24 PETRA239 Call   50.4  2023-01-20    0.09  0.24  0.09  0.23    0.15\n 3 2022-06-24 PETRA281 Call   18.4  2023-01-20    9.6   9.6   9.6   9.6     9.6 \n 4 2022-06-24 PETRA297 Call   30.2  2023-01-20    2.7   2.7   2.7   2.7     2.7 \n 5 2022-06-24 PETRA359 Call   29.4  2023-01-20    2.87  2.87  2.87  2.87    2.87\n 6 2022-06-24 PETRA361 Call   26.4  2023-01-20    4.3   4.3   4.23  4.23    4.24\n 7 2022-06-24 PETRD450 Call   38.4  2023-04-20    1.42  1.42  1.42  1.42    1.42\n 8 2022-06-24 PETRG1   Call   13.4  2022-07-15   13.7  13.7  12.6  12.6    13.6 \n 9 2022-06-24 PETRG121 Call   19.2  2022-07-15    7.87  7.87  7.36  7.37    7.79\n10 2022-06-24 PETRG178 Call   20.2  2022-07-15    6.7   6.7   6.45  6.45    6.45\n# ‚Ä¶ with 427 more rows, 18 more variables: volume <dbl>,\n#   traded_contracts <dbl>, transactions_quantity <int>, distribution_id <int>,\n#   symbol.underlying <chr>, open.underlying <dbl>, high.underlying <dbl>,\n#   low.underlying <dbl>, close.underlying <dbl>, average.underlying <dbl>,\n#   best_bid <dbl>, best_ask <dbl>, volume.underlying <dbl>,\n#   traded_contracts.underlying <dbl>, transactions_quantity.underlying <int>,\n#   distribution_id.underlying <int>, fixing_maturity_date <date>, ‚Ä¶\n\n\npara simplificar os c√°lculos vou separar duas informa√ß√µes √∫teis, os vencimentos das op√ß√µes e o pre√ßo de fechamento da a√ß√£o, que √© √∫nico para a data de refer√™ncia. Os vencimentos das op√ß√µes s√£o ordenados para que eu possa facilmente selecionar um vencimento desejado.\n\nmaturities <- unique(op1$maturity_date) |> sort()\nclose_underlying <- op1$close.underlying[1]\n\nAs op√ß√µes de a√ß√µes, tipicamente, possuem maior liquidez no primeiro vencimento dispon√≠vel. Por isso, vou selecionar todas as op√ß√µes com maturity_date == maturities[1].\n\nop_vol <- op1 |>\n  filter(maturity_date == maturities[1]) |>\n  mutate(\n    biz_days = bizdays(\n      refdate, following(maturity_date, \"Brazil/ANBIMA\"), \"Brazil/ANBIMA\"\n    ),\n    time_to_maturity = biz_days / 252,\n    rate = log(1 + r_252),\n    impvol = bsmimpvol(\n      close, type, close.underlying, strike, time_to_maturity, rate, 0\n    ),\n    delta = bsmdelta(\n      type, close.underlying, strike, time_to_maturity, rate, 0, impvol\n    )\n  ) |>\n  select(\n    symbol, volume,\n    type, close.underlying, strike, time_to_maturity, rate, impvol,\n    delta, biz_days, volume\n  )\n\nAp√≥s a sele√ß√£o das op√ß√µes, uma s√©rie de c√°lculos s√£o realizados para obter:\n\ndias √∫teis at√© o vencimento biz_days\nprazo em anos at√© o vencimento time_to_maturity\ntaxas de juros em capitaliza√ß√£o cont√≠nua rate\nvolatilidade impl√≠cita impvol com o modelo Black & Scholes\na grega delta para o modelo Black & Scholes\n\nEm seguida algumas vari√°veis s√£o selecionadas para a visualiz√ß√£o dos dados.\nVamos visualizar o smile de volatilidade para com os pre√ßos de exerc√≠cio das op√ß√µes no eixo X Coloco uma linha vertical marcando o n√≠vel do pre√ßo do ativo objeto, facilitando a interpreta√ß√£o do que est√° dentro/fora do dinheiro para as op√ß√µes de compra e venda (Calls e Puts). O tamanho de cada ponto √© definido pelo volumen de negocia√ß√£o de cada op√ß√£o. Interessante notar que os maiores volumes ficam nos strikes pr√≥ximos do pre√ßo atual do ativo objeto. Estas s√£o as op√ß√µes ATM, no dinheiro.\n\nop_vol |>\n  filter(!is.na(impvol)) |>\n  ggplot(aes(x = strike, y = impvol, colour = type, size = volume)) +\n  geom_point() +\n  geom_vline(xintercept = close_underlying, alpha = 0.5, size = 1) +\n  facet_wrap(type ~ biz_days) +\n  theme(legend.position = \"bottom\") +\n  labs(\n    x = \"Strike\", y = \"Implied Volatility\",\n    title = str_glue(\"Equity Options Volatility - {symbol_} {format(refdate)}\")\n  )\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\n‚Ñπ Please use `linewidth` instead.\n\n\n\n\n\nAbaixo temos o smile de volatilidade com o delta das op√ß√µes no eixo X. Aqui fica mais f√°cil visualizar as op√ß√µes ATM, pois estas tem delta de 0.5 (ou -0.5 no caso das Puts).\n\nop_vol |>\n  filter(!is.na(impvol)) |>\n  ggplot(aes(x = delta, y = impvol, colour = type, size = volume)) +\n  geom_point() +\n  geom_vline(xintercept = c(-0.5, 0.5), alpha = 0.5, size = 1) +\n  facet_wrap(~ biz_days, scales = \"free\") +\n  theme(legend.position = \"bottom\") +\n  labs(\n    x = \"Delta\", y = \"Implied Volatility\",\n    title = str_glue(\"Equity Options Volatility - {symbol_} {format(refdate)}\")\n  )\n\n\n\n\nO objetivo deste post √© mostrar como √© f√°cil obter dados de op√ß√µes com o pacote {rb3} e com o pacote {oplib} realizar os c√°lculos com estes dados."
  },
  {
    "objectID": "posts/2022-08-17-movimento-da-parte-longa-da-curva-de-juros/movimento-da-parte-longa-da-curva-de-juros.html",
    "href": "posts/2022-08-17-movimento-da-parte-longa-da-curva-de-juros/movimento-da-parte-longa-da-curva-de-juros.html",
    "title": "Movimento da Parte Longa da Curva de Juros",
    "section": "",
    "text": "A reuni√£o do COPOM de 3 de agosto trouxe uma mudan√ßa na estrutura da curva de juros, tanto para a parte curta como para a parte longa. A interpreta√ß√£o do comunicado por agentes de mercado √© de o ciclo de alta de juros est√° pr√≥ximo do fim.\nNa pr√°tica a din√¢mica da parte longa da curva de juros foi bastante afetada. Aqui apresento uma anima√ß√£o onde observa-se o movimento da curva de juros nas duas primeiras semanas do m√™s de agosto de 2022. A reuni√£o do COPOM aconteceu em 3 de agosto. Fica claro pela anima√ß√£o a mudan√ßa nas expectativas de longo prazo para a curva.\nVamos utilizar o üì¶ {rb3} para obter as curvas e o üì¶ {fixedincome} na constru√ß√£o dos gr√°ficos da estrutura a termo de juros. A anima√ß√£o √© construida com o üì¶ {animation}.\n\nlibrary(fixedincome)\nlibrary(rb3)\nlibrary(bizdays)\n\n\nAttaching package: 'bizdays'\n\n\nThe following object is masked from 'package:stats':\n\n    offset\n\nlibrary(dplyr)\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:fixedincome':\n\n    first, last\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\nlibrary(ggplot2)\n\nget_di1_curve <- function(refdate) {\n  fut <- futures_get(refdate)\n  yc <- yc_get(refdate)\n  df <- yc_superset(yc, fut)\n\n  df_curve <- bind_rows(\n    df |> slice(1) |> select(biz_days, r_252),\n    df |> filter(!is.na(symbol)) |> select(biz_days, r_252)\n  ) |>\n    filter(!duplicated(biz_days))\n\n  spotratecurve(\n    df_curve$r_252, df_curve$biz_days, \"discrete\", \"business/252\", \"Brazil/ANBIMA\",\n    refdate = refdate\n  )\n}\n\nVamos obter as curvas para os dias √∫teis entre 2022-08-01 e 2022-08-16 e coloc√°-las em uma lista. Na sequ√™ncia a anima√ß√£o ser√° constru√≠da com cada uma das curvas da lista, sendo que a primeira curva tem a cor vermelha e a √∫ltima tem cor azul, as demais curvas s√£o em cinza. O objetivo √© acompanhar a evolu√ß√£o das curvas tendo em destaque o come√ßo e fim.\n\ndates <- bizseq(\"2022-08-01\", \"2022-08-16\", \"Brazil/ANBIMA\")\ncurves <- lapply(seq_along(dates), function(ix) get_di1_curve(dates[ix]))\n\nanim <- animation::saveGIF(\n  {\n    g <- autoplot(curves[[1]], curve.x.axis = \"terms\", colour = \"red\") +\n      autolayer(curves[[1]], curve.geom = \"point\", curve.x.axis = \"terms\", colour = \"red\") +\n      ylim(0.11, 0.14) +\n      theme_bw() +\n      theme(legend.position = \"none\") +\n      labs(\n        x = \"Prazos\", y = NULL, title = \"Curvas de Juros Prefixados DI1\",\n        subtitle = \"Entre as datas 2022-08-01 e 2022-08-16\",\n        caption = \"Desenvolvido por wilsonfreitas / Fonte: B3\"\n      )\n    print(g)\n\n    for(curve in curves[-c(1, length(curves))]) {\n      g <- g + autolayer(curve, curve.x.axis = \"terms\", colour = \"grey\") +\n        autolayer(curve,\n          curve.geom = \"point\", curve.x.axis = \"terms\", colour = \"grey\"\n        )\n      print(g)\n    }\n\n    g <- g + autolayer(curves[[length(curves)]], curve.x.axis = \"terms\", colour = \"blue\") +\n      autolayer(curves[[length(curves)]],\n        curve.geom = \"point\", curve.x.axis = \"terms\", colour = \"blue\"\n      )\n    print(g)\n  },\n  interval = 0.8,\n  ani.height = 400,\n  ani.width = 704\n)\n\nOutput at: animation.gif"
  },
  {
    "objectID": "posts/2022-08-29-dinamica-da-volatilidade-implicita/dinamica-da-volatilidade-implicita.html",
    "href": "posts/2022-08-29-dinamica-da-volatilidade-implicita/dinamica-da-volatilidade-implicita.html",
    "title": "Din√¢mica da Volatilidade Impl√≠cita",
    "section": "",
    "text": "H√° divesos estudos sobre o comportamento das op√ß√µes e sobre quais fatores s√£o mais importantes para explicar as suas mudan√ßas de pre√ßos. Sabemos que, depois do ativo objeto, a volatilidade impl√≠cita √© a vari√°vel que mais influiencia nas varia√ß√µes de pre√ßos das op√ß√µes. Dessa forma, √© importante entender como se d√£o as suas varia√ß√µes, de outra forma, √© importante conhecer a sua din√¢mica.\nAqui vou carregar o hist√≥rico de op√ß√µes de PETR4 desde o come√ßo de 2022, calcular a volatilidade impl√≠cita e o delta para cada uma das op√ß√µes, e para cada data de refer√™ncia, selecionar as op√ß√µes, call e put, mais pr√≥ximas da data de vencimento e com o delta mais pr√≥ximo de 50%.\nAssim teremos uma op√ß√£o, para cada tipo, call e put, em cada data de refer√™ncia. Dessa maneira, √© poss√≠vel construir uma s√©rie temporal de volatilidade impl√≠cita por tipo de op√ß√£o.\nAs op√ß√µes mais pr√≥ximas do vencimento (ou primeiro vencimento), apresentam a maior liquidez dentre as op√ß√µes negociadas. Aqui estamos selecionando o primeiro vencimento at√© a sua expira√ß√£o, entretanto, √© interessante que seja realizada uma an√°lise da liquidez das op√ß√µes a medida que se aproximam do vencimento para que uma estrat√©gia de rolagem seja definida. Pois, na medida que o primeiro vencimento se aproxima, a liquidez migra para o segundo vencimento. O desafio √© identificar a din√¢mica dessa migra√ß√£o. Aqui isso n√£o ser√° levado em considera√ß√£o, vamos carregar as op√ß√µes do primeiro vencimento at√© a sua expira√ß√£o.\nCome√ßando com o carregamento de pacotes.\nAs op√ß√µes s√£o carregadas via o arquivo COTAHIST (rb3::cotahist_get) e as curvas de juro s√£o baixadas do site da B3 na p√°gina de Taxas de Refer√™ncia (rb3::yc_mget).\nVamos utilizar a fun√ß√£o rb3::cotahist_options_by_symbol_superset para obter o super dataset para op√ß√µes de PETR4. De posse do super dataset, os dados de vencimento e taxas de juros s√£o formatados para o c√°lculo da volatilidade impl√≠cita e do delta para todas as op√ß√µes."
  },
  {
    "objectID": "posts/2022-08-29-dinamica-da-volatilidade-implicita/dinamica-da-volatilidade-implicita.html#din√¢mica-da-volatilidade-atm",
    "href": "posts/2022-08-29-dinamica-da-volatilidade-implicita/dinamica-da-volatilidade-implicita.html#din√¢mica-da-volatilidade-atm",
    "title": "Din√¢mica da Volatilidade Impl√≠cita",
    "section": "Din√¢mica da Volatilidade ATM",
    "text": "Din√¢mica da Volatilidade ATM\nComo todos os c√°lculos realizados vamos selecionar as op√ß√µes ATM do primeiro vencimento para cada data de refer√™ncia. Fazemos uma segmenta√ß√£o dos dados por refdate e para cada chunk selecionamos o primeiro vencimento.\n\nop1 <- op_vol |>\n  split(op_vol$refdate) |>\n  map_dfr(function(df) {\n    first_mat <- df$maturity_date[which.min(df$maturity_date)]\n    filter(df, maturity_date == first_mat)\n  })\n\nO dataframe op1 tem op√ß√µes call e put, em diversos strikes, para cada data de refer√™ncia. Agora precisamos selecionar as op√ß√µes mais pr√≥ximas do dinheiro, ou seja, as op√ß√µes com delta mais pr√≥ximo de 50%. Como h√° uma diferen√ßa de sinal entre op√ß√µes call e put, vamos calcular as diferen√ßas em valores absolutos do delta em rela√ß√£o ao valor 0.5 (delta = 50%).\n\nop1_atm <- split(op1, op1$refdate) |>\n  map_dfr(function(df) {\n    df_type <- filter(df, type == \"Put\")\n    df1 <- df_type[which.min(abs(abs(df_type$delta) - 0.5)), ]\n\n    df_type <- filter(df, type == \"Call\")\n    df2 <- df_type[which.min(abs(abs(df_type$delta) - 0.5)), ]\n\n    bind_rows(df1, df2)\n  })\n\nO dataframe op1_atm tem, para cada data de refer√™ncia, 1 call ATM e 1 put ATM.\nVamos visualizar a s√©rie temporal de volatilidades impl√≠citas para estas op√ß√µes.\n\nop1_atm |>\n  ggplot(aes(x = refdate, y = bsm_impvol, colour = type)) +\n  geom_line() +\n  geom_point() +\n  facet_wrap(type ~ .) +\n  labs(\n    x = \"Data\", y = \"Volatilidade Impl√≠cita\",\n    title = \"S√©rie Hist√≥rica Volatilidade Impl√≠cita (ATM) - PETR4\",\n    subtitle = \"Volatilidade impl√≠cita de op√ß√µes com delta mais pr√≥ximo de 50%\",\n    caption = \"Desenvolvido por wilsonfreitas / Fonte: B3\"\n  ) +\n  theme(legend.position = \"none\")\n\n\n\n\n√â poss√≠vel notar que a din√¢mica da volatilidade, entre as op√ß√µes call e put, √© bem comportada. H√° eventuais momentos de diverg√™ncia, contudo, o comportamento das duas s√©ries √© bastante semelhante. As s√©ries apresentam um forte comportamento de revers√£o √† m√©dia, o que √© caracter√≠stico desse tipo de vari√°vel.\nOutro ponto interessante √© verificar quais os pre√ßos de exerc√≠cio para as op√ß√µes ATM selecionadas. Pois, uma vez que o pre√ßo do ativo objeto muda, o delta da op√ß√£o muda e o pre√ßo de exerc√≠cio que representa o delta tamb√©m muda.\n\nop1_atm |>\n  ggplot(aes(x = refdate, y = strike, colour = type)) +\n  geom_line() +\n  geom_point(aes(shape = type), size = 3) +\n  labs(\n    x = \"Data\", y = \"Strike\",\n    title = \"S√©rie Hist√≥rica Strikes (ATM) - PETR4\",\n    subtitle = \"Pre√ßos de exerc√≠cio de op√ß√µes com delta mais pr√≥ximo de 50%\",\n    caption = \"Desenvolvido por wilsonfreitas / Fonte: B3\"\n  ) +\n  theme(legend.position = \"top\", legend.title = element_blank())\n\n\n\n\nAqui as s√©ries s√£o praticamente as mesmas, indicando que as op√ß√µes ATM, calls e puts, possuem os mesmos strikes. Em poucos pontos h√° uma diferen√ßa nos pre√ßos de exerc√≠cio. √â interessante que este ponto seja melhor avaliado e talvez a liquidez das op√ß√µes ajude a explicar estas diferen√ßas.\nVamos observar os deltas das op√ß√µes ATM selecionadas. Uma vez que estamos selecionando op√ß√µes ATM, √© interessante que os deltas estejam pr√≥ximos de 50%. Mas como se d√° essa sele√ß√£o? No gr√°fico abaixo vemos que os deltas de calls e puts oscilam em torno de 50% e est√£o sempre pr√≥ximos entre si, h√° poqu√≠ssimos casos em que o delta da call est√° acima de 50% e o delta da put est√° abaixo de 50%. Novamente, cabe uma melhor investiga√ß√£o para melhor compreender os fatores causadores da diverg√™ncia.\n\nop1_atm |>\n  mutate(delta = ifelse(delta < 0, 1 + delta, delta)) |>\n  ggplot(aes(x = refdate, y = delta, colour = type)) +\n  geom_line() +\n  geom_point() +\n  labs(\n    x = \"Data\", y = \"Delta\",\n    title = \"S√©rie Hist√≥rica Deltas (ATM) - PETR4\",\n    subtitle = \"Delta de op√ß√µes com delta mais pr√≥ximo de 50%\",\n    caption = \"Desenvolvido por wilsonfreitas / Fonte: B3\"\n  ) +\n  theme(legend.position = \"top\", legend.title = element_blank())\n\n\n\n\nUma vez que constru√≠mos as s√©ries temporais para a volatilidade de op√ß√µes ATM, o pr√≥ximo passo √© modelar essa s√©rie. Um problema interessante √© comparar essa din√¢mica com a volatilidade realizada, talvez separando por cada vencimento. Idealmente a volatilidade impl√≠cita deveria convergir para a volatilidade realizada. Outro ponto que ficou em aberto e a avalia√ß√£o da liquidez e sua consequ√™ncia na estrat√©gia de rolagem. Aqui estamos selecionando as op√ß√µes mais pr√≥ximas do ATM para obter as volatilidades. Uma alternativa √© fazer o ajuste de um modelo e obter a volatilidade te√≥rica par um delta de 50%. Em geral, como a liquidez se concentra pr√≥ximo √† vizinhan√ßa das op√ß√µes no dinheiro, h√° bastante informa√ß√£o nessa regi√£o para obter um bom modelo ajustado."
  },
  {
    "objectID": "posts/2023-02-19-taxas-de-juros-reais/index.html",
    "href": "posts/2023-02-19-taxas-de-juros-reais/index.html",
    "title": "C√°lculo da taxa de juro real no Brasil",
    "section": "",
    "text": "A an√°lise de investimentos no Brasil gira muito em torno de produtos indexados √†s taxas b√°sicas de juros, Taxa DI e SELIC. Estas s√£o taxas de juros nominais, ou seja, n√£o consideram a infla√ß√£o corrente. Muitas vezes a discuss√£o sobre taxas nominais √© m√≠ope, dado que a infla√ß√£o corroe a rentabilidade obtida.\nA taxa de juros importante para a economia √© a taxa de juro real, que √© a taxa de juros acima da infla√ß√£o corrente. Esta sim deveria ser a medida de refer√™ncia para avalia√ß√£o de rentabilidade de investimentos.\nVamos ver aqui como calcular a taxa de juros real e para isso utilizaremos a Taxa DI (CDI) como taxa de juros nominal e o IPCA como √≠ndice de infla√ß√£o. Os valores obtidos podem ser um pouco diferentes caso a taxa SELIC seja utilizada como taxa nominal. Uma alternativa √© utilizar outro √≠ndice de infla√ß√£o, como o IGP-M, e neste caso os resultados podem ser bem diferentes em alguns per√≠odos. A escolha do √≠ndice de infla√ß√£o deve refletir as premissas dos agentes. H√° indiv√≠duos mais sens√≠veis aos fatores refletidos pelo pelo IGP-M, como custo de aluguel, por exemplo. Para estes indiv√≠duos faz mais sentido a alternativa pelo IGP-M. Vamos seguir com o IPCA por ser o √≠ndice mais utilizado no mercado para se avaliar a infla√ß√£o.\n\nlibrary(rbcb)\nlibrary(bizdays)\nlibrary(tidyverse)\n\nA fun√ß√£o rbcb::get_series ser√° utilizada para obter as s√©ries de CDI e IPCA a partir do servi√ßo de s√©ries temporais do Banco Central (BCB). √â necess√°rio conhecer os c√≥digos das s√©ries no SGS (Sistema de Gerenciador de S√©ries Temporais) mantido pelo BCB. Isso √© meio mala, mas n√£o tem jeito, √© preciso conhecer os c√≥digos num√©ricos ou fazer uma busca no site do SGS para obter os c√≥digos. A s√©rie do IPCA √© mensal, por este motivo vou utilizar a s√©rie mensal do CDI, pra facilitar a conta mesmo, assim n√£o √© necess√°rio calcular o IPCA di√°rio.\n\nseries_ <- get_series(\n  c(CDI = 4391, IPCA = 433),\n  start_date = \"2001-01-01\", end_date = \"2022-12-31\"\n)\n\nAs s√©ries baixadas est√£o em percentual, de forma que √© necess√°rio efetuar a divis√£o por 100 para ter as s√©ries unidades decimais.\n\ncdi <- series_$CDI |>\n  mutate(CDI = CDI / 100)\n\nipca <- series_$IPCA |>\n  mutate(IPCA = IPCA / 100)\n\nrates <- left_join(cdi, ipca, by = \"date\")\n\nrates |> head()\n\n# A tibble: 6 √ó 3\n  date          CDI   IPCA\n  <date>      <dbl>  <dbl>\n1 2001-01-01 0.0126 0.0057\n2 2001-02-01 0.0101 0.0046\n3 2001-03-01 0.0125 0.0038\n4 2001-04-01 0.0118 0.0058\n5 2001-05-01 0.0133 0.0041\n6 2001-06-01 0.0127 0.0052\n\n\nDe posse da infla√ß√£o mensal \\(i\\) e da taxa de juros mensal \\(r\\) √© s√≥ descontar a taxa de juros pela infla√ß√£o de acordo com a equa√ß√£o abaixo.\n\\[\n1 + j = \\frac{1 + r}{1 + i}\n\\]\nEssa equa√ß√£o resulta na taxa de juro real mensal \\(j\\), dado que todas as taxas de juros na equa√ß√£o s√£o mensais. Entretanto eu s√≥ entendo taxas de juros anualizadas, assim eu consigo comparar com as demais taxas da economia, que s√£o todas anuais. Para converter em taxa anual faz-se a seguinte conta.\n\\[\nj_a = (1 + j)^{12} - 1\n\\]\n\\(j_a\\) √© a taxa de juro real anualizada. Bem, entendidas as equa√ß√µes, vamos aplic√°-las.\n\nrates <- rates |>\n  mutate(\n    CDI_real = ((1 + CDI) / (1 + IPCA)) - 1,\n    CDI_real_annu = (1 + CDI_real) ^ 12 - 1,\n  )\n\nCalculadas as taxas de juros reais √© interessante visualiz√°-las para conhecer a sua din√¢mica com o passar dos anos.\n\nrates |>\n  ggplot(aes(x = date, y = CDI_real_annu)) +\n  geom_line() +\n  geom_area(fill = \"red\", alpha = 0.25) +\n  scale_y_continuous(labels = scales::percent) +\n  labs(\n    x = \"Data\", y = NULL,\n    title = \"Taxa de Juro Real Mensal\",\n    subtitle = \"Per√≠odo de 2020 a 2022\",\n    caption = \"Desenvolvido por wilsonfreitas / Fonte: BCB\"\n  )\n\n\n\n\nAt√© aqui realizamos o trabalho f√°cil, aplicar f√≥rmulas para calcular a taxa de juro real a partir da taxa de juro nominal e da infla√ß√£o corrente. Como todas as taxas de juros utilizadas eram taxas mensais, n√£o foi necess√°rio realizar convers√µes nas taxas. Contudo, a vida n√£o √© t√£o simples assim, no mundo real as taxas de juros, Taxa DI e SELIC, s√£o divulgadas diariamente. Como a infla√ß√£o √© divulgada com frequ√™ncia mensal √© necess√°rio transformar a infla√ß√£o mensal em infla√ß√£o di√°ria. Vamos realizar esses c√°lculos abaixo.\n\nseries_ <- get_series(\n  c(CDI = 12, IPCA = 433),\n  start_date = \"2001-01-01\", end_date = \"2022-12-31\"\n)\n\nUtilizando o c√≥gigo 12 para a Taxa DI, que retorna a Taxa DI ao dia, n√£o √© preciso converter a taxa anual para taxa di√°ria.\n\ncdi <- series_$CDI |>\n  mutate(CDI = CDI / 100)\nipca <- series_$IPCA |>\n  mutate(\n    date = following(date, \"Brazil/ANBIMA\"),\n    IPCA = IPCA / 100\n  )\n\nRealizamos um ajuste nas datas de infla√ß√£o, como os dados s√£o mensais, a data utilizada √© o primeiro dia de cada m√™s, contudo, as taxas CDI s√£o divulgadas em dias √∫teis e em diversos meses o dia 1 do m√™s n√£o √© um dia √∫til. A fun√ß√£o bizdays::following faz exatamente o ajuste que precisamos, se a data passada for um dia √∫til, segundo o calend√°rio informado, a pr√≥pria data √© retornada, caso contr√°rio, o primeiro dia √∫til ap√≥s essa data √© retornado.\nCom as datas ajustadas podemos juntar os datasets.\n\nrates <- left_join(cdi, ipca, by = \"date\")\n\nPara calcular a infla√ß√£o di√°ria a partir da infla√ß√£o mensal, vamos criar um √≠ndice que represente o m√™s corrente e quebrar o dataset em blocos com dados mensais e nestes blocos vamos realizar os c√°lculos para encontrar: a infla√ß√£o di√°ria, a taxa de juro real e a taxa de juro real anual, pois agora estamos trabalhando com dados di√°rios e como j√° disse, s√≥ consigo avaliar taxas de juros anuais.\n\nrates <- rates |>\n  mutate(month = format(date, \"%Y-%m\"))\n\nrates <- split(rates, rates$month) |>\n  map_dfr(function(df) {\n    dt <- nrow(df)\n    df[\"IPCA_daily\"] <- (1 + df$IPCA[1]) ^ (1 / dt) - 1\n    df[\"CDI_real\"] <- (1 + df$CDI) / (1 + df$IPCA_daily) - 1\n    df[\"CDI_real_annu\"] <- (1 + df$CDI_real) ^ 252 - 1\n    df\n  })\n\nAp√≥s calcular as taxas de juros, vou colocar em um gr√°fico para observar a sua din√¢mica na s√©rie hist√≥rica.\n\nrates |>\n  ggplot(aes(x = date, y = CDI_real_annu)) +\n  geom_line() +\n  geom_area(fill = \"red\", alpha = 0.25) +\n  scale_y_continuous(labels = scales::percent) +\n  labs(\n    x = \"Data\", y = NULL,\n    title = \"Taxa de Juro Real Di√°ria\",\n    subtitle = \"Per√≠odo de 2020 a 2022\",\n    caption = \"Desenvolvido por wilsonfreitas / Fonte: BCB\"\n  )\n\n\n\n\nTendo ambas as s√©ries, de juro real e nominal, √© interessante observar o impacto da infla√ß√£o para a rentabilidade no per√≠odo.\nVamos come√ßar a an√°lise filtrando a partir de 2001.\n\nrates |>\n  filter(date >= as.Date(\"2001-01-01\")) |>\n  mutate(\n    CDI_acc = cumprod(1 + CDI) - 1,\n    CDI_real_acc = cumprod(1 + CDI_real) - 1,\n  ) |>\n  select(date, CDI_acc, CDI_real_acc) |>\n  tidyr::pivot_longer(c(CDI_acc, CDI_real_acc),\n    names_to = \"rates\"\n  ) |>\n  ggplot(aes(x = date, y = value, colour = rates)) +\n  geom_line(size = 1) +\n  scale_y_continuous(labels = scales::percent) +\n  labs(\n    x = \"Data\", y = NULL,\n    title = \"Rentabilidade - Juro Real x Juro Nominal\",\n    subtitle = \"Juros acumulados no per√≠odo de 2001-2022\",\n    caption = \"Desenvolvido por wilsonfreitas / Fonte: BCB\"\n  )\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\n‚Ñπ Please use `linewidth` instead.\n\n\n\n\n\nEm 20 anos o efeito da infla√ß√£o √© devastador na rentabilidade no per√≠odo. Vou dar um zoom a partir de 2020, o ano da pandemia de COVID-19.\n\nrates |>\n  filter(date >= as.Date(\"2020-01-01\")) |>\n  mutate(\n    CDI_acc = cumprod(1 + CDI) - 1,\n    CDI_real_acc = cumprod(1 + CDI_real) - 1,\n  ) |>\n  select(date, CDI_acc, CDI_real_acc) |>\n  tidyr::pivot_longer(c(CDI_acc, CDI_real_acc),\n    names_to = \"rates\"\n  ) |>\n  ggplot(aes(x = date, y = value, colour = rates)) +\n  geom_line(size = 1) +\n  scale_y_continuous(labels = scales::percent) +\n  labs(\n    x = \"Data\", y = NULL,\n    title = \"Rentabilidade - Juro Real x Juro Nominal\",\n    subtitle = \"Juros acumulados no per√≠odo de 2020-2022\",\n    caption = \"Desenvolvido por wilsonfreitas / Fonte: BCB\"\n  )\n\n\n\n\nNeste intervalo tivemos juros reais negativos por um longo per√≠odo, fica evidente o efeito dos juros negativos, um longo per√≠odo de rentabilidade negativa.\nOutra coisa que me chama a aten√ß√£o para din√¢mica da taxa de juro real √© o comportamento da taxa acumulada no per√≠odo de 1 ano. Uma an√°lise de janela m√≥vel, onde a taxa di√°ria √© acumulada em per√≠odos de 252 dias.\n\nrates |>\n  mutate(\n    roll_CDI_real = c(\n      rep(NA, 251),\n      zoo::rollapply(CDI_real, 252, function(x) prod(1 + x) - 1)\n    ),\n  ) |>\n  ggplot(aes(x = date, y = roll_CDI_real)) +\n  geom_line(size = 1) +\n  scale_y_continuous(labels = scales::percent) +\n  labs(\n    x = \"Data\", y = NULL,\n    title = \"Taxa de Juro Real acumulada em 252 dias √∫teis\",\n    subtitle = \"Per√≠odo de 2001 a 2022\",\n    caption = \"Desenvolvido por wilsonfreitas / Fonte: BCB\"\n  )\n\n\n\n\nInteressante observar como o efeito da janela m√≥vel suaviza a curva. No per√≠odo de 2001 a 2010 tivemos taxas bem elevadas, que come√ßaram uma trajet√≥ria de queda que durou at√© 2016, quando a coisa toda zoou de vez. Ap√≥s 2020 foi s√≥ desgra√ßa. Curioso observar que n√£o tem per√≠odo tranquilo, a taxa sobe r√°pido e tamb√©m cai r√°pido, importante ressaltar que essa √© a taxa acumulada em 12 meses, talvez fosse interessante e s perar um comportamente mais est√°vel para esse n√∫mero."
  },
  {
    "objectID": "posts/2023-07-19-quantlib/quantlib.html",
    "href": "posts/2023-07-19-quantlib/quantlib.html",
    "title": "QuantLib, dez anos depois ‚Ä¶",
    "section": "",
    "text": "QuantLib √© a ess√™ncia do que √© quant, n√£o apenas pela √≥bvia men√ß√£o no seu nome, e sim porque est√° calcada na origem do que chamamos de quantitative finance.\nA QuantLib √© impressionante pelos seus superlativos, √© uma biblioteca gigante, mantida por d√©cadas e com centenas de colaboradores. Continua evoluindo como um projeto de c√≥digo aberto e com uma comunidade engajada.\nA QuantLib √© uma grande biblioteca de pricing de ativos finaneiros, e com uma quantidade brutal de instrumentos financeiros associada uma grande quantidade de insumos para os c√°lculos dos pre√ßos, torna a implementa√ß√£o da biblioteca um esfor√ßo gigantesco. Por exemplo, para calcular o pre√ßo de uma op√ß√£o de d√≥lar (das que s√£o negociadas na B3) temos como insumos: cota√ß√£o do d√≥lar, pre√ßo de strike da op√ß√£o, prazo at√© o vencimento, taxas de juros locais, taxas de juros estrangeira, volatilidade impl√≠citas. Para obter as taxas de juros, precisamos de uma estrutura a termo de juros que √© formada por contratos futuros negociados na B3. As volatilidades impl√≠citas s√£o obtidas a partir de uma superf√≠cie de volatilidade que √© constru√≠da de um conjunto de op√ß√µes, tamb√©m negociadas na B3. Os juros estrangeiros v√£o na mesma toada, ou seja, fazer isso de forma estruturada onde os insumos s√£o vinculados a toda cadeia de depend√™ncia de instrumentos financeiros e fatores de risco, √© bastante complicado. Sem mencionar todas as peculiaridades de cada mercado e seus produtos, como regimes de taxa e regras de contagem de dias, apenas para citar alguns exemplos.\nInfelizmente h√° muito pouco conte√∫do sobre a QuantLib aplicado a instrumentos financeiros negociados no Brasil. Vamos tentar reduzir este gap come√ßando com a cria√ß√£o da curva de juros nominais do Brasil, a estrutura a termo de taxas de juros prefixados."
  },
  {
    "objectID": "posts/2023-07-19-quantlib/quantlib.html#obtendo-os-dados",
    "href": "posts/2023-07-19-quantlib/quantlib.html#obtendo-os-dados",
    "title": "QuantLib, dez anos depois ‚Ä¶",
    "section": "Obtendo os Dados",
    "text": "Obtendo os Dados\nVamos come√ßar obtendo os dados da curva de juros nominais, a curva PRE, curva de juros prefixados obtida dos contratos futuros de taxa DI negociados na B3. Para isso vou utilizar a base de dados do projeto brasa, projeto no qual venho trabalhando recentemente. O projeto brasa organiza dados de diversas fontes do mercado financeiro brasileiro e disponibiliza datasets com os dados previamente manipulados. Este projeto √© muito semelhante ao projeto rb3, com a diferen√ßa que ele gera um data lake com dados do mercado financeiro local.\n\nimport os\nos.environ[\"BRASA_DATA_PATH\"] = \"D:\\\\brasa\"\nimport brasa\nimport pyarrow.compute as pc\nfrom datetime import datetime\n\nO projeto brasa organiza os dados em um conjunto de datasets que s√£o obtidos atrav√©s da fun√ß√£o brasa.get_dataset. Esta fun√ß√£o retorna um objeto Dataset do projeto arrow, que pode ser entendido como uma refer√™ncia para os dados, uma vez que n√£o traz os dados para a mem√≥ria.\nVamos utilizar o dataset b3-curves-di1 que cont√©m as curvas de juros prefixados.\n\ncurve = (brasa\n         .get_dataset(\"b3-curves-di1\")\n         .filter(pc.field(\"refdate\") == datetime(2023, 7, 14))\n         .to_table()\n         .to_pandas())\n\nimport matplotlib.ticker as mticker\n\nax = curve.plot.scatter(x=\"business_days\", y=\"adjusted_tax\", figsize=(12, 6))\nax.set_xlabel(\"Dias √öteis\")\nax.set_ylabel(\"Taxa (%)\")\nax.yaxis.set_major_formatter(mticker.PercentFormatter(xmax=1.0, decimals=1));"
  },
  {
    "objectID": "posts/2023-07-19-quantlib/quantlib.html#usando-a-quantlib",
    "href": "posts/2023-07-19-quantlib/quantlib.html#usando-a-quantlib",
    "title": "QuantLib, dez anos depois ‚Ä¶",
    "section": "Usando a QuantLib",
    "text": "Usando a QuantLib\nObtida a curva prefixada, com os seus v√©rtices e taxas, agora vamos utilizar estes dados para criar objetos de curva da QuantLib.\nCome√ßamos carregando a QuantLib e associando-a ao prefixo ql. Tudo o que precisamos ser√° acessado diretamente deste m√≥dulo.\n\nimport QuantLib as ql\n\ntoday = ql.Date().from_date(datetime(2023, 7, 14))\nql.Settings.instance().evaluationDate = today\nprint(ql.Settings.instance().evaluationDate)\n\nJuly 14th, 2023\n\n\nA primeira coisa a fazer ao utilizar a QuantLib √© definir a evaluationDate. Esta √© a data de avalia√ß√£o, ou a data de marca√ß√£o a mercado, ou a data de refer√™ncia para a cria√ß√£o da curva, como queira. Como obtivemos a curva para o dia 14/julho/2023, vamos definir esta data como a evaluationDate.\nA QuantLib tem o seu pr√≥prio objeto de data, ql.Date, e utilizei o m√©todo ql.Date.from_date para criar uma data a partir de um objeto datetime do Python."
  },
  {
    "objectID": "posts/2023-07-19-quantlib/quantlib.html#discountcurve",
    "href": "posts/2023-07-19-quantlib/quantlib.html#discountcurve",
    "title": "QuantLib, dez anos depois ‚Ä¶",
    "section": "DiscountCurve",
    "text": "DiscountCurve\nA curva mais simples de ser criada na QuantLib √© a ql.DiscountCurve. Essa curva √© criada a partir dos fatores de desconto, discount factors, que s√£o independentes do regime de capitaliza√ß√£o das taxas. Em nosso caso, o regime de capitaliza√ß√£o das taxas √© o composto, com contagem de dias √∫teis, seguindo o calend√°rio de mercado do Brasil (calend√°rio ANBIMA) e com ano de 252 dias.\nO fator de desconto √© um invariante, de forma que o fator de desconto entre duas datas √© sempre o mesmo, independente do regime de capitaliza√ß√£o, da regra de contagem de dias e do calend√°rio adotados. Por este motivo que a ql.DiscountCurve √© a curva mais simples de ser criada na QuantLib.\nPara criar a ql.DiscountCurve √© necess√°rio obter o fator de desconto para cada uma das datas referentes aos v√©rtices da curva. Para isso vamos criar um calend√°rio de mercado do Brasil e obter as datas referentes aos v√©rtices da curva, que est√£o em dias √∫teis. Adicionalmente, vamos calcular os fatores de desconto para cada um dos v√©rtices. Ap√≥s a cria√ß√£o das datas e dos fatores de desconto, criamos o objeto com a regra de contagem de dias, que √© necess√°rio para a curva, pois al√©m das datas a curva tamb√©m trabalha com prazos para retornar dados, e por isso precisa da regra de contagem de dias para saber como converter prazos em datas e vice-versa.\n\ncalendar = ql.Brazil(ql.Brazil.Settlement)\ndata = [\n    (calendar.advance(today, d, ql.Days, ql.Following), (1 + r) ** (-d/252))\n    for d, r in zip(curve[\"business_days\"], curve[\"adjusted_tax\"])\n]\ndata.insert(0, (today, 1))\ndates, dfs = zip(*data)\ndayCounter = ql.Business252(calendar)\ncurve0 = ql.DiscountCurve(dates, dfs, dayCounter)\n\nCriamos o objeto curve0 com a curva. Note que inserimos um primeiro v√©rtice na curva, referente a data de hoje (data de avalia√ß√£o) com fator de desconto igual a 1. Isso √© necess√°rio, a ql.DiscountCurve exige isso.\nOs v√©rtices da curva podem ser obtidos com o m√©todo nodes, que retorna um conjuto de tuplas com data e fator de desconto.\n\ncurve0.nodes()[:5]\n\n((Date(14,7,2023), 1.0),\n (Date(17,7,2023), 0.9994923774382742),\n (Date(1,8,2023), 0.9939259),\n (Date(1,9,2023), 0.9826092000000001),\n (Date(2,10,2023), 0.9730136999999999))\n\n\nA curva possui diversos m√©todos de interesse para se obter taxas e fatores de desconto. O m√©todo discount retorna o fator de desconto e ele pode receber tanto a data futura, como o prazo, em anos, da data de avalia√ß√£o at√© a data futura.\nPor exemplo, vamos obter o fator para a data de 1/set/2023 utilizando a data e o prazo at√© esta data.\n\nbiz_days = calendar.businessDaysBetween(today, ql.Date(1,9,2023))\nprint(curve0.discount(biz_days/252))\nprint(curve0.discount(ql.Date(1,9,2023)))\n\n0.9826092000000001\n0.9826092000000001\n\n\nComo esta data tamb√©m comp√µe a curva, ela √© o quarto n√≥ da curva, podemos verificar que os valores retornados s√£o iguais ao n√≥ da curva. Apenas um sanity check.\nContudo, podemos obter o fator de desconto para qualquer data e prazo, inclusive extrapolando o √∫ltimo v√©rtice da curva. Quando o prazo solicitado n√£o for equivalente aos v√©rtices da curva, a curva √© interpolada, utilizando a interpola√ß√£o Log-Linear, linear nos logaritimos dos fatores de desconto. Essa interpola√ß√£o √© equivalente a interpola√ß√£o flat-forward, tamb√©m conhecida como exponencial, utilizada para curvas de juros compostos e dias √∫teis no Brasil.\nComo exemplo vamos obter o fator para a data de 12/jul/2023.\n\nfwd_date = ql.Date().from_date(datetime(2024, 7, 12))\nbiz_days = calendar.businessDaysBetween(today, fwd_date)\nprint(curve0.discount(biz_days/252))\nprint(curve0.discount(fwd_date))\n\n0.8967097482832732\n0.8967097482832732\n\n\nO fator de desconto √© muito √∫til no apre√ßamento de ativos, contudo, o que me interessa aqui √© obter as taxas de juros da curva. As curvas s√£o visualizadas em taxas e n√£o em fatores.\nPara obter as taxas de juros da curva, utilizamos o m√©todo zeroRate, que recebe o prazo em anos at√© a taxa e o regime de capitaliza√ß√£o.\n\nprint(curve0.zeroRate(biz_days/252, ql.Compounded))\n\n11.665385 % Business/252(Brazil) Annual compounding\n\n\nA taxa retornada √© um objeto que cont√©m frequ√™ncia Annual, regime de capitaliza√ß√£o compounding (juros compostos), regra de contage de dias Business/252 e calend√°rio Brazil. O valor da taxa √© obtido com o m√©todo rate do objeto de taxa de juro retornado.\nVamos iterar em diversos prazos, come√ßando em 1 dia at√© o √∫ltimo v√©rtice da curva e obter as taxas de juros para cada prazo e construir uma curva com estes dados, essa √© a curva interpolada. Depois, colocamos essa curva em um gr√°fico junto com a curva original.\n\nimport pandas as pd\n\ni_curve = pd.DataFrame({\n    \"days\": list(range(1, curve[\"business_days\"].max())),\n    \"rates\": [curve0.zeroRate(i/252, ql.Compounded).rate()\n              for i in range(1, curve[\"business_days\"].max())],\n})\n\nax = curve.plot.scatter(x=\"business_days\", y=\"adjusted_tax\", figsize=(12, 6),\n                        label=\"Curva de Prefixada\")\ni_curve.plot(x=\"days\", y=\"rates\", c=\"red\", alpha=0.5, ax=ax, label=\"Interpola√ß√£o\")\nax.set_xlabel(\"Dias √öteis\")\nax.set_ylabel(\"Taxa (%)\")\nax.yaxis.set_major_formatter(mticker.PercentFormatter(xmax=1.0, decimals=1));\n\n\n\n\nUma outra an√°lise que gosto de fazer √© observar a curva de juros a termo de 1 dia. √â a expectativa das taxas DI futuras impl√≠citas na curva.\nO objeto de curva tem o m√©todo forwardRate que recebe um prazo inicial e um prazo final para o c√°lculo da taxa a termo entre estes 2 prazos. Dessa forma, vamos iterar em todos os prazos da curva obtendo a taxa a termo de 1 dia. Na sequ√™ncia vamos adicionar a estrutura a termo com estas taxas no gr√°fico com as curvas de juros.\n\nf_curve = pd.DataFrame({\n    \"days\": list(range(1, curve[\"business_days\"].max())),\n    \"rates\": [curve0.forwardRate(i/252, (i+1)/252, ql.Compounded).rate()\n              for i in list(range(1, curve[\"business_days\"].max()))],\n})\n\nax = curve.plot.scatter(x=\"business_days\", y=\"adjusted_tax\", figsize=(12, 6),\n                        label=\"Curva de Prefixada\")\ni_curve.plot(x=\"days\", y=\"rates\", c=\"red\", alpha=0.5, ax=ax, label=\"Interpola√ß√£o\")\nf_curve.plot(x=\"days\", y=\"rates\", c=\"green\", alpha=0.75, ax=ax, label=\"Forward 1D\")\nax.set_xlabel(\"Dias √öteis\")\nax.set_ylabel(\"Taxa (%)\")\nax.yaxis.set_major_formatter(mticker.PercentFormatter(xmax=1.0, decimals=1));\n\n\n\n\nDado o cen√°rio atual, nota-se que a expectativa impl√≠cita na curva √© de que a taxa DI reduza at√© a faixa de 9% em 1 ano e retorne ao patamar de 10% ap√≥s 2 anos.\nVamos ficando por aqui. Vimos a cria√ß√£o de uma estrutura a termo com a QuantLib, como interpolar taxas de juros a vista e taxas de juros a termo."
  },
  {
    "objectID": "posts/2023-07-26-quantlib-zerocurve/main.html",
    "href": "posts/2023-07-26-quantlib-zerocurve/main.html",
    "title": "QuantLib, zero curves",
    "section": "",
    "text": "No post vimos a cria√ß√£o de uma curva de juros utilizando a classe ql.DiscountCurve da QuantLib, que utiliza uma estrutura a termo dos fatores de desconto. Aqui vamos ver como criar uma curva zero a partir das taxas de juros. Nesta abordagem √© poss√≠vel criar curvas com outros tipos de interpola√ß√£o, pois, na DiscountCurve a interpola√ß√£o utilizada √© a linear nos logs dos fatores de desconto, que √© equivalente a interpola√ß√£o exponencial. A interpola√ß√£o exponencial √© muito utilizada no mercado brasileiro, em particular para a curva de juros prefixados. Neste post veremos a classe ql.ZeroCurve para constru√ß√£o de uma curva zero, que √© uma curva de taxas de juros que v√£o da data de refer√™ncia at√© o v√©rtice da curva. Veremos tamb√©m como utilizar diferentes m√©todos de interpola√ß√£o para a curva criada.\nVamos come√ßar carragendo os pacotes utilizados e fazendo o setup do brasa.\n\nimport os\nos.environ[\"BRASA_DATA_PATH\"] = \"D:\\\\brasa\"\nimport brasa\nimport pyarrow.compute as pc\nfrom datetime import datetime\nimport QuantLib as ql\nimport numpy as np\nimport pandas as pd\nimport matplotlib.ticker as mticker\n\nAgora faremos o setup da QuantLib definindo a data de refer√™ncia, que ser√° 2023-07-14.\n\ntoday = ql.Date().from_date(datetime(2023, 7, 14))\nql.Settings.instance().evaluationDate = today\n\nA curva prefixada para a data de refer√™ncia √© carregada do dataset b3-curves-di1 do datalake do projeto brasa.\n\ncurve = (brasa\n         .get_dataset(\"b3-curves-di1\")\n         .filter(pc.field(\"refdate\") == today.to_date())\n         .to_table()\n         .to_pandas())\n\nPara criar uma curva zero √© necess√°rio passar um vetor com as datas dos v√©rtices da curva e as taxas de juros da curva. Adicionalmente, √© preciso incluir um v√©rtice referente √† data de refer√™ncia. Isso √© importante, caso contr√°rio a QuantLib assume que a data de refer√™ncia da curva √© a data do primeiro ponto da curva e na interpola√ß√£o a contagem de dias ser√° realizada com rela√ß√£o √† este ponto. A taxa definida para este v√©rtice inicial √© 0 (zero), mantendo a coer√™ncia, pois para prazo de zero dias temos zero juros, apesar dessa defini√ß√£o ser redundante.\nUtilizando os dias √∫teis e a taxa de juros da curva carregada previamente, construo os vetores de datas e taxas.\n\ncalendar = ql.Brazil(ql.Brazil.Settlement)\ndata = [(calendar.advance(today, d, ql.Days, ql.Following), r)\n        for d, r in zip(curve[\"business_days\"], curve[\"adjusted_tax\"])]\ndata.insert(0, (today, 0))\ndates, rates = zip(*data)\n\nPara a cria√ß√£o da curva precisamos passar alguns argumentos para o construtor ql.ZeroCurve, que s√£o importantes e impactam na interpreta√ß√£o das taxas e interpola√ß√£o da curva. Seguem os argumentos utilizados:\n\nregra de contagem de dias: ql.Business252(calendar)\ncalend√°rio: ql.Brazil(ql.Brazil.Settlement)\ninterpolador: ql.Linear\nregime de capitaliza√ß√£o das taxas: ql.Compounded\nfrequ√™ncia das taxas: ql.Annual\n\n\nzc = ql.ZeroCurve(dates, rates,\n                  ql.Business252(calendar),\n                  calendar,\n                  ql.Linear(),\n                  ql.Compounded,\n                  ql.Annual)\n\nVamos ver algumas caracter√≠sticas interessantes da curva criada.\nA curva tem um m√©todo nodes que retorna as datas e taxas da curva, mas aten√ß√£o, as taxas retornadas s√£o taxas cont√≠nuas. Internamente a QuantLib armazena taxas cont√≠nuas, mesmo que tenham sido utilizadas taxas discretas ou simples, para armazenamento na classe as taxas s√£o convertidas.\n\nzc.nodes()[:5]\n\n((Date(14,7,2023), 0.12795336431048324),\n (Date(17,7,2023), 0.12795336431046694),\n (Date(1,8,2023), 0.12794507014909243),\n (Date(1,9,2023), 0.1263153339122755),\n (Date(2,10,2023), 0.12534533483937893))\n\n\n\ncurve.head()\n\n\n\n\n\n  \n    \n      \n      refdate\n      symbol\n      maturity_date\n      business_days\n      adjusted_tax\n    \n  \n  \n    \n      0\n      2023-07-14\n      CDI\n      2023-07-17\n      1\n      0.136500\n    \n    \n      1\n      2023-07-14\n      DI1Q23\n      2023-08-01\n      12\n      0.136491\n    \n    \n      2\n      2023-07-14\n      DI1U23\n      2023-09-01\n      35\n      0.134640\n    \n    \n      3\n      2023-07-14\n      DI1V23\n      2023-10-01\n      55\n      0.133540\n    \n    \n      4\n      2023-07-14\n      DI1X23\n      2023-11-01\n      76\n      0.132250\n    \n  \n\n\n\n\nComo podemos observar, as taxas apresentadas em nodes s√£o diferentes das taxas da tabela acima.\nAgora que temos a curva criada, podemos interpolar utilizando o m√©todo zeroRate.\n\nbiz_days = calendar.businessDaysBetween(today, ql.Date(1,9,2023))\nprint(zc.zeroRate(biz_days/252, ql.Compounded))\nprint(zc.zeroRate(ql.Date(1,9,2023), ql.Business252(calendar), ql.Compounded))\n\n13.463990 % Business/252(Brazil) Annual compounding\n13.463990 % Business/252(Brazil) Annual compounding\n\n\nNote que passamos o regime de capitaliza√ß√£o, ql.Compounded, isso √© necess√°rio porque, a QuantLib retorna taxas cont√≠nuas por padr√£o.\nAbaixo segue uma fun√ß√£o para fazer gr√°ficos da curva que utiliza a curva criada e os pontos originais. Isso ajuda na valida√ß√£o da curva.\n\ndef plot_curve(crv, curve):\n    i_curve = pd.DataFrame({\n        \"days\": list(range(1, curve[\"business_days\"].max())),\n        \"rates\": [crv.zeroRate(i/252, ql.Compounded).rate()\n                for i in range(1, curve[\"business_days\"].max())],\n    })\n\n    f_curve = pd.DataFrame({\n        \"days\": list(range(1, curve[\"business_days\"].max())),\n        \"rates\": [crv.forwardRate(i/252, (i+1)/252, ql.Compounded).rate()\n                for i in list(range(1, curve[\"business_days\"].max()))],\n    })\n\n    ax = curve.plot.scatter(x=\"business_days\", y=\"adjusted_tax\", figsize=(12, 6),\n                            label=\"Pontos da Curva\")\n    i_curve.plot(x=\"days\", y=\"rates\", c=\"red\", alpha=0.5, ax=ax, label=\"Interpola√ß√£o\")\n    f_curve.plot(x=\"days\", y=\"rates\", c=\"green\", alpha=0.75, ax=ax, label=\"Forward 1D\")\n    ax.set_xlabel(\"Dias √öteis\")\n    ax.set_ylabel(\"Taxa (%)\")\n    ax.yaxis.set_major_formatter(mticker.PercentFormatter(xmax=1.0, decimals=1));\n\nAbaixo temos o gr√°fico com os pontos da curva prefixada, a interpola√ß√£o e a curva de juros a termo de 1 dia. Como a curva foi criada com o m√©todo de interpola√ß√£o linear, na curva de juros a termo isso fica evidente no formato err√°tico, com zigue-zagues da curva. Para a curva prefixada, em particular, essa abordagem n√£o faz sentido, pois sabemos que as decis√µes de mudan√ßa de juros acontece em datas espec√≠ficas e as taxas a termos devem refletir isso.\n\nplot_curve(zc, curve)\n\n\n\n\nA t√≠tulo de curiosidade, e tamb√©m para explorar a QuantLib, uma nova curva zero √© criada com outro m√©todo de interpola√ß√£o, o cubic spline monot√¥nico. Abaixo temos a cria√ß√£o da curva e o gr√°fico com os pontos da curva prefixada, a interpola√ß√£o e a curva de juros a termo de 1 dia.\n\nczc = ql.MonotonicCubicZeroCurve(dates, rates, ql.Business252(calendar), calendar,\n                        ql.MonotonicCubic(), ql.Compounded, ql.Annual)\nplot_curve(czc, curve)"
  },
  {
    "objectID": "posts/2023-08-01-quantlib-usd-curve/main.html",
    "href": "posts/2023-08-01-quantlib-usd-curve/main.html",
    "title": "QuantLib: Curva de Cupom Cambial",
    "section": "",
    "text": "Vamos construir as curvas de cupom cambial, limpo e sujo, da B3 utilizando a biblioteca QuantLib.\nPrimeiramente vou fazer o setup do projeto brasa definindo o reposit√≥rio que cont√©m os dados. Lembrando que o projeto brasa √© um projeto em release alpha que venho trabalhando para organizar dados de fontes p√∫blicas.\n\nimport os\nos.environ[\"BRASA_DATA_PATH\"] = \"D:\\\\brasa\"\nimport brasa\n\nOs demais pacotes importados s√£o o setup b√°sico que inclui: pandas, numpy, datetime, matplotlib e pyarrow.\n\nfrom datetime import datetime\n\nimport QuantLib as ql\nimport pandas as pd\nimport numpy as np\nimport pyarrow.compute as pc\nimport matplotlib.ticker as mticker\n\nVou trabalhar com a data de refer√™ncia 2023-07-14. Para esta data vamos come√ßar carregando os contratos futuros de d√≥lar (DOL) e taxa DI (DI1) negociados na B3. Utilizo o pacote brasa para obter os dados de pre√ßos de ajuste dos contratos futuros da B3.\n\nrefdate = datetime(2023, 7, 14)\n\nfut_dol = (brasa\n         .get_dataset(\"b3-futures-dol\")\n         .filter(pc.field(\"refdate\") == refdate)\n         .to_table()\n         .to_pandas())\n\nfut_di1 = (brasa\n         .get_dataset(\"b3-futures-di1\")\n         .filter(pc.field(\"refdate\") == refdate)\n         .to_table()\n         .to_pandas())\n\nAgora vamos pegar a taxa DI para a data de refer√™ncia utilizando o dataset de indicadores econ√¥micos divulgado pela B3. Isso √© importante porque estes dados s√£o utilizados pela B3 na constru√ß√£o das curvas.\n\ncdi = (brasa\n    .get_dataset(\"b3-economic-indicators-price\")\n    .filter(pc.field(\"refdate\") == refdate)\n    .filter(pc.field(\"commodity\") == \"DI1\")\n    .filter(pc.field(\"symbol\") == \"RTDI1\")\n    .to_table(columns=[\"price\"])\n    .to_pandas().iloc[0,0]) / 100\n\nPreciso ainda obter as cota√ß√µes de d√≥lar, e acredite, temos diversas cota√ß√µes de d√≥lar. As cota√ß√µes de d√≥lar s√£o referentes √† data de refer√™ncia e ao dia anterior. Para obter estes pontos de forma higi√™nica, vou fazer o setup da QuantLib e utilizar o calend√°rio brasileiro para filtrar os dados nas datas de interesse, a data de refer√™ncia e o dia anterior.\n\ntoday = ql.Date().from_date(refdate)\nql.Settings.instance().evaluationDate = today\ncalendar = ql.Brazil(ql.Brazil.Settlement)\ncalendar_act = ql.NullCalendar()\n\n\ndf_econ_ind = (brasa\n    .get_dataset(\"b3-economic-indicators-price\")\n    .filter(pc.field(\"refdate\") >= calendar.advance(today, ql.Period(-1, ql.Days)).to_date())\n    .filter(pc.field(\"refdate\") <= refdate)\n    .filter(pc.field(\"commodity\") == \"DOL\")\n    .to_table()\n    .to_pandas())\ndf_econ_ind\n\n\n\n\n\n  \n    \n      \n      refdate\n      commodity\n      symbol\n      description\n      price\n    \n  \n  \n    \n      0\n      2023-07-13\n      DOL\n      RTDOLCL\n      D√ìLAR CUPOM LIMPO - C√ÅLCULADO PELA B3\n      4.7922\n    \n    \n      1\n      2023-07-13\n      DOL\n      RTDOLD1\n      D√ìLAR B3 SPOT - 1 DIA\n      4.7949\n    \n    \n      2\n      2023-07-13\n      DOL\n      RTDOLD2\n      D√ìLAR B3 SPOT - 2 DIAS\n      4.7967\n    \n    \n      3\n      2023-07-13\n      DOL\n      RTDOLT1\n      PTAX800 VENDA\n      4.8038\n    \n    \n      4\n      2023-07-14\n      DOL\n      RTDOLCL\n      D√ìLAR CUPOM LIMPO - C√ÅLCULADO PELA B3\n      4.7896\n    \n    \n      5\n      2023-07-14\n      DOL\n      RTDOLD1\n      D√ìLAR B3 SPOT - 1 DIA\n      4.7901\n    \n    \n      6\n      2023-07-14\n      DOL\n      RTDOLD2\n      D√ìLAR B3 SPOT - 2 DIAS\n      4.7905\n    \n    \n      7\n      2023-07-14\n      DOL\n      RTDOLT1\n      PTAX800 VENDA\n      4.7957\n    \n  \n\n\n\n\nComo podemos observar, para cada data de refer√™ncia temos 4 cota√ß√µes de d√≥lar:\n\nD√≥lar cupom limpo c√°lculado pela B3 a partir do casado\nD√≥lar spot para liquida√ß√£o em D+1\nD√≥lar spot para liquida√ß√£o em D+2\nPTAX800 cota√ß√£o de venda\n\nPrecisamos pegar a cota√ß√£o da PTAX800 (apenas PTAX) do dia anterior para calcular o cupom sujo. O symbol da PTAX, de acordo com a tabela anterior, √© RTDOLT1. Assim vamos filtrar por este s√≠mbolo na data do dia anterior. Para calcular o cupom limpo utilizamos o d√≥lar cupom limpo, filtrando pelo s√≠mbolo RTDOLCL.\nAntes de filtrar vou criar uma fun√ß√£o para converter ql.Date para datetime.datetime. Com o pandas √© mais f√°cil trabalhar com datetime.\n\ndef ql_to_datetime(d):\n    # reference: https://stackoverflow.com/questions/45087828/python-quantlib-convert-quantlib-date-to-datetime\n    # datetime.datetime has methods fromordinal() and toordinal() to convert between datetime.datetime and an integer\n    # that represents the date.\n    # ql.Date also has the method serialNumber() to convert ql.Date to integer and its constructor accepts the integer\n    # as well.\n    # datetime.datetime uses 0001-01-01 as 1 with increments in days \n    # ql.Date uses 1899-12-31 as 0\n    return datetime.fromordinal(d.serialNumber() + datetime(1899, 12, 31).toordinal() - 1)\n\nPara seguir com o c√°lculo do cupom cambial vamos juntar os dados de futuros de taxa DI com os futuros de d√≥lar.\n\nfut = fut_dol.merge(fut_di1, on=[\"refdate\", \"maturity_date\", \"business_days\"], suffixes=(\"_dol\", \"_di1\"))\n\nAgora sim, procedemos com o c√°lculo do cupom sujo. A curva de cupom cambial tem os v√©rtices nas datas da coluna fixing, que s√£o as data onde o fluxo de caixa, transfer√™ncia de recursos aconte. Aqui o fixing √© no dia √∫til ap√≥s o vencimento. Essa abordagem √© diferente do que √© implementado pela B3, que utiliza as data de vencimento como v√©rtices da curva. O c√°lculo do cupom cambial sujo √© dado pela f√≥rmula.\n\\[\n\\left( 1 + c_{v}(t) \\cdot \\frac{DC_{v}(t)}{360} \\right) = \\frac{ \\frac{100000}{PUDI1_{v}(t)} }{ \\frac{PUDOL_{v}(t)}{PTAX_{t-1} \\cdot 1000} }\n\\]\n\\(DC_{v}(t)\\) s√£o os dias corridos da data de refer√™ncia at√© a data de fixing.\n\nyesterday = calendar.advance(today, -1, ql.Days)\nptax_1 = df_econ_ind.loc[(df_econ_ind[\"refdate\"] == ql_to_datetime(yesterday)) & (df_econ_ind[\"symbol\"] == \"RTDOLT1\"), \"price\"].item()\ndi1_factor = 100000 / fut[\"settlement_price_di1\"]\ndol_factor = fut[\"settlement_price_dol\"] / (ptax_1 * 1000)\nfixing = [calendar.advance(d, 1, ql.Days)\n          for d in [calendar.adjust(ql.Date.from_date(d), ql.Following)\n                    for d in fut[\"maturity_date\"]]]\ndc = [calendar_act.businessDaysBetween(today, d) for d in fixing]\nfut[\"fixing\"] = [ql_to_datetime(d) for d in fixing]\nfut[\"cupom_sujo\"] = (di1_factor / dol_factor - 1) * 360 / dc\n\nO c√°lculo do cupom cambial limpo √© dado pela f√≥rmula.\n\\[\n\\left( 1 + c_{v}(t) \\cdot \\frac{DC_{v}^{CL}(t)}{360} \\right) = \\frac{ \\frac{100000}{PUDI1_{v}(t)}\\frac{1}{(1 + CDI_t)^{1/252}} }{ \\frac{PUDOL_{v}(t)}{DOLCL_{t-1} \\cdot 1000} }\n\\]\n\\(DC_{v}^{CL}(t)\\) s√£o os dias corridos da data de refer√™ncia, mais 2 dias √∫teis, at√© a data de fixing. A motiva√ß√£o para essa mudan√ßa √© que o d√≥lar cupom limpo √© liquidado em 2 dias √∫teis, portanto, a curva deve come√ßar nesta data. Por este motivo, tamb√©m √© necess√°rio retirar 1 dia de CDI do fator da taxa DI.\n\nspot = df_econ_ind.loc[(df_econ_ind[\"refdate\"] == refdate) & (df_econ_ind[\"symbol\"] == \"RTDOLCL\"), \"price\"].item()\ndi1_factor = (100000 / fut[\"settlement_price_di1\"]) / ((1 + cdi) ** (1/252))\ndol_factor = fut[\"settlement_price_dol\"] / (spot * 1000)\ndc = [calendar_act.businessDaysBetween(calendar.advance(today, 2, ql.Days), ql.Date.from_date(d)) for d in fut[\"fixing\"]]\nfut[\"cupom_limpo\"] = (di1_factor / dol_factor - 1) * 360 / dc\nfut[\"dc_limpo\"] = dc\n\nPara termos de compara√ß√£o do shape da estrutura a termos vamos fazer um gr√°fico com a curva americana de Treasuries.\n\nus_curve = pd.DataFrame({\n    \"dc\": pd.Series([1, 2, 3, 4, 6, 12, 24, 36, 60, 72, 120, 240, 360]) * 30,\n    \"rate\": pd.Series([5.37, 5.49, 5.49, 5.53, 5.52, 5.34, 4.74, 4.35, 4.04, 3.94, 3.83, 4.11, 3.93]) / 100,\n})\nus_curve[\"date\"] = [ql_to_datetime(calendar_act.advance(today, d, ql.Days)) for d in us_curve[\"dc\"]]\n\n\nax = fut[[\"fixing\", \"cupom_limpo\", \"cupom_sujo\"]].set_index(\"fixing\").plot()\nus_curve[[\"date\", \"rate\"]].query(\"date <= '2027-01-01'\").set_index(\"date\").plot(ax=ax)\n\n<Axes: xlabel='date'>"
  },
  {
    "objectID": "posts/2023-11-25-graficos-legais/index.html",
    "href": "posts/2023-11-25-graficos-legais/index.html",
    "title": "20 anos de retornos de a√ß√µes no Brasil",
    "section": "",
    "text": "Gosto de olhar com frequ√™ncia o retorno real, retorno acima da infla√ß√£o, para alguns tipos de investimento, e tamb√©m o excesso de retorno, retorno acima da taxa de juros livre de risco. Gosto de fazer estas vari√°veis pois s√£o m√©tricas simples onde todo bom investimento deveria apresentar resultados positivos no longo prazo. Adicionalmente tamb√©m gosto de olhar retornos em d√≥lar pois acho uma boa proxy para avalia√ß√£o de preserva√ß√£o de valor ou poder de compra.\nPrimeiramente importando os pacotes utilizados.\n\nlibrary(tidyverse)\nlibrary(rbcb)\nlibrary(rb3)\n\nVamos come√ßar obtendo os dados da taxa livre de risco, a taxa DI, da taxa de varia√ß√£o da infla√ß√£o (IPCA) e do d√≥lar.\n\ncdi <- get_series(c(CDI = 4389), start_date = as.Date(\"2000-01-01\"))\nipca <- get_series(c(IPCA = 433), start_date = as.Date(\"2000-01-01\"))\nbrlusd <- get_series(c(BRLUSD = 1), start_date = as.Date(\"2000-01-01\"))\n\nAgora vou transformar a s√©rie de varia√ß√£o da infla√ß√£o, que √© uma s√©rie mensal, em uma s√©rie di√°ria. Quero fazer a an√°lise com dados di√°rios, todas as vari√°veis da an√°lise s√£o divulgadas em dados di√°rios. Para fazer este ajuste, vou calcular a taxa de infla√ß√£o di√°ria convertendo a taxa mensal em uma taxa di√°ria, considerando um regime taxas de juros compostos.\n\nrates <- left_join(\n  cdi |> mutate(month = format(date, \"%Y-%m\")),\n  ipca |> mutate(month = format(date, \"%Y-%m\")) |> select(month, IPCA),\n  by = \"month\"\n)\n\nipca <- split(rates, rates$month) |>\n  map_dfr(function(df) {\n    dt <- nrow(df)\n    df[\"IPCA\"] <- ((1 + df$IPCA[1] / 100) ^ (1 / dt) - 1) * 100\n    df\n  }) |>\n  select(-month, -CDI) |>\n  filter(!is.na(IPCA))\n\nUma vez que temos:\n\ntaxa de infla√ß√£o di√°ria;\ntaxa DI di√°ria (juros nominal);\nd√≥lar di√°rio (taxa de c√¢mbio).\n\nVou calcular os retornos, real e em d√≥lar. Antes fa√ßo a convers√£o das taxas de juros para taxas cont√≠nuas. Isso simplifica a manipula√ß√£o das taxas de juros evitando o malabarismo nas contas.\n\nrates <- cdi |>\n  left_join(ipca, join_by(date)) |>\n  left_join(brlusd, join_by(date)) |>\n  mutate(\n    log_cdi = log((1 + CDI / 100)^(1 / 252)),\n    log_ipca = log(1 + IPCA / 100),\n    log_price_brlusd = log(BRLUSD),\n    log_ret_brlusd = c(0, diff(log_price_brlusd)),\n    real_cdi = log_cdi - log_ipca,\n    usd_cdi = log_cdi - log_ret_brlusd,\n  ) |>\n  filter(date >= as.Date(\"2000-01-01\"), date < as.Date(\"2020-01-01\"))\n\nA dolariza√ß√£o dos retornos di√°rios em taxa DI s√£o calculados da mesma forma que o retorno real, subtraindo o retorno do √≠ndice da taxa DI di√°ria. Considerando que \\(U_t\\) √© um montante em USD e \\(N_t\\) um montante equivalente em BRL convertido a uma taxa de c√¢mbio \\(c_t\\) de reais por d√≥lar (BRL/USD), tudo isso no instante \\(t\\). Assim, temos em \\(t\\)\n\\[\nN_t^{\\langle BRL \\rangle} = U_t^{\\langle USD \\rangle} \\cdot c_t^{\\langle BRL/USD \\rangle}\n\\]\nNo instante \\(T\\) temos o montante \\(N_{T}\\) em BRL capitalizado pela taxa DI. Faz-se a convers√£o a taxa de c√¢mbio \\(c_T\\) para se obter o montante em d√≥lar \\(U_T\\). O retorno de \\(U\\) √© dado por\n\\[\n\\log \\frac{U_T}{U_t} = \\log \\frac{N_T}{N_t} - \\log \\frac{c_T}{c_t}\n\\]\nonde \\(\\log \\frac{N_T}{N_t}\\) √© o retorno da taxa DI no per√≠odo e \\(\\log \\frac{c_T}{c_t}\\) o retorno da taxa de c√¢mbio no per√≠odo, logo, o retorno em USD de um investimento em taxa DI. Isso √© calculado aqui em base di√°ria apenas para fins de compara√ß√£o e como um exerc√≠cio anal√≠tico, na pr√°tica, a convers√£o di√°ria de um investimento em d√≥lar n√£o se aplica. Talvez para fins de acompanhamento fa√ßa algum sentido.\nAbaixo temos o c√≥digo que gera o gr√°fico de taxas de retorno acumulados.\n\nrates |>\n  select(date, real_cdi, log_cdi, usd_cdi) |>\n  mutate(\n    Nominal = exp(cumsum(log_cdi)) - 1,\n    Real = exp(cumsum(real_cdi)) - 1,\n    USD = exp(cumsum(usd_cdi)) - 1,\n  ) |>\n  tidyr::pivot_longer(c(Real, Nominal, USD), names_to = \"Taxas\") |>\n  ggplot(aes(x = date, y = value, colour = Taxas)) +\n  geom_line(linewidth = 1) +\n  scale_y_continuous(labels = scales::percent) +\n  labs(\n    x = \"Data\", y = NULL,\n    title = \"Rentabilidade de investimento em CDI no per√≠odo de 2000-2019\",\n    subtitle = \"Retorno total, real e em d√≥lar\",\n    caption = \"Desenvolvido por wilsonfreitas / Fonte: BCB\"\n  )\n\n\n\n\nNo gr√°fico vemos a insensatez que √© falar em retorno total para longo prazo sem considerar a infla√ß√£o. Pensando em poder de compra, temos que no per√≠odo de 20 anos o investimento em taxa DI foi de 250%, preservando o poder de compra e sobrando um pouquinho pra aumento de gastos. De acordo com estes resultados, se a dua despesa aumentou em mais de 250% nestes 20 anos, voc√™ ter√° um problema de liquidez. A dolariza√ß√£o apresenta um resultado um pouco melhor, mostrando que tirar o dinheiro do Brasil √© uma boa ideia para a preserva√ß√£o de poder de compra.\nSeguindo com a an√°lise, vamos um exerc√≠cio equivalente para os √≠ndices de mercado: IBOVESPA e IBrX-100. Vamos obter os dados dos √≠ndices.\n\nibov <- index_get(\"IBOV\", as.Date(\"2000-01-01\"), do_cache = FALSE) |>\n  arrange(refdate)\nibxx <- index_get(\"IBXX\", as.Date(\"2000-01-01\"), do_cache = FALSE) |>\n  arrange(refdate)\n\nOs √≠ndices IBOVESPA e IBrX-100 possuem hist√≥rico anterior √† 2000, contudo, como quero analisar o per√≠odo de 20 anos entre 2000 e 2019, vou limitar o tamanho do hist√≥rico. Para os √≠ndices vamos calcular:\n\npr√™mio de risco (excesso de retorno)\nretorno real\nretorno em d√≥lar\nretorno total\n\nA fun√ß√£o abaixo, calc_rates, realiza todos estes c√°lculos e retorna um dataframe com os dados prontos para o gr√°fico.\n\ncalc_rets <- function(df) {\n  df |>\n    left_join(cdi, join_by(refdate == date)) |>\n    left_join(ipca, join_by(refdate == date)) |>\n    left_join(brlusd, join_by(refdate == date)) |>\n    mutate(\n      log_cdi = log((1 + CDI / 100)^(1 / 252)),\n      log_ipca = log(1 + IPCA / 100),\n      log_price = log(value),\n      total_return = c(0, diff(log_price)),\n      log_price_brlusd = log(BRLUSD),\n      log_ret_brlusd = c(0, diff(log_price_brlusd)),\n      excess_return = total_return - log_cdi,\n      usd_return = total_return - log_ret_brlusd,\n      real_return = total_return - log_ipca,\n    ) |>\n    filter(refdate >= as.Date(\"2000-01-01\"), refdate < as.Date(\"2020-01-01\"))\n}\n\nSegue tamb√©m algumas fun√ß√µes que uso para a constru√ß√£o de gr√°ficos\n\nplot_returns <- function(df, index_name) {\n  period <- year(df$refdate) |>\n    range() |>\n    paste(collapse = \"-\")\n  df |>\n    mutate(\n      Real = exp(cumsum(real_return)) - 1,\n      USD = exp(cumsum(usd_return)) - 1,\n    ) |>\n    select(refdate, Real, USD) |>\n    tidyr::pivot_longer(c(Real, USD), names_to = \"Retornos\") |>\n    ggplot(aes(x = refdate, y = value, colour = Retornos)) +\n    geom_line(linewidth = 0.5) +\n    scale_y_continuous(labels = scales::percent) +\n    labs(\n      x = \"Data\", y = NULL,\n      title = glue::glue(\n        \"Retornos do {index_name}: em d√≥lar e real, no per√≠odo de {period}\"\n      ),\n      caption = \"Desenvolvido por wilsonfreitas / Fonte: B3\"\n    )\n}\n\nplot_excess_return <- function(df, index_name) {\n  period <- year(df$refdate) |>\n    range() |>\n    paste(collapse = \"-\")\n  df |>\n    ggplot(aes(x = refdate, y = exp(cumsum(excess_return)) - 1)) +\n    geom_line(linewidth = 0.5) +\n    scale_y_continuous(labels = scales::percent) +\n    labs(\n      x = \"Data\", y = NULL,\n      title = glue::glue(\n        \"Pr√™mio de risco acumulado do {index_name} no per√≠odo de {period}\"\n      ),\n      caption = \"Desenvolvido por wilsonfreitas / Fonte: B3\"\n    )\n}\n\nVamos come√ßar com a an√°lise de retornos: em d√≥lar e real. Para isso vou apresentar um gr√°fico, para cada √≠ndice, onde temos o retorno real e o retorno em d√≥lar. O objetivo dessa an√°lise √© verificar se os retornos acumulados no per√≠odo s√£o positivos. O que deve interessar a todo o investidor no longo prazo √© retorno real significativo.\n\nibov_calc <- calc_rets(ibov)\nplot_returns(ibov_calc, \"IBOVESPA\")\n\n\n\n\nVemos que o IBOVESPA apresenta um retorno real positivo de aproximadamente 100% no per√≠odo de 20 anos. Em taxa anualizada isso √© equivalente a 3.5% ao ano, algo equivalente a um t√≠tulo IPCA + 3.5%. N√£o √© ruim, mas tamb√©m n√£o √© uma maravilha.\nVamos para o IBrX-100.\n\nibxx_calc <- calc_rets(ibxx)\nplot_returns(ibxx_calc, \"IBrX-100\")\n\n\n\n\nO IBrX-100 apresenta um retorno real superior ao IBOVESPA no per√≠odo de 20 anos. Com um retorno real de puco mais de 300% em 20 anos, o IBrX-100 entrega uma taxa anual de 7.2%. Bem melhor que o IBOVESPA, o que reflete as defici√™ncias do IBOVESPA.\nAgora vamos √† an√°lise de pr√™mio de risco (equity risk premium). Os gr√°ficos a seguir mostram que o IBOVESPA n√£o tem pr√™mio de risco positivo e que o IBrX-100 tem.\n\n\n\n\n\n\n\n\nUma an√°lise complementar √© valiar, para o per√≠odo de an√°lise, qual o percentual do per√≠odo que os √≠ndices apresentam um pr√™mio de risco positivo. Isso ajuda a identificar se esse pr√™mio de risco positivo √© um comportamento do √≠ndice ou se √© apenas um efeito da janela analisada. Para realizar isso pego o retorno acumulado e conto a quantidade de dias positivos e divido pelo total de dias.\n\nc(\n  IBOVESPA = sum((exp(cumsum(ibov_calc$excess_return)) - 1) > 0) / nrow(ibov_calc),\n  `IBrX-100` = sum((exp(cumsum(ibxx_calc$excess_return)) - 1) > 0) / nrow(ibxx_calc)\n)\n\n  IBOVESPA   IBrX-100 \n0.04283694 0.55910285 \n\n\nComo podemos observar a diferen√ßa √© brutal. Parece que o IBOVESPA foi criado para ficar abaixo do CDI. No per√≠odo de 20 anos, em apenas 4% dos dias, o IBOVESPA apresentou um pr√™mio de risco positivo. Entretanto, o IBrX-100 apresentou pr√™mio de risco maior que zero em 55% dos dias no per√≠odo de 20 anos.\nEm termos pr√°ticos, para fins de aloca√ß√£o, o ETF PIBB11 segue o √≠ndice IBrX-100 e possui bastante liquidez. Este ETF √© uma √≥tima op√ß√£o na composi√ß√£o das carteiras para representar um √≠ndice de mercado."
  },
  {
    "objectID": "python.html",
    "href": "python.html",
    "title": "Projetos em Python",
    "section": "",
    "text": "python-bcb √© o hermitiano conjugado do rbcb. Nessa de usar R e Python o trabalho acaba sendo duplicado, mas faz parte!\n\nReposit√≥rio\nSite"
  },
  {
    "objectID": "python.html#bizdays",
    "href": "python.html#bizdays",
    "title": "Projetos em Python",
    "section": "bizdaysüì¶",
    "text": "bizdaysüì¶\nbizdays √© um pacote para contagem de dias √∫teis. Foi originalmente escrito em R e depois foi portado para Python.\nHoje tem muito mais do que dias √∫teis:\n\ncalcula dias √∫teis entre duas datas, de acordo com um calend√°rio\nverifica se as data s√£o dias √∫teis\nsoma (subtrai) dias √∫teis a datas\nconverte de dias √∫teis para dias corridos\n\ne um pouquinho mais ‚Ä¶\n\nReposit√≥rio\nSite"
  },
  {
    "objectID": "python.html#regexparser",
    "href": "python.html#regexparser",
    "title": "Projetos em Python",
    "section": "regexparserüì¶",
    "text": "regexparserüì¶\nUm simples parser de texto baseado em express√µes regulares. Frequentemente preciso fazer o parsing de texto em inteiros, decimais, datas, e outros formatos. Isso levava a muita duplica√ß√£o de c√≥digo, de forma que criei esse pequeno m√≥dulo onde posso centralizar todos os parsers que preciso em uma estrutura que me permite, utilizando express√µes regulares, criar uma hierarquia para a realiza√ß√£o dos parsers.\n\nReposit√≥rio"
  },
  {
    "objectID": "python.html#pricing-brazilian-securities-lecture-notes",
    "href": "python.html#pricing-brazilian-securities-lecture-notes",
    "title": "Projetos em Python",
    "section": "Pricing Brazilian Securities (Lecture Notes)",
    "text": "Pricing Brazilian Securities (Lecture Notes)\nNotas de aula de um curso de pricing de ativos brasileiros totalmente em Python.\n\nJupyter Notebooks\n\nT√≥picos:\n\nLecture 1\n\nA bit of history\n\nInflation in Brazil\nInterest rates in Brazil\n\nCalendars\nCompounding Regimes\nDI1 Future\nDI x PRE Curve\nInterpolation\nForward Rates\nCOPOM Meetings\n\nLecture 2\n\nFlat-forward interpolation with COPOM Meetings\nTreasury Direct contracts\n\nFloating: LFT\nFixed: LTN, NTN-F\nIndexed: NTN-B, Bullet NTN-B\n\nANBIMA Data\nBootstrap\nNelson-Siegel coeficients ANBIMA\nImplied Inflation\n\nLecture 3\n\nU.S. Dollar Futures - DOL\n\nDollar curve\n\nDI x U.S. Dollar Spread Futures - DDI\n\nDirty DI x U.S. Dollar Spread curve\n\nForward Rate Agreement on DI x U.S. Dollar Spread - FRC\n\nClean DI x U.S. Dollar Spread curve\n\n\nLecture 4\n\nDI x IPCA Spread Futures - DAP\n\nDI x IPCA Spread Curve\n\nIbovespa Futures - IND\n\nDI x Ibovespa Spread Curve\n\nCommodities Futures\n\nCash Settled Live Cattle Futures - BGI\nCash Settled Corn Futures - CCM\n\nDeb√™ntures\n\nFixed Rate\nFloating Rate: CDI+spread, %CDI\nIndexed: IPCA"
  },
  {
    "objectID": "R.html",
    "href": "R.html",
    "title": "Projetos em R",
    "section": "",
    "text": "Os arquivos disponibilizados no mercado financeiro brasileiro s√£o da idade da pedra. Definitivamente n√£o h√° um padr√£o, o que torna dif√≠cil o trabalho de quem faz an√°lise de dados do mercado financeiro brasileiro. O pacote rb3, ataca este problema criando parsers para todos os arquivos divulgados pela B3. Estes arquivos contem informa√ß√£o de diversos contratos negociados na Bolsa, de onde √© poss√≠vel extrair diversos insumos para an√°lise de negocia√ß√£o e gest√£o de risco.\n\nReposit√≥rio\nSite"
  },
  {
    "objectID": "R.html#fixedincome",
    "href": "R.html#fixedincome",
    "title": "Projetos em R",
    "section": "fixedincomeüì¶",
    "text": "fixedincomeüì¶\n\nfixedincome √© um pacote para realizar c√°lculos de renda fixa. √â bastante espec√≠fico para quem trabalha com finan√ßas. O objetivo √© trabalhar com c√°lculos de envolvendo taxas de juros de forma estruturada e limpa.\n\nReposit√≥rio\nSite"
  },
  {
    "objectID": "R.html#copom",
    "href": "R.html#copom",
    "title": "Projetos em R",
    "section": "copomüì¶",
    "text": "copomüì¶\n\nNo Brasil, temos as reuni√µes do COPOM (Comit√™ de Pol√≠tica Monet√°ria do Banco Central) onde os rumos da pol√≠tica monet√°ria do pais s√£o decididos. As decis√µes do COPOM, que determinam as taxas de juros de curto prazo, influenciam a din√¢mica das curvas de juros. Dessa maneira, √© poss√≠vel extrair da curva de juros as expectativas de mercado das decis√µes do COPOM.\nAlgumas abordagens s√£o implementadas no pacote copom.\n\nReposit√≥rio\nSite"
  },
  {
    "objectID": "R.html#oplib",
    "href": "R.html#oplib",
    "title": "Projetos em R",
    "section": "oplibüì¶",
    "text": "oplibüì¶\n\noplib implementa diversos modelos de pricing para op√ß√µes e c√°lculo de volatilidade impl√≠cita aplicados a op√ß√µes de a√ß√µes, √≠ndices, moedas e taxas de juros.\n\nReposit√≥rio"
  },
  {
    "objectID": "R.html#rbcb",
    "href": "R.html#rbcb",
    "title": "Projetos em R",
    "section": "rbcbüì¶",
    "text": "rbcbüì¶\n\nrbcb √© mais um pacote R na miss√£o de estruturar os dados utilizados no mercado financeiro brasileiro, neste caso, dados publicados pelo Banco Central do Brasil (BCB) no seu portal de dados abertos. Este pacote baixa as s√©ries divulgadas pelo BCB e disponibiliza em estruturas de dados no R.\n\nReposit√≥rio"
  },
  {
    "objectID": "R.html#bizdays",
    "href": "R.html#bizdays",
    "title": "Projetos em R",
    "section": "bizdaysüì¶",
    "text": "bizdaysüì¶\n\nbizdays √© um pacote para contagem de dias √∫teis. Foi originalmente escrito em R e depois foi portado para Python.\nHoje tem muito mais do que dias √∫teis:\n\ncalcula dias √∫teis entre duas datas, de acordo com um calend√°rio\nverifica se as data s√£o dias √∫teis\nsoma (subtrai) dias √∫teis a datas\nconverte de dias √∫teis para dias corridos\n\ne um pouquinho mais ‚Ä¶\n\nReposit√≥rio\nSite"
  },
  {
    "objectID": "R.html#numbersbr",
    "href": "R.html#numbersbr",
    "title": "Projetos em R",
    "section": "numbersBRüì¶",
    "text": "numbersBRüì¶\nnumbersBR √© um pacote R para fazer valida√ß√£o dos diversos n√∫meros de identifica√ß√£o existentes no Brasil, como: CPF, CNPJ, ‚Ä¶\n\nReposit√≥rio"
  },
  {
    "objectID": "R.html#estrat√©gias-de-trading-trading-strategies",
    "href": "R.html#estrat√©gias-de-trading-trading-strategies",
    "title": "Projetos em R",
    "section": "Estrat√©gias de trading (Trading Strategies)",
    "text": "Estrat√©gias de trading (Trading Strategies)\nFui monitor do cursos de Estrat√©gias de Trading do Mestrado Profissional de Finan√ßas Quantitativas da Faculdade de Economia da Funda√ß√£o Get√∫lio Vargas.\nFiz um material bem legal nesse curso com apresenta√ß√µes e c√≥digos em R que podem ser encontrados aqui."
  },
  {
    "objectID": "rendafixa.html",
    "href": "rendafixa.html",
    "title": "Renda Fixa usando R",
    "section": "",
    "text": "O curso Renda Fixa usando R se divide em 9 m√≥dulos, trazendo uma vis√£o de opera√ß√µes com taxas de juros e regimes de capitaliza√ß√£o, definindo conceitos de valor do dinheiro no tempo e valor presente de fluxos de caixa.\nImplementa a constru√ß√£o da estrutura a termo de taxas de juros (ETTJ) e alguns m√©todos de interpola√ß√£o de taxas.\nS√£o apresentadas metodologias de apre√ßamento de instrumentos de renda fixa pr√©-fixados, p√≥s-fixados e indexados.\nA teoria ser√° abordada sempre de forma leve e concomitante com exemplos pr√°ticos.\nDura√ß√£o: 09:19:28"
  },
  {
    "objectID": "rendafixa.html#m√≥dulo-1-valor-do-dinheiro-no-tempo",
    "href": "rendafixa.html#m√≥dulo-1-valor-do-dinheiro-no-tempo",
    "title": "Renda Fixa usando R",
    "section": "M√≥dulo 1: Valor do dinheiro no tempo",
    "text": "M√≥dulo 1: Valor do dinheiro no tempo\nValor presente de um fluxo futuro\n\n\n\nDura√ß√£o: 00:46:47\n\n\n\n\n\n#\nAula\nDura√ß√£o\n\n\n\n\n1\nPor que usar R para Renda Fixa?\n20:42\n\n\n2\nOpera√ß√£o Financeira Elementar\n11:12\n\n\n3\nWebscraping da Taxa DI (CDI) no site da B3\n06:26\n\n\n4\nEfeito do Tempo na Capitaliza√ß√£o da Taxa de Juros\n08:24"
  },
  {
    "objectID": "rendafixa.html#m√≥dulo-2-regimes-de-capitaliza√ß√£o",
    "href": "rendafixa.html#m√≥dulo-2-regimes-de-capitaliza√ß√£o",
    "title": "Renda Fixa usando R",
    "section": "M√≥dulo 2: Regimes de capitaliza√ß√£o",
    "text": "M√≥dulo 2: Regimes de capitaliza√ß√£o\nTaxas de juros simples Taxas de juros compostos Taxas de juros cont√≠nuos\n\n\n\nDura√ß√£o: 00:52:52\n\n\n\n\n\n#\nAula\nDura√ß√£o\n\n\n\n\n1\nRegimes de Capitaliza√ß√£o\n23:09\n\n\n2\nRegras de Contagem de Dias\n11:00\n\n\n3\nCalend√°rios\n10:03\n\n\n4\nEspecifica√ß√£o da taxa de juros\n08:38"
  },
  {
    "objectID": "rendafixa.html#m√≥dulo-3-opera√ß√µes-com-fluxo-de-caixa",
    "href": "rendafixa.html#m√≥dulo-3-opera√ß√µes-com-fluxo-de-caixa",
    "title": "Renda Fixa usando R",
    "section": "M√≥dulo 3: Opera√ß√µes com Fluxo de Caixa",
    "text": "M√≥dulo 3: Opera√ß√µes com Fluxo de Caixa\nExemplos de Opera√ß√µes com Fluxo de Caixa TIR (Taxa Interna de Retorno)\n\n\n\nDura√ß√£o: 00:47:43\n\n\n\n\n\n\n\n\n\n\n#\nAula\nDura√ß√£o\n\n\n\n\n1\nValor presente de um fluxo de caixa\n10:01\n\n\n2\nValor presente de um fluxo de caixa com m√∫ltiplos pagamentos\n20:10\n\n\n3\nTIR - Taxa Interna de Retorno\n17:32"
  },
  {
    "objectID": "rendafixa.html#m√≥dulo-4-precifica√ß√£o-de-instrumentos-de-renda-fixa-pr√©-fixados",
    "href": "rendafixa.html#m√≥dulo-4-precifica√ß√£o-de-instrumentos-de-renda-fixa-pr√©-fixados",
    "title": "Renda Fixa usando R",
    "section": "M√≥dulo 4: Precifica√ß√£o de Instrumentos de Renda Fixa Pr√©-fixados",
    "text": "M√≥dulo 4: Precifica√ß√£o de Instrumentos de Renda Fixa Pr√©-fixados\nBullet Bonds Pr√©-fixados: LTN, CDB Bonds Pr√©-fixados: NTN-F\n\n\n\nDura√ß√£o: 01:19:09\n\n\n\n\n\n#\nAula\nDura√ß√£o\n\n\n\n\n1\nInstrumentos de Renda Fixa dispon√≠veis no mercado\n16:23\n\n\n2\nCDB e LC prefixados\n32:16\n\n\n3\nLTN - Tesouro Prefixado\n14:37\n\n\n4\nNTN-F - Tesouro Prefixado com Juros Semestrais\n15:52"
  },
  {
    "objectID": "rendafixa.html#m√≥dulo-5-precifica√ß√£o-de-instrumentos-de-renda-fixa-indexados",
    "href": "rendafixa.html#m√≥dulo-5-precifica√ß√£o-de-instrumentos-de-renda-fixa-indexados",
    "title": "Renda Fixa usando R",
    "section": "M√≥dulo 5: Precifica√ß√£o de Instrumentos de Renda Fixa Indexados",
    "text": "M√≥dulo 5: Precifica√ß√£o de Instrumentos de Renda Fixa Indexados\nBullet Bonds Indexados: NTN-B (Tesouro IPCA Principal) Bonds Indexados: NTN-B (Tesouro IPCA)\n\n\n\nDura√ß√£o: 01:06:28\n\n\n\n\n\n#\nAula\nDura√ß√£o\n\n\n\n\n1\nInstrumentos de Renda Fixa Indexados\n11:22\n\n\n2\nVNA - Valor Nominal Atualizado\n23:38\n\n\n3\nNTN-B Principal - Tesouro IPCA+\n20:50\n\n\n4\nNTN-B - Tesouro IPCA+ com Juros Semestrais\n10:37"
  },
  {
    "objectID": "rendafixa.html#m√≥dulo-6-curva-de-juros---estrutura-a-termo-de-taxas-de-juros-ettj",
    "href": "rendafixa.html#m√≥dulo-6-curva-de-juros---estrutura-a-termo-de-taxas-de-juros-ettj",
    "title": "Renda Fixa usando R",
    "section": "M√≥dulo 6: Curva de Juros - Estrutura a Termo de Taxas de Juros (ETTJ)",
    "text": "M√≥dulo 6: Curva de Juros - Estrutura a Termo de Taxas de Juros (ETTJ)\nTaxas √† vista Taxas a termo\n\n\n\nDura√ß√£o: 00:59:11\n\n\n\n\n\n\n\n\n\n\n#\nAula\nDura√ß√£o\n\n\n\n\n1\nCurva de Juros Prefixados\n33:06\n\n\n2\nTaxas a termo na Curva de Juros Prefixados\n14:19\n\n\n3\nExtraindo expectativas do COPOM da Curva de Juros Prefixados\n11:45"
  },
  {
    "objectID": "rendafixa.html#m√≥dulo-7-interpola√ß√£o-da-estrutura-a-termo-de-taxas-de-juros-ettj",
    "href": "rendafixa.html#m√≥dulo-7-interpola√ß√£o-da-estrutura-a-termo-de-taxas-de-juros-ettj",
    "title": "Renda Fixa usando R",
    "section": "M√≥dulo 7: Interpola√ß√£o da Estrutura a Termo de Taxas de Juros (ETTJ)",
    "text": "M√≥dulo 7: Interpola√ß√£o da Estrutura a Termo de Taxas de Juros (ETTJ)\nInterpola√ß√£o Linear Interpola√ß√£o Flat-forward Interpola√ß√£o Spline\n\n\n\nDura√ß√£o: 00:56:23\n\n\n\n\n\n#\nAula\nDura√ß√£o\n\n\n\n\n1\nInterpola√ß√£o Linear\n25:23\n\n\n2\nInterpola√ß√£o FlatForward\n14:10\n\n\n3\nInterpola√ß√£o Spline C√∫bico Natural\n08:54\n\n\n4\nComparando m√©todos de interpola√ß√£o\n07:54"
  },
  {
    "objectID": "rendafixa.html#m√≥dulo-8-precifica√ß√£o-de-instrumentos-de-renda-fixa-p√≥s-fixados",
    "href": "rendafixa.html#m√≥dulo-8-precifica√ß√£o-de-instrumentos-de-renda-fixa-p√≥s-fixados",
    "title": "Renda Fixa usando R",
    "section": "M√≥dulo 8: Precifica√ß√£o de Instrumentos de Renda Fixa P√≥s-fixados",
    "text": "M√≥dulo 8: Precifica√ß√£o de Instrumentos de Renda Fixa P√≥s-fixados\nBullet Bonds P√≥s-fixados: LFT, CDB CDI + taxa, CDB %CDI\n\n\n\nDura√ß√£o: 01:20:43\n\n\n\n\n\n\n\n\n\n\n#\nAula\nDura√ß√£o\n\n\n\n\n1\nLFT - Tesouro SELIC\n18:06\n\n\n2\nRentabilidade da LFT\n14:29\n\n\n3\nCDB p√≥s-fixado\n15:19\n\n\n4\nAvalia√ß√£o de arbitragem entre CDBs prefixados e p√≥s-fixados\n12:14\n\n\n5\nAvalia√ß√£o de arbitragem entre CDBs e LCI/LCA\n20:33"
  },
  {
    "objectID": "rendafixa.html#m√≥dulo-9-precifica√ß√£o-de-instrumentos-de-renda-fixa-com-amortiza√ß√£o-deb√™ntures",
    "href": "rendafixa.html#m√≥dulo-9-precifica√ß√£o-de-instrumentos-de-renda-fixa-com-amortiza√ß√£o-deb√™ntures",
    "title": "Renda Fixa usando R",
    "section": "M√≥dulo 9: Precifica√ß√£o de Instrumentos de Renda Fixa com Amortiza√ß√£o (Deb√™ntures)",
    "text": "M√≥dulo 9: Precifica√ß√£o de Instrumentos de Renda Fixa com Amortiza√ß√£o (Deb√™ntures)\nBonds Pr√©-fixados Com Amortiza√ß√£o Bonds Indexados Com Amortiza√ß√£o Bonds P√≥s-fixados Com Amortiza√ß√£o\n\n\n\nDura√ß√£o: 01:10:09\n\n\n\n\n\n#\nAula\nDura√ß√£o\n\n\n\n\n1\nDeb√™ntures\n09:06\n\n\n2\nDownload de dados de Deb√™ntures com API CALC da B3\n05:57\n\n\n3\nDeb√™ntures Prefixadas 1\n09:42\n\n\n4\nDeb√™ntures Prefixadas 2\n10:36\n\n\n5\nDeb√™ntures P√≥s-fixadas\n10:28\n\n\n6\nDeb√™ntures Indexadas 1\n08:51\n\n\n7\nDeb√™ntures Indexadas 2\n15:25\n\n\n\n\n\n\n Link para o Curso"
  },
  {
    "objectID": "shinyapps.html",
    "href": "shinyapps.html",
    "title": "Shinyapps",
    "section": "",
    "text": "Shinyapp para visualiza√ß√£o da curva de juros prefixados extra√≠da dos contratos futuros de taxa DI (DI1).\n\nLink\n\nAvalia-se:\n\nCurva de Juros Prefixados com um horizonte de 2 anos para uma data espec√≠fica\n\nTaxas de juros a termo entre os v√©rtices da curva\n\nExpectativas de taxas de juros nas reuni√µes do COPOM\nCompara√ß√£o de Curva de Juros Prefixados em diferentes datas"
  },
  {
    "objectID": "shinyapps.html#opapp",
    "href": "shinyapps.html#opapp",
    "title": "Shinyapps",
    "section": "OpApp",
    "text": "OpApp\nShinyapp para visualiza√ß√£o de dados de op√ß√µes de a√ß√µes.\n\nLink\n\nAvalia-se:\n\nDados de op√ß√µes de a√ß√µes, volatilidade impl√≠cita e gregas\nGr√°fico de Volatilidade Impl√≠cita\nAjuste do modelo de Corrado-Su para os pre√ßos de op√ß√µes e visualiza√ß√£o das volatilidades pelo modelo"
  },
  {
    "objectID": "shinyapps.html#stock-analysis",
    "href": "shinyapps.html#stock-analysis",
    "title": "Shinyapps",
    "section": "Stock Analysis",
    "text": "Stock Analysis\nShinyapp para an√°lise de a√ß√µes com informa√ß√µes de retornos, volatilidade e an√°lise de risco.\n\nLink\n\nAvalia-se:\n\nRetornos de uma a√ß√£o para diversas janelas de tempo\n\nDrawdown\n\nVolatilidade de uma a√ß√£o com o modelo GARCH(1,1)\nAn√°lise de Risco"
  }
]