[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "Sobre",
    "section": "",
    "text": "Eu sou Wilson Freitas.\n\nFísico\nPai de 2 meninos (já grandinhos!)\nCorredor\nPadeiro\nGosto de fazer contas\n\nTô tentando deixar um legado em pacotes em R e Python para tornar a vida das pessoas menos miserável."
  },
  {
    "objectID": "bancodedados.html",
    "href": "bancodedados.html",
    "title": "Construindo Banco de Dados Financeiros",
    "section": "",
    "text": "Link para o Curso\nConstruir um banco de dados financeiros com um processo 100% automático desenvolvido na linguagem R.\nEsta é a proposta desse curso!\nQuem faz análises com dados financeiros sofre com informações espalhadas em diversos lugares, em formatos distintos e atualizadas em momentos diferentes.\nA construção de um repositório único, onde as informações são padronizadas e podem ser acessadas de maneira simples em um banco de dados único.\nO curso Construindo Banco de Dados Financeiros tem uma abordagem 100% mão na massa para a construção de um banco de dados a partir da coleta automatizada de diversos dados do mercado financeiro.\nOs dados são referentes a diversos contratos negociados no mercado e indicadores financeiros necessários para tarefas apreçamento e cálculo de risco.\nTodo o conteúdo do curso é totalmente desenvolvido com a linguagem de programação e análise de dados R. Passa por diversos pacotes para processamento de dados, leitura de arquivos: texto, json, csv, xml, operações em banco de dados relacional e consumo de APIs on-line.\nO objetivo é construir um sistema DO ZERO para automatizar o processo de download de dados financeiros de diversas fontes do mercado financeiro (B3, ANBIMA, BACEN, TesouroDireto), criando um repositório de dados para o processamento e o enriquecimento dos dados para que sejam usados em diversas análises.\nSerão desenvolvidos os processos de download e armazenamento dos dados brutos e, posteriormente, o processo de enriquecimento que transforma os dados brutos em dados estruturados.\nNo fim, serão criadas funções no R para consumir os dados estruturados e utilizá-los nas mais diversas análises.\nDuração: 07:52:25"
  },
  {
    "objectID": "bancodedados.html#módulo-1-processo-de-downloads-e-tratamento-de-dados",
    "href": "bancodedados.html#módulo-1-processo-de-downloads-e-tratamento-de-dados",
    "title": "Construindo Banco de Dados Financeiros",
    "section": "Módulo 1: Processo de Downloads e Tratamento de Dados",
    "text": "Módulo 1: Processo de Downloads e Tratamento de Dados\n\nDesenvolvemos um processo totalmente em R onde o usuário pode, através de arquivos de configuração YAML, definir os dados que serão baixados e incluídos no banco de dados.\nO fato do código ser 100% R permite que, com o passar das aulas, o aluno compreenda cada passo do processo e seja capaz de realizar suas eventuais intervenções.\n\n\n\nDuração: 00:57:50\n\n\n\n\n\n#\nAula\nDuração\n\n\n\n\n1\nApresentando o Projeto\n05:09\n\n\n2\nEstrutura de diretórios do Projeto\n02:06\n\n\n3\nArquivos YAML\n03:18\n\n\n4\nPacote yaml\n03:03\n\n\n5\nPacote logger\n04:17\n\n\n6\nConfiguração do Projeto\n06:12\n\n\n7\nCriação do MeuDB\n06:53\n\n\n8\nEntendendo a função load_configs\n03:40\n\n\n9\nExecutando o Pipeline de dados\n04:55\n\n\n10\nEntendendo a função download_data\n06:04\n\n\n11\nFunções de download específicas\n03:24\n\n\n12\nWebscraping do CDI da B3\n07:34\n\n\n13\nEncerramento do Módulo 1\n01:10\n\n\n\n\n\n\nDownload e processamento da Taxa DI (CDI) e do Índice DI (IDI) da B3\nA Taxa DI é uma das taxa de juros mais importantes utilizadas no Brasil. É a taxa de juros utilizada em diversos contratos negociados no mercado financeiro, como CDBs, Debêntures, LCI, LCA e outros."
  },
  {
    "objectID": "bancodedados.html#módulo-2-banco-para-armazenamento-dos-dados-mini-tutorial-de-sql",
    "href": "bancodedados.html#módulo-2-banco-para-armazenamento-dos-dados-mini-tutorial-de-sql",
    "title": "Construindo Banco de Dados Financeiros",
    "section": "Módulo 2: Banco para Armazenamento dos Dados (Mini Tutorial de SQL)",
    "text": "Módulo 2: Banco para Armazenamento dos Dados (Mini Tutorial de SQL)\nVamos criar um banco de dados SQLite do zero para o armazenamento dos dados baixados.\nMini tutorial de SQL e operações CRUD (Create Read Update Delete)\n\n\n\nDuração: 01:13:03\n\n\n\n\n\n\n\n\n\n\n#\nAula\nDuração\n\n\n\n\n1\nIntrodução a Banco de Dados\n04:13\n\n\n2\nCriando e inserindo tabelas\n07:58\n\n\n3\nAtualizando tabelas\n02:16\n\n\n4\nConsultas em tabelas\n05:50\n\n\n5\nRemovendo dados de tabelas\n03:02\n\n\n6\nCriação de índices em tabelas\n06:00\n\n\n7\nPacote DBI 1\n05:58\n\n\n8\nPacote DBI 2\n04:31\n\n\n9\nPacote DBI 3\n02:06\n\n\n10\nPacote DBI 4\n04:21\n\n\n11\nPacote dbplyr\n05:29\n\n\n12\nCriando tabelas no banco de dados MeuDB\n03:16\n\n\n13\nExecutando o Pipeline de dados inserindo dados no MeuDB\n04:19\n\n\n14\nEntendendo a função handle_data\n06:06\n\n\n15\nEntendendo os handlers de parse e insert no Pipeline de dados\n07:32"
  },
  {
    "objectID": "bancodedados.html#módulo-3-indicadores-financeiros-do-banco-central",
    "href": "bancodedados.html#módulo-3-indicadores-financeiros-do-banco-central",
    "title": "Construindo Banco de Dados Financeiros",
    "section": "Módulo 3: Indicadores Financeiros do Banco Central",
    "text": "Módulo 3: Indicadores Financeiros do Banco Central\nDownload e processamento de Indicadores Financeiros do Banco Central: IPCA, IGP-M, SELIC e Moedas\nProcessamento para geração do Número Índice dos indicadores financeiros: SELIC, IPCA, IGP-M\n\n\n\nDuração: 01:06:29\n\n\n\n\n\n\n\n\n\n\n#\nAula\nDuração\n\n\n\n\n1\nDownload dos dados da SELIC com o pacote rbcb\n08:39\n\n\n2\nImplementando download da SELIC no Pipeline de dados\n05:32\n\n\n3\nExecutando o Pipeline de dados com download da SELIC\n06:52\n\n\n4\nImplementando parse e insert da SELIC no Pipeline de dados\n07:56\n\n\n5\nImplementando download de IPCA e IGP-M no Pipeline de dados\n05:28\n\n\n6\nExecutando o Pipeline de dados com download de IPCA e IGP-M\n02:25\n\n\n7\nExecutando funções dinamicamente no R\n03:39\n\n\n8\nDownload de dados de moedas com o pacote rbcb\n05:09\n\n\n9\nListando moedas disponíveis com o rbcb\n02:38\n\n\n10\nExecutando o Pipeline de dados com download do USD\n03:49\n\n\n11\nImplementando insert do USD no Pipeline de dados\n04:01\n\n\n12\nImplementando o EUR no Pipeline de dados\n02:43\n\n\n13\nMudança nos downloaders com rbcb\n02:18\n\n\n14\nExecutando Pipeline de dados em BATCH\n05:14"
  },
  {
    "objectID": "bancodedados.html#módulo-4-indicadores-financeiros-da-anbima",
    "href": "bancodedados.html#módulo-4-indicadores-financeiros-da-anbima",
    "title": "Construindo Banco de Dados Financeiros",
    "section": "Módulo 4: Indicadores Financeiros da ANBIMA",
    "text": "Módulo 4: Indicadores Financeiros da ANBIMA\nProjeções de Inflação (IGP-M e IPCA) da ANBIMA VNA de Títulos Públicos da ANBIMA Preços e Taxas Títulos Públicos da ANBIMA\n\n\n\nDuração: 00:59:20\n\n\n\n\n\n\n\n\n\n\n#\nAula\nDuração\n\n\n\n\n1\nWebscraping de projeções de inflação da ANBIMA 1\n04:21\n\n\n2\nWebscraping de projeções de inflação da ANBIMA 2\n11:08\n\n\n3\nCriação de tabela para projeções de inflação da ANBIMA no MeuDB\n02:13\n\n\n4\nExecutando o Pipeline de dados com projeções de inflação da ANBIMA\n03:02\n\n\n5\nWebscraping de VNA de títulos públicos da ANBIMA 1\n04:14\n\n\n6\nWebscraping de VNA de títulos públicos da ANBIMA 2\n02:13\n\n\n7\nWebscraping de VNA de títulos públicos da ANBIMA 3\n04:29\n\n\n8\nWebscraping de VNA de títulos públicos da ANBIMA 4\n02:34\n\n\n9\nWebscraping de VNA de títulos públicos da ANBIMA 5\n05:43\n\n\n10\nCriação de tabela para VNA no MeuDB\n01:41\n\n\n11\nExecutando o Pipeline de dados com VNA de títulos públicos da ANBIMA\n02:31\n\n\n12\nWebscraping de Preços e Taxas de títulos públicos da ANBIMA 1\n05:20\n\n\n13\nWebscraping de Preços e Taxas de títulos públicos da ANBIMA 2\n05:54\n\n\n14\nCriação de tabela para Títulos Públicos no MeuDB\n01:40\n\n\n15\nExecutando o Pipeline de dados com Títulos Públicos da ANBIMA\n02:11"
  },
  {
    "objectID": "bancodedados.html#módulo-5-cadastro-de-instrumentos-da-b3",
    "href": "bancodedados.html#módulo-5-cadastro-de-instrumentos-da-b3",
    "title": "Construindo Banco de Dados Financeiros",
    "section": "Módulo 5: Cadastro de Instrumentos da B3",
    "text": "Módulo 5: Cadastro de Instrumentos da B3\nDownload e processamento do arquivo de Cadastro de Instrumentos (dados cadastrais de instrumentos) da B3 para Ações e Futuros\n\n\n\nDuração: 00:57:25\n\n\n\n\n\n\n\n\n\n\n#\nAula\nDuração\n\n\n\n\n1\nWebscraping da página de Pesquisa do Pregão da B3\n04:12\n\n\n2\nExecutando o Pipeline de dados com download do arquivo de Cadastro de Instrumentos da B3\n01:40\n\n\n3\nUnzip do arquivo de Cadastro de Instrumentos da B3\n04:32\n\n\n4\nVerificando integridade do arquivo zip do site de Pesquisa do Pregão da B3\n02:41\n\n\n5\nPacote XML\n09:18\n\n\n6\nVerificando a geração dos arquivos de Cadastro de Instrumentos da B3\n04:02\n\n\n7\nParsing do arquivo de Cadastro de Instrumentos da B3 - Dados de Equities (Ações)\n10:36\n\n\n8\nParsing do arquivo de Cadastro de Instrumentos da B3 - Dados de Futuros\n04:07\n\n\n9\nCriação de tabelas para Equities e Futuros no MeuDB\n01:54\n\n\n10\nExecutando o Pipeline de dados com dados de Equities e Futuros\n04:27\n\n\n11\nInvestigando os Dados de Equities\n05:48\n\n\n12\nInvestigando os Dados de Futuros\n03:07\n\n\n13\nPlanilha com Códigos de Cadastro de Instrumentos da B3\n00:55"
  },
  {
    "objectID": "bancodedados.html#módulo-6-boletim-de-negociação-da-b3",
    "href": "bancodedados.html#módulo-6-boletim-de-negociação-da-b3",
    "title": "Construindo Banco de Dados Financeiros",
    "section": "Módulo 6: Boletim de Negociação da B3",
    "text": "Módulo 6: Boletim de Negociação da B3\nDownload e processamento do arquivo Boletim de Negociação da B3 (Dados diários) para Ações e Futuros\n\n\n\nDuração: 00:28:26\n\n\n\n\n\n\n\n\n\n\n#\nAula\nDuração\n\n\n\n\n1\nWebScraping e download do arquivo PricingReport (arquivo de Preços) da B3\n04:21\n\n\n2\nCriação de tabelas para dados de Preços (PricingReport) no MeuDB\n02:42\n\n\n3\nInserindo os dados de Preços no MeuDB\n05:43\n\n\n4\nExecutando o Pipeline de dados com dados de Preços (PricingReport)\n03:36\n\n\n5\nWebScraping e download do arquivo IndexReport (arquivo de Índices) da B3 1\n03:32\n\n\n6\nWebScraping e download do arquivo IndexReport (arquivo de Índices) da B3 2\n04:51\n\n\n7\nCriação de tabelas para dados de Índices (IndexReport) no MeuDB\n01:15\n\n\n8\nExecutando o Pipeline de dados com dados de Índices (IndexReport)\n02:24"
  },
  {
    "objectID": "bancodedados.html#módulo-7-cálculo-do-preço-ajustado-de-ações",
    "href": "bancodedados.html#módulo-7-cálculo-do-preço-ajustado-de-ações",
    "title": "Construindo Banco de Dados Financeiros",
    "section": "Módulo 7: Cálculo do Preço Ajustado de Ações",
    "text": "Módulo 7: Cálculo do Preço Ajustado de Ações\nAjuste de retornos de Ações devido aos eventos corporativos (desdobramento, grupamento, etc)\n\n\n\nDuração: 01:16:55\n\n\n\n\n\n\n\n\n\n\n#\nAula\nDuração\n\n\n\n\n1\nImportando histórico de Equities no MeuDB\n05:04\n\n\n2\nImportando histórico de Preços no MeuDB\n05:04\n\n\n3\nImportando histórico de Futuros no MeuDB\n04:15\n\n\n4\nImportando histórico de Índices no MeuDB\n03:00\n\n\n5\nGerando histórico de retorno de ações\n12:06\n\n\n6\nCalculando EWMA para retornos da B3SA3\n06:08\n\n\n7\nCalculando EWMA para retornos de todos os ativos\n07:49\n\n\n8\nExecutando o cálculo do EWMA no Pipeline de dados\n07:14\n\n\n9\nConstruindo série de preços de ações ajustados 1\n08:32\n\n\n10\nConstruindo série de preços de ações ajustados 2\n04:11\n\n\n11\nExecutando o cálculo dos preços ajustados no Pipeline de dados\n05:52\n\n\n12\nDetectando eventos corporativos nos dados de Equities\n07:35"
  },
  {
    "objectID": "bancodedados.html#módulo-8-curvas-de-juros",
    "href": "bancodedados.html#módulo-8-curvas-de-juros",
    "title": "Construindo Banco de Dados Financeiros",
    "section": "Módulo 8: Curvas de Juros",
    "text": "Módulo 8: Curvas de Juros\nProcessamento para geração da Curva de Juros PrefixadaDownload e processamento das Curvas da ANBIMA\n\n\n\nDuração: 00:52:54\n\n\n\n\n\n\n\n\n\n\n#\nAula\nDuração\n\n\n\n\n1\nConstrução da Curva de Juros Prefixados de Mercado (com dados de Futuros de Taxa DI)\n09:36\n\n\n2\nConstrução da Curva de Juros Prefixados Padronizada em vértices fixos (para risco de mercado)\n06:46\n\n\n3\nExecutando a construção de curvas de juros no Pipeline de dados\n04:29\n\n\n4\nWebscraping da ANBIMA para Obter Curvas de Juros de Governo 1\n11:36\n\n\n5\nWebscraping da ANBIMA para Obter Curvas de Juros de Governo 2\n14:52\n\n\n6\nExecutando o Pipeline de dados com dados das curvas de juros da ANBIMA\n05:34\n\n\n\n\n\n\n Link para o Curso"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Wilson Freitas",
    "section": "",
    "text": "Dinâmica da Volatilidade Implícita\n\n\n\n\n\nComo a volatilidade implícita das opções evolui no tempo? Há diversas formas de se avaliar isso. Aqui veremos como é a dinâmica na volatilidade das opções ATM no tempo.\n\n\n\n\n\n\nAug 29, 2022\n\n\nWilson Freitas\n\n\n\n\n\n\n  \n\n\n\n\nMovimento da Parte Longa da Curva de Juros\n\n\n\n\n\n\n\nR\n\n\nfixedincome\n\n\nrb3\n\n\nopendata\n\n\n\n\nA reunião do COPOM no começo do mês de agosto de 2022 trouxe um tom que influenciou a dinâmica da parte longa da curva de juros. Aqui apresento uma animação do movimento da curva de juros nas duas primeiras semanas de agosto de 2022.\n\n\n\n\n\n\nAug 17, 2022\n\n\nWilson Freitas\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSuper Datasets para Opções de Ações\n\n\n\n\n\nUm dos super datasets do pacote {rb3} é o de opções de ações. Com este dataset é possível realizar diversos cálculos com dados de opções de ações, como calcular a volatilidade implícita das opções, as gregas e até mesmo fazer o ajuste de modelos teóricos.\n\n\n\n\n\n\nJun 24, 2022\n\n\nWilson Freitas\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nSuper Datasets do Pacote rb3\n\n\n\n\n\nO pacote {rb3} traz funções que retornam super datasets, conjuntos de dados mais ricos juntando a informação de diferentes datasets obtidos com as funções do pacote.\n\n\n\n\n\n\nJun 19, 2022\n\n\nWilson Freitas\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n16 anos de Curva Prefixada\n\n\n\n\n\n\n\nR\n\n\nfixedincome\n\n\nrb3\n\n\nopendata\n\n\n\n\nObservando a dinâmica da estrutura a termo de juros no Brasil e nos Estados Unidos ao longo dos últimos 16 anos.\n\n\n\n\n\n\nJun 18, 2022\n\n\nWilson Freitas\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nHistórico de Taxas de Juros em Dólar no Brasil\n\n\n\n\n\n\n\nR\n\n\nfixedincome\n\n\nrb3\n\n\nopendata\n\n\n\n\nFoi analisado em um post recente a dinâmica das taxas de juros, brasileira e americana. Trago neste post a comparação entre as taxas de juros em dólar, no Brasil e nos Estados Unidos.\n\n\n\n\n\n\nJun 10, 2022\n\n\nWilson Freitas\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nHistórico de Taxas de Juros de Longo Prazo\n\n\n\n\n\n\n\nR\n\n\nfixedincome\n\n\nrb3\n\n\nopendata\n\n\n\n\nAs taxas de juros de longo prazo são importantes variáveis econômicas. Observar a dinâmica dessas taxas é fundamental para uma boa compreensão do cenário econômico. Vamos ver como utilizar o pacote {fixedincome} para construir o histórico da taxa de juros prefixada para o prazo de 10 anos com dados extraídos da B3 com o pacote {rb3}.\n\n\n\n\n\n\nJun 9, 2022\n\n\nWilson Freitas\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nCurva de Juros de Americana - US Treasuries Curve\n\n\n\n\n\n\n\nR\n\n\nfixedincome\n\n\nopendata\n\n\n\n\nComo construir a curva de juros americana utilizando dados do Tesouro Americano (US Treasury) e o pacote {fixedincome}.\n\n\n\n\n\n\nJun 6, 2022\n\n\nWilson Freitas\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nIndicadores da Pesquisa Focus\n\n\n\n\n\n\n\nR\n\n\nbcb\n\n\nopendata\n\n\n\n\nAs APIs de Expectativas de Mercado da Pesquisa Focus não informam direito quais indicadores estão disponíveis. A documentação é meio falha e pouco confiável. Dessa maneira, a única maneira de descobrir o que está disponível é investigando a API. É isso que vou mostrar como fazer neste post.\n\n\n\n\n\n\nJun 5, 2022\n\n\nWilson Freitas\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nExpectativas de Mercado da Pesquisa Focus no R\n\n\n\n\n\n\n\nR\n\n\nbcb\n\n\nopendata\n\n\n\n\nObtendo as expectativas de mercado para os indicadores macroeconômicos da Pesquisa Focus utilizando o R e o pacote {rbcb}.\n\n\n\n\n\n\nJun 3, 2022\n\n\nWilson Freitas\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nGráficos de Composição de Índices da B3\n\n\n\n\n\n\n\nR\n\n\nrb3\n\n\nopendata\n\n\n\n\nCom o pacote {rb3} é possível obter a composição dos índices da B3, como o IBOVESPA, por exemplo. Vamos construir alguns gráficos donuts para avaliarmos a distribuição da composição dos índices.\n\n\n\n\n\n\nJun 1, 2022\n\n\nWilson Freitas\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nObtendo Dados do BCB com Python\n\n\n\n\n\n\n\nPython\n\n\nbcb\n\n\nopendata\n\n\n\n\nObter os dados para análise de forma simples é fundamental e necessário.\n\n\n\n\n\n\nJan 17, 2022\n\n\nWilson Freitas\n\n\n\n\n\n\nNo matching items"
  },
  {
    "objectID": "posts/2022-01-17-dados-bcb-com-python/dados-bcb-com-python.html",
    "href": "posts/2022-01-17-dados-bcb-com-python/dados-bcb-com-python.html",
    "title": "Obtendo Dados do BCB com Python",
    "section": "",
    "text": "Obter os dados para análise de forma simples é fundamental e necessário.\nDepois de passar alguns anos mantendo o pacote {rbcb} que faz a integração do R com as APIs de dados abertos do Banco Central, decidi fazer o port para Python.\nEm parte porque o PyPI (Python Package Index - repositório de pacotes do Python) é bem menos burocrático que o CRAN (repositório de pacote do R), mas nos últimos anos tenho mexido mais com Python e fazia sentido portar algumas ferramentas.\nO pacote {python-bcb} é a contraparte em Python do pacote {rbcb} do R.\nSó que acabou ficando maior, não por causa do Python, mas por que eu estava com tempo e paciência e acabei implementando parte da especificação OData. Isso permite de forma bem simples integrar diversas APIs do Banco Central que implementam essa especificação. Na minha última contagem tinha 39 APIs nessa estrutura.\nO pacote {python-bcb} traz as seguintes APIs:\n\nSGS\nSéries de Moedas do Conversor de Moedas do Banco Central\nExpectativas do FOCUS\nBoletins da PTAX (abertura, 3 intradiários, fechamento)\nDados selecionados de instituições financeiras (IFDATA)\n\nAgora o que dá mais trabalho ao fazer a integração de uma API é escrever a documentação😉 dado que as APIs não são padronizadas.\nVou comunicando aqui na medida que novas APIs forem sendo integradas.\nObviamente espero todo o tipo de comentários e sugestões.\nDocumentação do projeto: https://wilsonfreitas.github.io/python-bcb/index.html\nLink do projeto: https://github.com/wilsonfreitas/python-bcb\nNo código abaixo trago um exemplo que como utilizar a API de Expectativas do FOCUS para obter um DataFrame das expectativas de IPCA de 2021 ao longo de 2021.\n\nfrom bcb import Expectativas\n\nem = Expectativas()\nep = em.get_endpoint(\"ExpectativasMercadoAnuais\")\n\ndf_ipca_2021 = (\n    ep.query()\n      .filter(ep.Indicador == \"IPCA\")\n      .filter(ep.Data >= \"2021-01-01\", ep.Data <= \"2021-12-31\")\n      .filter(ep.DataReferencia == \"2021\", ep.baseCalculo == 1)\n      .orderby(ep.Data.asc())\n      .select(ep.Data, ep.Media, ep.Mediana)\n      .limit(10)\n      .collect()\n)\n\ndf_ipca_2021\n\n\n\n\n\n  \n    \n      \n      Data\n      Media\n      Mediana\n    \n  \n  \n    \n      0\n      2021-01-04\n      3.31\n      3.32\n    \n    \n      1\n      2021-01-05\n      3.29\n      3.30\n    \n    \n      2\n      2021-01-06\n      3.29\n      3.29\n    \n    \n      3\n      2021-01-07\n      3.27\n      3.28\n    \n    \n      4\n      2021-01-08\n      3.35\n      3.35\n    \n    \n      5\n      2021-01-11\n      3.40\n      3.40\n    \n    \n      6\n      2021-01-12\n      3.43\n      3.40\n    \n    \n      7\n      2021-01-13\n      3.48\n      3.44\n    \n    \n      8\n      2021-01-14\n      3.50\n      3.49\n    \n    \n      9\n      2021-01-15\n      3.52\n      3.47"
  },
  {
    "objectID": "posts/2022-06-03-expectativas-focus-com-rbcb/expectativas-focus-com-rbcb.html",
    "href": "posts/2022-06-03-expectativas-focus-com-rbcb/expectativas-focus-com-rbcb.html",
    "title": "Expectativas de Mercado da Pesquisa Focus no R",
    "section": "",
    "text": "É possível obter as expectativas de mercado para diversos indicadores macroeconômicos da pesquisa Focus de forma totalmente automática utilizando o R.\nVamos utilizar o pacote {rbcb} para obter estes dados. O pacote {rbcb} é uma interface para algumas das diversas APIs do portal de dados abertos do Banco Central (link).\nAs expectativas de mercado para os indicadores macroeconômicos da pesquisa Focus são consolidadas em estatísticas diárias e divulgadas na API. Estas estatísticas são calculadas com base nas expectativas de mercado de diversos bancos, gestores de recursos e demais instituições do mercado financeiro. Os indicadores macroeconômicos são referentes a índices de preços, crescimento do PIB e da produção industrial, taxa de câmbio, taxa Selic, variáveis fiscais e indicadores do setor externo e são publicadas todo primeiro dia útil da semana.\nCarregando os pacotes utilizados."
  },
  {
    "objectID": "posts/2022-06-03-expectativas-focus-com-rbcb/expectativas-focus-com-rbcb.html#série-temporal-das-expectativas-de-ipca",
    "href": "posts/2022-06-03-expectativas-focus-com-rbcb/expectativas-focus-com-rbcb.html#série-temporal-das-expectativas-de-ipca",
    "title": "Expectativas de Mercado da Pesquisa Focus no R",
    "section": "Série temporal das expectativas de IPCA",
    "text": "Série temporal das expectativas de IPCA\nVamos começar observando a série temporal das expectativas para cada DataReferencia.\n\ndf |>\n  ggplot(aes(x = Data, y = Mediana, group = DataReferencia, colour = DataReferencia)) +\n  geom_line() +\n  labs(\n    title = \"Expectativas para IPCA em 2021 e 2022\",\n    subtitle = \"Média das expectativas de IPCA\",\n    caption = \"Dados da Pesquisa Focus obtidos com pacote rbcb\",\n    x = \"Data\", y = \"Inflação\"\n  )\n\n\n\n\nCurioso ver como as expectativas de inflação para 2021 mudaram ao longo de 2021, ou seja, erra-se miseravelmente. As expectativas para 2022 mudam menos, bem, isso até virar o ano."
  },
  {
    "objectID": "posts/2022-06-03-expectativas-focus-com-rbcb/expectativas-focus-com-rbcb.html#série-temporal-com-intervalo-informado",
    "href": "posts/2022-06-03-expectativas-focus-com-rbcb/expectativas-focus-com-rbcb.html#série-temporal-com-intervalo-informado",
    "title": "Expectativas de Mercado da Pesquisa Focus no R",
    "section": "Série temporal com intervalo informado",
    "text": "Série temporal com intervalo informado\nVamos olhar agora apenas a DataReferencia 2021 e colocar as linhas de máximo e mínimo para termos uma ideia de intervalo para as expectativas.\n\ndf |>\n  filter(DataReferencia == 2021) |>\n  ggplot(aes(x = Data)) +\n  geom_line(aes(y = Mediana), colour = \"black\") +\n  geom_line(aes(y = Maximo), colour = \"grey\") +\n  geom_line(aes(y = Minimo), colour = \"grey\") +\n  geom_ribbon(aes(ymin = Minimo, ymax = Maximo), fill = \"blue\", alpha = 0.3) +\n  labs(\n    title = \"Expectativas para IPCA em 2021\",\n    subtitle = \"Média das expectativas de IPCA com intervalo definido por máximo e mínimo da amostra\",\n    caption = \"Dados da Pesquisa Focus obtidos com pacote rbcb\",\n    x = \"Data\", y = \"Inflação\"\n  )\n\n\n\n\nInteressante ver como as pesquisas erram e como, mesmo os mais ousados, não saem muito do consenso. Entendo que esse é um mecanismo necessário para se colocar o “bode na sala”, e ntretanto, erra-se miseravelmente, são muitos vieses envolvidos."
  },
  {
    "objectID": "posts/2022-06-05-indicadores-da-pesquisa-focus/indicadores-da-pesquisa-focus.html",
    "href": "posts/2022-06-05-indicadores-da-pesquisa-focus/indicadores-da-pesquisa-focus.html",
    "title": "Indicadores da Pesquisa Focus",
    "section": "",
    "text": "É possível obter as expectativas de mercado para diversos indicadores macroeconômicos da pesquisa Focus de forma totalmente automática utilizando o R.\nVamos utilizar o pacote {rbcb} para obter estes dados. O pacote {rbcb} é uma interface para algumas das diversas APIs do portal de dados abertos do Banco Central (link).\nAs expectativas de mercado para os indicadores macroeconômicos da pesquisa Focus são consolidadas em estatísticas diárias e divulgadas na API. Estas estatísticas são calculadas com base nas expectativas de mercado de diversos bancos, gestores de recursos e demais instituições do mercado financeiro. Os indicadores macroeconômicos são referentes a índices de preços, crescimento do PIB e da produção industrial, taxa de câmbio, taxa Selic, variáveis fiscais e indicadores do setor externo e são publicadas todo primeiro dia útil da semana.\nCarregando os pacotes utilizados."
  },
  {
    "objectID": "posts/2022-06-05-indicadores-da-pesquisa-focus/indicadores-da-pesquisa-focus.html#annual",
    "href": "posts/2022-06-05-indicadores-da-pesquisa-focus/indicadores-da-pesquisa-focus.html#annual",
    "title": "Indicadores da Pesquisa Focus",
    "section": "annual",
    "text": "annual\nConsulta 1\n\nget_market_expectations(\"annual\",\n  `$top` = 1,\n  `$select` = \"Data\",\n  `$orderby` = \"Data desc\"\n) |>\n  rmarkdown::paged_table()\n\n\n\n  \n\n\n\nConsulta 2\n\nget_market_expectations(\"annual\",\n  `$select` = \"Data,Indicador,IndicadorDetalhe\",\n  `$filter` = \"Data eq '2022-04-29'\"\n) |>\n  distinct(Indicador, IndicadorDetalhe) |>\n  arrange(Indicador, IndicadorDetalhe) |>\n  rmarkdown::paged_table()\n\n\n\n  \n\n\n\nEste endpoint tem uma coluna IndicadorDetalhe, que é como uma especificação do indicador. No caso, Balança Comercial-Saldo ou Balança Comercial-Exportações, por exemplo."
  },
  {
    "objectID": "posts/2022-06-05-indicadores-da-pesquisa-focus/indicadores-da-pesquisa-focus.html#monthly",
    "href": "posts/2022-06-05-indicadores-da-pesquisa-focus/indicadores-da-pesquisa-focus.html#monthly",
    "title": "Indicadores da Pesquisa Focus",
    "section": "monthly",
    "text": "monthly\nConsulta 1\n\nget_market_expectations(\"monthly\",\n  `$top` = 1,\n  `$select` = \"Data\",\n  `$orderby` = \"Data desc\"\n) |>\n  rmarkdown::paged_table()\n\n\n\n  \n\n\n\nConsulta 2\n\nget_market_expectations(\"monthly\",\n  `$select` = \"Data,Indicador\",\n  `$filter` = \"Data eq '2022-04-29'\"\n) |>\n  distinct(Indicador) |>\n  arrange(Indicador) |>\n  rmarkdown::paged_table()"
  },
  {
    "objectID": "posts/2022-06-05-indicadores-da-pesquisa-focus/indicadores-da-pesquisa-focus.html#quarterly",
    "href": "posts/2022-06-05-indicadores-da-pesquisa-focus/indicadores-da-pesquisa-focus.html#quarterly",
    "title": "Indicadores da Pesquisa Focus",
    "section": "quarterly",
    "text": "quarterly\nConsulta 1\n\nget_market_expectations(\"quarterly\",\n  `$top` = 1,\n  `$select` = \"Data\",\n  `$orderby` = \"Data desc\"\n) |>\n  rmarkdown::paged_table()\n\n\n\n  \n\n\n\nConsulta 2\n\nget_market_expectations(\"quarterly\",\n  `$select` = \"Data,Indicador\",\n  `$filter` = \"Data eq '2022-04-29'\"\n) |>\n  distinct(Indicador) |>\n  arrange(Indicador) |>\n  rmarkdown::paged_table()"
  },
  {
    "objectID": "posts/2022-06-05-indicadores-da-pesquisa-focus/indicadores-da-pesquisa-focus.html#inflation-12-months",
    "href": "posts/2022-06-05-indicadores-da-pesquisa-focus/indicadores-da-pesquisa-focus.html#inflation-12-months",
    "title": "Indicadores da Pesquisa Focus",
    "section": "inflation-12-months",
    "text": "inflation-12-months\nConsulta 1\n\nget_market_expectations(\"inflation-12-months\",\n  `$top` = 1,\n  `$select` = \"Data\",\n  `$orderby` = \"Data desc\"\n) |>\n  rmarkdown::paged_table()\n\n\n\n  \n\n\n\nConsulta 2\n\nget_market_expectations(\"inflation-12-months\",\n  `$select` = \"Data,Indicador\",\n  `$filter` = \"Data eq '2022-04-29'\"\n) |>\n  distinct(Indicador) |>\n  arrange(Indicador) |>\n  rmarkdown::paged_table()"
  },
  {
    "objectID": "posts/2022-06-05-indicadores-da-pesquisa-focus/indicadores-da-pesquisa-focus.html#top5s-annual",
    "href": "posts/2022-06-05-indicadores-da-pesquisa-focus/indicadores-da-pesquisa-focus.html#top5s-annual",
    "title": "Indicadores da Pesquisa Focus",
    "section": "top5s-annual",
    "text": "top5s-annual\nConsulta 1\n\nget_market_expectations(\"top5s-annual\",\n  `$top` = 1,\n  `$select` = \"Data\",\n  `$orderby` = \"Data desc\"\n) |>\n  rmarkdown::paged_table()\n\n\n\n  \n\n\n\nConsulta 2\n\nget_market_expectations(\"top5s-annual\",\n  `$select` = \"Data,Indicador\",\n  `$filter` = \"Data eq '2022-04-29'\"\n) |>\n  distinct(Indicador) |>\n  arrange(Indicador) |>\n  rmarkdown::paged_table()"
  },
  {
    "objectID": "posts/2022-06-05-indicadores-da-pesquisa-focus/indicadores-da-pesquisa-focus.html#top5s-monthly",
    "href": "posts/2022-06-05-indicadores-da-pesquisa-focus/indicadores-da-pesquisa-focus.html#top5s-monthly",
    "title": "Indicadores da Pesquisa Focus",
    "section": "top5s-monthly",
    "text": "top5s-monthly\nConsulta 1\n\nget_market_expectations(\"top5s-monthly\",\n  `$top` = 1,\n  `$select` = \"Data\",\n  `$orderby` = \"Data desc\"\n) |>\n  rmarkdown::paged_table()\n\n\n\n  \n\n\n\nConsulta 2\n\nget_market_expectations(\"top5s-monthly\",\n  `$select` = \"Data,Indicador\",\n  `$filter` = \"Data eq '2022-04-29'\"\n) |>\n  distinct(Indicador) |>\n  arrange(Indicador) |>\n  rmarkdown::paged_table()"
  },
  {
    "objectID": "posts/2022-06-05-indicadores-da-pesquisa-focus/indicadores-da-pesquisa-focus.html#top5s-selic",
    "href": "posts/2022-06-05-indicadores-da-pesquisa-focus/indicadores-da-pesquisa-focus.html#top5s-selic",
    "title": "Indicadores da Pesquisa Focus",
    "section": "top5s-selic",
    "text": "top5s-selic\nConsulta 1\n\nget_market_expectations(\"top5s-selic\",\n  `$top` = 1,\n  `$select` = \"Data\",\n  `$orderby` = \"Data desc\"\n) |>\n  rmarkdown::paged_table()\n\n\n\n  \n\n\n\nConsulta 2\n\nget_market_expectations(\"top5s-selic\",\n  `$select` = \"Data,indicador\",\n  `$filter` = \"Data eq '2022-04-29'\"\n) |>\n  distinct(indicador) |>\n  arrange(indicador) |>\n  rmarkdown::paged_table()\n\n\n\n  \n\n\n\nAqui temos uma pegadinha, a coluna indicador vem com sua inicial minúscula, diferente dos demais endpoints."
  },
  {
    "objectID": "posts/2022-06-05-indicadores-da-pesquisa-focus/indicadores-da-pesquisa-focus.html#selic",
    "href": "posts/2022-06-05-indicadores-da-pesquisa-focus/indicadores-da-pesquisa-focus.html#selic",
    "title": "Indicadores da Pesquisa Focus",
    "section": "selic",
    "text": "selic\nConsulta 1\n\nget_market_expectations(\"selic\",\n  `$top` = 1,\n  `$select` = \"Data\",\n  `$orderby` = \"Data desc\"\n) |>\n  rmarkdown::paged_table()\n\n\n\n  \n\n\n\nConsulta 2\n\nget_market_expectations(\"selic\",\n  `$select` = \"Data,Indicador\",\n  `$filter` = \"Data eq '2022-04-29'\"\n) |>\n  distinct(Indicador) |>\n  arrange(Indicador) |>\n  rmarkdown::paged_table()"
  },
  {
    "objectID": "posts/2022-06-08-curva-de-juros-de-americana-us-treasuries-curve/curva-de-juros-de-americana-us-treasuries-curve.html",
    "href": "posts/2022-06-08-curva-de-juros-de-americana-us-treasuries-curve/curva-de-juros-de-americana-us-treasuries-curve.html",
    "title": "Curva de Juros de Americana - US Treasuries Curve",
    "section": "",
    "text": "A curva de juros americana é uma peça fundamental do quebra-cabeças econômico/financeiro. Neste post vamos ver como obter os dados do histórico da estrutura a termo de juros dos Estados Unidos e como construir uma curva de juros utilizando o pacote {fixedincome}.\nVamos utilizar o Quandl, que hoje é o Nasdaq Data Link, para obter o histórico de juros americanos.\n\nlibrary(Quandl)\n\nyc_all <- Quandl(\"USTREASURY/YIELD\")\n\n\n\nLoading required package: xts\n\n\nLoading required package: zoo\n\n\n\nAttaching package: 'zoo'\n\n\nThe following objects are masked from 'package:base':\n\n    as.Date, as.Date.numeric\n\n\nyc_all traz todo o histórico de juros, as Constant Maturity Treasury rates, que relacionam as taxas de juros ao um conjuto de prazos padronizados: 1, 3, e 6 meses, e 1, 2, 3, 5, 7, 10, 20, e 30 anos.\n\nhead(yc_all)\n\n        Date 1 MO 2 MO 3 MO 6 MO 1 YR 2 YR 3 YR 5 YR 7 YR 10 YR 20 YR 30 YR\n1 2023-02-17 4.64 4.81 4.84 4.99 5.00 4.60 4.33 4.03 3.95  3.82  4.01  3.88\n2 2023-02-16 4.66 4.80 4.84 4.98 4.99 4.62 4.35 4.06 3.98  3.86  4.05  3.92\n3 2023-02-15 4.64 4.79 4.79 4.97 4.96 4.62 4.35 4.04 3.94  3.81  3.97  3.85\n4 2023-02-14 4.63 4.78 4.80 4.98 4.99 4.60 4.32 4.00 3.90  3.77  3.94  3.81\n5 2023-02-13 4.66 4.78 4.81 4.99 4.91 4.52 4.22 3.93 3.84  3.72  3.92  3.79\n6 2023-02-10 4.66 4.77 4.79 4.89 4.89 4.50 4.19 3.93 3.86  3.74  3.96  3.83\n\n\nVamos montar a curva de juros para uma data específica utilizando os prazos definidos no histórico.\n\nlibrary(tidyverse)\n\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.4.1     ✔ purrr   1.0.1\n✔ tibble  3.1.8     ✔ dplyr   1.1.0\n✔ tidyr   1.3.0     ✔ stringr 1.5.0\n✔ readr   2.1.4     ✔ forcats 1.0.0\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n\nrefdate <- as.Date(\"2022-02-04\")\nyc <- yc_all |> filter(Date == refdate)\n\nyc\n\n        Date 1 MO 2 MO 3 MO 6 MO 1 YR 2 YR 3 YR 5 YR 7 YR 10 YR 20 YR 30 YR\n1 2022-02-04 0.05 0.12 0.23 0.56 0.89 1.31 1.55 1.78  1.9  1.93  2.29  2.23\n\n\nComecemos construindo o vetor de prazos da curva. Para isso precisamos interpretar os nomes das colunas e convertê-los em prazos.\n\nnx <- names(yc)\nterms_names <- nx[-1]\nterms_names\n\n [1] \"1 MO\"  \"2 MO\"  \"3 MO\"  \"6 MO\"  \"1 YR\"  \"2 YR\"  \"3 YR\"  \"5 YR\"  \"7 YR\" \n[10] \"10 YR\" \"20 YR\" \"30 YR\"\n\n\nTemos MO indicando prazos em meses e YR indicando os anos. Vamos utilizar uma simples substituição de texto para converter MO para months e YR para years. Dessa forma podemos utilizar a função fixedincome::as.term que converte um string em um objeto term (prazo).\n\nlibrary(stringr)\n\nterms_names <- terms_names |>\n  str_replace(\"MO\", \"months\") |>\n  str_replace(\"YR\", \"years\")\n\nterms_names\n\n [1] \"1 months\" \"2 months\" \"3 months\" \"6 months\" \"1 years\"  \"2 years\" \n [7] \"3 years\"  \"5 years\"  \"7 years\"  \"10 years\" \"20 years\" \"30 years\"\n\n\nApós a conversão usamos a função purrr::map com a função fixedincome::as.term e assim vamos obter uma lista com diversos objetos term.\n\nlibrary(purrr)\nlibrary(fixedincome)\n\n\nAttaching package: 'fixedincome'\n\n\nThe following objects are masked from 'package:dplyr':\n\n    first, last\n\ncurve_terms <- map(terms_names, as.term)\ncurve_terms\n\n[[1]]\n[1] \"1 month\"\n\n[[2]]\n[1] \"2 months\"\n\n[[3]]\n[1] \"3 months\"\n\n[[4]]\n[1] \"6 months\"\n\n[[5]]\n[1] \"1 year\"\n\n[[6]]\n[1] \"2 years\"\n\n[[7]]\n[1] \"3 years\"\n\n[[8]]\n[1] \"5 years\"\n\n[[9]]\n[1] \"7 years\"\n\n[[10]]\n[1] \"10 years\"\n\n[[11]]\n[1] \"20 years\"\n\n[[12]]\n[1] \"30 years\"\n\n\nObviamente tudo isso poderia ter sido feito de forma direta.\n\ncurve_terms <- nx[-1] |>\n  str_replace(\"MO\", \"months\") |>\n  str_replace(\"YR\", \"years\") |>\n  map(as.term)\n\nPois bem, temos uma lista com prazos em meses e prazos em anos. É necessário converter os prazos para uma mesma unidade (units). Vou converter todos os prazos para dias. Para fazer isso vou criar um objeto daycount(\"actual/360\"), que é a regra de contagem de dias que considera dias corridos e anos com 360 dias. Com a regra de contagem de dias conseguimos fazer a conversão dos prazos para anos e utilizando a quantidade de dias no ano da regra, 360, fazemos a conversão para dias.\n\ndc <- daycount(\"actual/360\")\n\nterms <- curve_terms |>\n  map_dbl(\\(x) dib(dc) * toyears(dc, x)) |>\n  term(\"days\")\n\nterms\n\n [1] \"30 days\"    \"60 days\"    \"90 days\"    \"180 days\"   \"360 days\"  \n [6] \"720 days\"   \"1080 days\"  \"1800 days\"  \"2520 days\"  \"3600 days\" \n[11] \"7200 days\"  \"10800 days\"\n\n\nA função fixedincome::toyears converte os prazos para um número em anos, por exemplo, 6 meses retorna 0.5, e a função dib retorna a quantidade de dias no ano para a regra, neste caso, 360. Concluímos criando os objetos de prazo com term.\nAgora que já temos os prazos da curva vamos extrair as taxas do data.frame. É uma operação simples de extração de linhas de um data.frame e converter em um vetor. Fazemos uma verificação de NA por que eventualmente há podemos ter valores ausentes para alguns prazos.\n\nrates <- yc[1, -1] |>\n  as.list() |>\n  as.numeric()\nrates <- rates / 100\nix <- !is.na(rates)\n\nrates[ix]\n\n [1] 0.0005 0.0012 0.0023 0.0056 0.0089 0.0131 0.0155 0.0178 0.0190 0.0193\n[11] 0.0229 0.0223\n\n\nTendo os prazos, as taxas e a data de referência, podemos construir a curva com a função fixedincome::spotratecurve. Para a curva de juros americana utilizamos taxa de juros simples (compounding simple), regra de contagem de dias (actual/360) e o calendário de dias corridos (actual).\n\ntr_curve <- spotratecurve(\n  rates[ix], terms[ix],\n  \"simple\", \"actual/360\", \"actual\",\n  refdate = refdate\n)\n\ntr_curve\n\n          SpotRateCurve\n30 days          0.0005\n60 days          0.0012\n90 days          0.0023\n180 days         0.0056\n360 days         0.0089\n720 days         0.0131\n1080 days        0.0155\n1800 days        0.0178\n2520 days        0.0190\n3600 days        0.0193\n# ... with 2 more rows\nsimple actual/360 actual \nReference date: 2022-02-04 \n\n\nNote os prazos em dias. Agora é só visualizar a curva de forma graciosa!\n\nplot(tr_curve)"
  },
  {
    "objectID": "posts/2022-06-09-grficos-de-composio-de-ndices-da-b3/grficos-de-composio-de-ndices-da-b3.html",
    "href": "posts/2022-06-09-grficos-de-composio-de-ndices-da-b3/grficos-de-composio-de-ndices-da-b3.html",
    "title": "Gráficos de Composição de Índices da B3",
    "section": "",
    "text": "Recentemente, eu implementei no pacote {rb3} um conjunto de funções que baixam dados de índices do site da B3.\nVou mostrar aqui como utilizar a função rb3::index_weights_get, que retorna um data.frame com todas as ações que compõem um determinado índice, juntamente com os seus respectivos pesos no índice.\nVamos começar carregando os pacotes {rb3} e {tidyverse} que utilizo.\nA ideia aqui é avaliar a distribuição de ativos em alguns índices, a saber: IBOV, IBXX, IBXL, SMLL e IFIX. Contudo, essa avaliação será realizada da seguinte forma: os 10 ativos com a maior participação nos índices serão selecionados e os demais ativos serão colocado em um grupo definido como Others. Assim vou fazer um gráfico de donut (uma pizza com furo no meio) apresentando a participação de cada ativo no índice. Dessa maneira será possível avaliar a concentração dos índices.\nPara fazer essa seleção dos ativos e o agrupemento dos demais eu criei a função top_weight. Esta função já prepara o data.frame para a função ggdonut que constroi o gráfico de donut."
  },
  {
    "objectID": "posts/2022-06-09-grficos-de-composio-de-ndices-da-b3/grficos-de-composio-de-ndices-da-b3.html#ibovespa",
    "href": "posts/2022-06-09-grficos-de-composio-de-ndices-da-b3/grficos-de-composio-de-ndices-da-b3.html#ibovespa",
    "title": "Gráficos de Composição de Índices da B3",
    "section": "IBOVESPA",
    "text": "IBOVESPA\n\nindex_name <- \"IBOV\"\nindex_weights_get(index_name) |>\n    top_weight() |>\n    ggdonut(index_name)"
  },
  {
    "objectID": "posts/2022-06-09-grficos-de-composio-de-ndices-da-b3/grficos-de-composio-de-ndices-da-b3.html#ibx-100",
    "href": "posts/2022-06-09-grficos-de-composio-de-ndices-da-b3/grficos-de-composio-de-ndices-da-b3.html#ibx-100",
    "title": "Gráficos de Composição de Índices da B3",
    "section": "IBX 100",
    "text": "IBX 100\n\nindex_name <- \"IBXX\"\nindex_weights_get(index_name) |>\n    top_weight() |>\n    ggdonut(index_name)"
  },
  {
    "objectID": "posts/2022-06-09-grficos-de-composio-de-ndices-da-b3/grficos-de-composio-de-ndices-da-b3.html#ibx-50",
    "href": "posts/2022-06-09-grficos-de-composio-de-ndices-da-b3/grficos-de-composio-de-ndices-da-b3.html#ibx-50",
    "title": "Gráficos de Composição de Índices da B3",
    "section": "IBX 50",
    "text": "IBX 50\n\nindex_name <- \"IBXL\"\nindex_weights_get(index_name) |>\n    top_weight() |>\n    ggdonut(index_name)\n\nWarning: Automatic coercion from double to character was deprecated in purrr 1.0.0.\nℹ Please use an explicit call to `as.character()` within `map_chr()` instead.\nℹ The deprecated feature was likely used in the rb3 package.\n  Please report the issue at <https://github.com/wilsonfreitas/rb3/issues>."
  },
  {
    "objectID": "posts/2022-06-09-grficos-de-composio-de-ndices-da-b3/grficos-de-composio-de-ndices-da-b3.html#small",
    "href": "posts/2022-06-09-grficos-de-composio-de-ndices-da-b3/grficos-de-composio-de-ndices-da-b3.html#small",
    "title": "Gráficos de Composição de Índices da B3",
    "section": "SMALL",
    "text": "SMALL\n\nindex_name <- \"SMLL\"\nindex_weights_get(index_name) |>\n    top_weight() |>\n    ggdonut(index_name)"
  },
  {
    "objectID": "posts/2022-06-09-grficos-de-composio-de-ndices-da-b3/grficos-de-composio-de-ndices-da-b3.html#ifix",
    "href": "posts/2022-06-09-grficos-de-composio-de-ndices-da-b3/grficos-de-composio-de-ndices-da-b3.html#ifix",
    "title": "Gráficos de Composição de Índices da B3",
    "section": "IFIX",
    "text": "IFIX\n\nindex_name <- \"IFIX\"\nindex_weights_get(index_name) |>\n    top_weight() |>\n    ggdonut(index_name)"
  },
  {
    "objectID": "posts/2022-06-09-histrico-de-taxas-de-juros-de-longo-prazo/histrico-de-taxas-de-juros-de-longo-prazo.html",
    "href": "posts/2022-06-09-histrico-de-taxas-de-juros-de-longo-prazo/histrico-de-taxas-de-juros-de-longo-prazo.html",
    "title": "Histórico de Taxas de Juros de Longo Prazo",
    "section": "",
    "text": "No mercado norte americano há cotações para taxas de juros em prazos fixos, 1 ano, 5 anos, 10 anos, e assim por diante. Estas estruturas são conhecidas como Constant Term Maturities.\nEstes dados podem ser obtidos do site do Tesouro Americano (US Treasury) com o pacote {Quandl}.\n\nlibrary(Quandl)\n\nyc_all <- Quandl(\"USTREASURY/YIELD\")\n\n\n\nLoading required package: xts\n\n\nLoading required package: zoo\n\n\n\nAttaching package: 'zoo'\n\n\nThe following objects are masked from 'package:base':\n\n    as.Date, as.Date.numeric\n\n\nPodemos observar um longo histórico, desde a década de 90, para estas taxas.\n\nlibrary(tidyverse)\n\nyc_all |>\n    ggplot(aes(x = Date, y = `10 YR` / 100)) +\n    geom_line() +\n    labs(\n        x = NULL, y = NULL,\n        title = \"Histórico de Taxas de Juros Americanos de 10 Anos (Treasury Bonds)\",\n        caption = \"Dados do US Treasury obtidos com o pacote Quandl - wilsonfreitas\"\n    ) +\n    scale_y_continuous(labels = scales::percent)\n\n\n\n\nNo mercado brasileiro, infelizmente, a vida é um pouco miserável, e não há um histórico disponível com taxas de longo prazo. É necessário construir na unha e na força do ódio.\nOs ativos líquidos de onde são extraídas as taxas de juros de longo prazo são os contratos futuros de taxa DI - DI1, que são cotados diariamente na B3 em seus vencimentos. Entretanto, as taxas de juros obtidas destes contratos apresentam um prazo diferente a cada dia. Assim, é necessário construir uma curva de juros com estes contratos e realizar uma interpolação nos prazos fixos, 1 ano, 5 anos, 10 anos, e por aí vai.\nVamos utilizar o pacote {rb3} para obter o histórico com as curvas diárias de juros prefixados do mercado brasileiro e o pacote {fixedincome} para construir os objetos de curvas de juros e realizar a interpolação das curvas nos vértices fixos para obter o histórico de taxas de juros de longo prazo.\nVamos começar importando os pacotes utilizados nessa jornada.\n\nlibrary(rb3)\nlibrary(bizdays)\nlibrary(fixedincome)\nlibrary(tidyverse)\n\nA função rb3::yc_mget retorna um data.frame com o histórico de curvas de juros. Vamos baixar um histórico desde 2019.\n\ndc <- yc_mget(\n    first_date = \"2019-01-01\",\n    last_date = preceding(Sys.Date() - 1, \"Brazil/ANBIMA\"),\n    cache_folder = \"../../../rb3-data\"\n)\n\nWarning: Automatic coercion from double to character was deprecated in purrr 1.0.0.\nℹ Please use an explicit call to `as.character()` within `map_chr()` instead.\nℹ The deprecated feature was likely used in the rb3 package.\n  Please report the issue at <https://github.com/wilsonfreitas/rb3/issues>.\n\n\nDe posse do histórico, vamos construir as curvas de juros para cada data de referência utilizando a função fixedincome::spotratecurve. A curva de juros prefixada tem as seguintes características:\n\nregime de capitalização: discrete (juros compostos)\nregra de contagem de dias: business/252\ncalendário: Brazil/ANBIMA\ninterpolação: flat-forward\n\nAdicionalmente faço uma limpeza nos eventuais problemas encontrados nos dados, como dias úteis zerados e duplicados. Bem, é de graça, exigir dados corretos deve ser um pouco demais, né?\n\nunique(dc$refdate) |> map(function(date, df) {\n    df_curve <- df |>\n        filter(refdate == date, biz_days > 0) |>\n        filter(!duplicated(biz_days))\n    curve <- spotratecurve(\n        df_curve$r_252,\n        df_curve$biz_days,\n        \"discrete\", \"business/252\", \"Brazil/ANBIMA\",\n        refdate = date\n    )\n    interpolation(curve) <- interp_flatforward()\n    curve\n}, df = dc) -> curves\n\nObtendo um lista com as curvas de juros utilizamos os colchetes [[ para realizar a interpolação no prazo fixo de 10 anos. Como estas curvas utilizam a regra de contagem de dias business/252, devemos considerar que 1 ano tem 252 dias úteis e portanto, 10 anos tem 2520 dias úteis. Por isso, interpolamos a curva no vértice 2520.\n\ncurves |>\n    map_dfr(\\(x) tibble(\n        refdate = x@refdate,\n        r_BRL_10y = as.numeric(x[[2520]])\n    )) -> rates_10y\n\nJá aproveito e retorno o histórico em um data.frame com as colunas refdate e r_BRL_10y. Faço isso para juntar com os dados de juros americanos de 10 anos e assim comparar a dinâmica das taxas conjuntamente.\n\nrates_10y <- rates_10y |>\n    left_join(yc_all |> select(Date, `10 YR`), by = c(\"refdate\" = \"Date\")) |>\n    rename(r_USD_us_10y = `10 YR`) |>\n    mutate(r_USD_us_10y = r_USD_us_10y / 100)\n\nNote que eu nomeio a taxa de juros americana com r_USD_us_10y, pois essa é uma taxa que capitaliza o dólar (USD) nos Estados Unidos (us). Abaixo faço um malabarismo com tidyr::pivot_longer para preparar os dados para o ggplot e assim visualizá-los lado a lado. Note ainda que libero a escala dos gráficos (scales = \"free_y\") para que a diferença de nível entre as taxas de juros, brasileira e americana, não afete a análise. O objetivo é visualizar a dinâmica das taxas de juros ao longo do tempo.\n\nrates_10y |>\n    tidyr::pivot_longer(\n        c(r_BRL_10y, r_USD_us_10y),\n        names_to = \"rates\"\n    ) |>\n    ggplot(aes(x = refdate, y = value, colour = rates)) +\n    geom_line() +\n    facet_wrap(. ~ rates, scales = \"free_y\") +\n    labs(\n        x = NULL, y = NULL,\n        title = \"Histórico de Taxas de Juros de 10 Anos\",\n        subtitle = \"Americanos (r_USD_us_10y) e Brasileiro (r_BRL_10y)\",\n        caption = \"wilsonfreitas\"\n    ) +\n    scale_y_continuous(labels = scales::percent) +\n    theme(legend.position = \"none\")"
  },
  {
    "objectID": "posts/2022-06-10-histrico-de-taxas-de-juros-em-dlar-no-brasil/histrico-de-taxas-de-juros-em-dlar-no-brasil.html",
    "href": "posts/2022-06-10-histrico-de-taxas-de-juros-em-dlar-no-brasil/histrico-de-taxas-de-juros-em-dlar-no-brasil.html",
    "title": "Histórico de Taxas de Juros em Dólar no Brasil",
    "section": "",
    "text": "Em um post recente.\n\nlibrary(Quandl)\n\nyc_all <- Quandl(\"USTREASURY/YIELD\")\n\n\n\nLoading required package: xts\n\n\nLoading required package: zoo\n\n\n\nAttaching package: 'zoo'\n\n\nThe following objects are masked from 'package:base':\n\n    as.Date, as.Date.numeric\n\n\n\nlibrary(rb3)\nlibrary(bizdays)\nlibrary(tidyverse)\nlibrary(fixedincome)\n\n\ndusd <- yc_usd_mget(\n  first_date = \"2019-01-01\",\n  last_date = preceding(Sys.Date() - 1, \"Brazil/ANBIMA\"),\n  cache_folder = \"../../../rb3-data\"\n)\n\n\nunique(dusd$refdate) |> map(function(date, df) {\n  df_curve <- df |>\n    filter(refdate == date, cur_days > 0) |>\n    filter(!duplicated(cur_days))\n  curve <- spotratecurve(\n    df_curve$r_360,\n    df_curve$cur_days,\n    \"simple\", \"actual/360\", \"actual\",\n    refdate = date\n  )\n  interpolation(curve) <- interp_flatforward()\n  curve\n}, df = dusd) -> curves_usd\n\n\ncurves_usd |>\n  map_dfr(\\(x) tibble(\n    refdate = x@refdate,\n    r_USD_br_10y = as.numeric(x[[3600]])\n  )) -> rates_usd_10y\n\n\nyc_all |>\n  rename(refdate = \"Date\", r_USD_us_10y = `10 YR`) |>\n  left_join(rates_usd_10y, by = \"refdate\") |>\n  tidyr::pivot_longer(c(r_USD_br_10y, r_USD_us_10y),\n    names_to = \"rates\"\n  ) |>\n  ggplot(aes(x = refdate, y = value, colour = rates)) +\n  geom_line() +\n  labs(colour = NULL) +\n  theme(legend.position = \"bottom\") +\n  labs(\n    x = NULL, y = NULL,\n    title = \"Histórico de Taxas de Juros em Dólar de 10 Anos\",\n    subtitle = \"Estados Unidos (r_USD_us_10y) e Brasil (r_USD_br_10y)\",\n    caption = \"wilsonfreitas\"\n  ) +\n  scale_y_continuous(labels = scales::percent) +\n  theme(legend.position = \"bottom\")\n\nWarning: Removed 7256 rows containing missing values (`geom_line()`)."
  },
  {
    "objectID": "posts/2022-06-18-16-anos-de-curva-prefixada/16-anos-de-curva-prefixada.html",
    "href": "posts/2022-06-18-16-anos-de-curva-prefixada/16-anos-de-curva-prefixada.html",
    "title": "16 anos de Curva Prefixada",
    "section": "",
    "text": "library(rb3)\nlibrary(bizdays)\n\n\nAttaching package: 'bizdays'\n\n\nThe following object is masked from 'package:stats':\n\n    offset\n\nlibrary(dplyr)\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\nlibrary(fixedincome)\n\n\nAttaching package: 'fixedincome'\n\n\nThe following objects are masked from 'package:dplyr':\n\n    first, last\n\nlibrary(ggplot2)\n\n\n\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/080e2cb9e1e3eb735c8d6dc0c3194e86-parsed.rds that returns NULL.\n\n\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/1510e962a774e004d248683fd79b1374-parsed.rds that returns NULL.\n\n\n⠙ Fetching data points 199/4054 | ■■                                 5% | ETA: …\n\n\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/d8595c0a5e74dbf205b6146dcfd9ba03-parsed.rds that returns NULL.\n\n\n⠙ Fetching data points 199/4054 | ■■                                 5% | ETA: …\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/18d6b35dd6d2aeb821e9fd9aa07dbc00-parsed.rds that returns NULL.\n⠙ Fetching data points 199/4054 | ■■                                 5% | ETA: …\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/a4320cd9f9477bf8e373e3b6ae21374c-parsed.rds that returns NULL.\n⠙ Fetching data points 199/4054 | ■■                                 5% | ETA: …\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/7b3f5d9f3c7f40d438cfb10527e854b3-parsed.rds that returns NULL.\n⠙ Fetching data points 199/4054 | ■■                                 5% | ETA: …\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/427f326863e9f7e25213268f6330a79e-parsed.rds that returns NULL.\n⠙ Fetching data points 199/4054 | ■■                                 5% | ETA: …\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/1dcfe447ea262e7a22e5e30b1a90ee3a-parsed.rds that returns NULL.\n⠙ Fetching data points 199/4054 | ■■                                 5% | ETA: …\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/96156a38c615d754cc941aa54a434f51-parsed.rds that returns NULL.\n⠙ Fetching data points 199/4054 | ■■                                 5% | ETA: …\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/6c4930212718a60fa6a9094d8c2461a2-parsed.rds that returns NULL.\n⠙ Fetching data points 199/4054 | ■■                                 5% | ETA: …\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/1adc35776bcd63801ee57ce3f8f65667-parsed.rds that returns NULL.\n⠙ Fetching data points 199/4054 | ■■                                 5% | ETA: …\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/99ea0e88b0cc34c835f52cdd0049a999-parsed.rds that returns NULL.\n⠙ Fetching data points 199/4054 | ■■                                 5% | ETA: …\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/479f5927bd05578ed52ef2629cab7056-parsed.rds that returns NULL.\n⠙ Fetching data points 199/4054 | ■■                                 5% | ETA: …\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/631a5c5accec13616555c0a78a9aa7f2-parsed.rds that returns NULL.\n⠙ Fetching data points 199/4054 | ■■                                 5% | ETA: …\n⠸ Fetching data points 754/4054 | ■■■■■■■                           19% | ETA: …\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/dcd47b0a844e38db6b61b9b63c22f6a3-parsed.rds that returns NULL.\n⠸ Fetching data points 754/4054 | ■■■■■■■                           19% | ETA: …\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/60d4032989dff49ad0d0c1c9076aff1a-parsed.rds that returns NULL.\n⠸ Fetching data points 754/4054 | ■■■■■■■                           19% | ETA: …\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/5674c7c054b857c8627674b061592516-parsed.rds that returns NULL.\n⠸ Fetching data points 754/4054 | ■■■■■■■                           19% | ETA: …\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/4faa28330b3585f9be27a543dea59d86-parsed.rds that returns NULL.\n⠸ Fetching data points 754/4054 | ■■■■■■■                           19% | ETA: …\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/f7646668172c0f4a610906fa21a2751c-parsed.rds that returns NULL.\n⠸ Fetching data points 754/4054 | ■■■■■■■                           19% | ETA: …\n⠼ Fetching data points 1058/4054 | ■■■■■■■■■                         26% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/c8c023431cc0d19c3c95942d3a27b73a-parsed.rds that returns NULL.\n⠼ Fetching data points 1058/4054 | ■■■■■■■■■                         26% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/134bc1ec7d0a352b48354d5af68038f0-parsed.rds that returns NULL.\n⠼ Fetching data points 1058/4054 | ■■■■■■■■■                         26% | ETA:…\n⠴ Fetching data points 1364/4054 | ■■■■■■■■■■■                       34% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/117745dce5d5cb4d890e2230f5cca206-parsed.rds that returns NULL.\n⠴ Fetching data points 1364/4054 | ■■■■■■■■■■■                       34% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/68a26da34d9f76552f0305d314d843ef-parsed.rds that returns NULL.\n⠴ Fetching data points 1364/4054 | ■■■■■■■■■■■                       34% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/c465388767a41742d3153041e2aa95f4-parsed.rds that returns NULL.\n⠴ Fetching data points 1364/4054 | ■■■■■■■■■■■                       34% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/2b1a1b2e121587ad6e9c4d8bf75a69b3-parsed.rds that returns NULL.\n⠴ Fetching data points 1364/4054 | ■■■■■■■■■■■                       34% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/03111a15447935a196fccedf36243f1e-parsed.rds that returns NULL.\n⠴ Fetching data points 1364/4054 | ■■■■■■■■■■■                       34% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/199c548401f10e0252e2bef33605625a-parsed.rds that returns NULL.\n⠴ Fetching data points 1364/4054 | ■■■■■■■■■■■                       34% | ETA:…\n⠦ Fetching data points 1652/4054 | ■■■■■■■■■■■■■                     41% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/ae8212a0126585478946aa8eaa3c897d-parsed.rds that returns NULL.\n⠦ Fetching data points 1652/4054 | ■■■■■■■■■■■■■                     41% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/769bdbf6414d30e8695c2559b04f9313-parsed.rds that returns NULL.\n⠦ Fetching data points 1652/4054 | ■■■■■■■■■■■■■                     41% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/2493a7b1b75c928059789157a2afaed6-parsed.rds that returns NULL.\n⠦ Fetching data points 1652/4054 | ■■■■■■■■■■■■■                     41% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/4814b715cfe7655e14c1569734485b13-parsed.rds that returns NULL.\n⠦ Fetching data points 1652/4054 | ■■■■■■■■■■■■■                     41% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/d6a37e4f3970da2216baeeade0e9b962-parsed.rds that returns NULL.\n⠦ Fetching data points 1652/4054 | ■■■■■■■■■■■■■                     41% | ETA:…\n⠧ Fetching data points 1892/4054 | ■■■■■■■■■■■■■■■                   47% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/41aa4082eeec395b7feb3a956bfb1a87-parsed.rds that returns NULL.\n⠧ Fetching data points 1892/4054 | ■■■■■■■■■■■■■■■                   47% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/ced216837f9da99582aadad11ca0773d-parsed.rds that returns NULL.\n⠧ Fetching data points 1892/4054 | ■■■■■■■■■■■■■■■                   47% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/be44ed0ec4186fc2fafdb47cc9614e87-parsed.rds that returns NULL.\n⠧ Fetching data points 1892/4054 | ■■■■■■■■■■■■■■■                   47% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/a2a2abdbb71c86a1941da637bda10f45-parsed.rds that returns NULL.\n⠧ Fetching data points 1892/4054 | ■■■■■■■■■■■■■■■                   47% | ETA:…\n⠇ Fetching data points 2146/4054 | ■■■■■■■■■■■■■■■■■                 53% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/f80d336c7034dca6d280d5300621956a-parsed.rds that returns NULL.\n⠇ Fetching data points 2146/4054 | ■■■■■■■■■■■■■■■■■                 53% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/1921f576fd77dc68dcc361d921f7d33f-parsed.rds that returns NULL.\n⠇ Fetching data points 2146/4054 | ■■■■■■■■■■■■■■■■■                 53% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/56ea48877c8a76f9400c87be31f8028e-parsed.rds that returns NULL.\n⠇ Fetching data points 2146/4054 | ■■■■■■■■■■■■■■■■■                 53% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/3a377df9574995fcea76277cf66229a4-parsed.rds that returns NULL.\n⠇ Fetching data points 2146/4054 | ■■■■■■■■■■■■■■■■■                 53% | ETA:…\n⠏ Fetching data points 2382/4054 | ■■■■■■■■■■■■■■■■■■■               59% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/fbfb62bc5bf85827f6a379f1f90ef457-parsed.rds that returns NULL.\n⠏ Fetching data points 2382/4054 | ■■■■■■■■■■■■■■■■■■■               59% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/f167df23f63004a18ce9b42308f40f82-parsed.rds that returns NULL.\n⠏ Fetching data points 2382/4054 | ■■■■■■■■■■■■■■■■■■■               59% | ETA:…\n⠋ Fetching data points 2662/4054 | ■■■■■■■■■■■■■■■■■■■■■             66% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/125bfbd76261eb5f9fb51caa162ff9d4-parsed.rds that returns NULL.\n⠋ Fetching data points 2662/4054 | ■■■■■■■■■■■■■■■■■■■■■             66% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/1ebdf89b3c235780cffb64e60a8ef85a-parsed.rds that returns NULL.\n⠋ Fetching data points 2662/4054 | ■■■■■■■■■■■■■■■■■■■■■             66% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/26bd082dfaf44bac451a55a5662a2fd6-parsed.rds that returns NULL.\n⠋ Fetching data points 2662/4054 | ■■■■■■■■■■■■■■■■■■■■■             66% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/fa3875cac6688b226e699f5d1be8316e-parsed.rds that returns NULL.\n⠋ Fetching data points 2662/4054 | ■■■■■■■■■■■■■■■■■■■■■             66% | ETA:…\n⠙ Fetching data points 2921/4054 | ■■■■■■■■■■■■■■■■■■■■■■■           72% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/9bae55e162e6d8634116689db1ced4de-parsed.rds that returns NULL.\n⠙ Fetching data points 2921/4054 | ■■■■■■■■■■■■■■■■■■■■■■■           72% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/93cedd658d260591bf4b89f2a301d3a6-parsed.rds that returns NULL.\n⠙ Fetching data points 2921/4054 | ■■■■■■■■■■■■■■■■■■■■■■■           72% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/e5e67b76c7684e229e92ebf31defddb0-parsed.rds that returns NULL.\n⠙ Fetching data points 2921/4054 | ■■■■■■■■■■■■■■■■■■■■■■■           72% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/0cb75e7608014434b910d0f6eed469d6-parsed.rds that returns NULL.\n⠙ Fetching data points 2921/4054 | ■■■■■■■■■■■■■■■■■■■■■■■           72% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/60f1cac688426f3548bde90067ff6b57-parsed.rds that returns NULL.\n⠙ Fetching data points 2921/4054 | ■■■■■■■■■■■■■■■■■■■■■■■           72% | ETA:…\n⠹ Fetching data points 3197/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■         79% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/120615d3cc3e40c40f3da1bc530ee976-parsed.rds that returns NULL.\n⠹ Fetching data points 3197/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■         79% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/efd149e6dea0edb26cab44371a11bd9c-parsed.rds that returns NULL.\n⠹ Fetching data points 3197/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■         79% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/89377ffb8213ffc3f60c414db22f5194-parsed.rds that returns NULL.\n⠹ Fetching data points 3197/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■         79% | ETA:…\n⠸ Fetching data points 3494/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■       86% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/d025aaaff9277d60fad129c2a947d288-parsed.rds that returns NULL.\n⠸ Fetching data points 3494/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■       86% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/e3685c842eb0d208cb90f72e16d525a7-parsed.rds that returns NULL.\n⠸ Fetching data points 3494/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■       86% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/97177d9d007efd4de20b3ce969ced4cb-parsed.rds that returns NULL.\n⠸ Fetching data points 3494/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■       86% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/42878d933ac57df3374a4bafbd048175-parsed.rds that returns NULL.\n⠸ Fetching data points 3494/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■       86% | ETA:…\n⠼ Fetching data points 3752/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■     93% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/2b812e5506888e8c931cb540ae305b09-parsed.rds that returns NULL.\n⠼ Fetching data points 3752/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■     93% | ETA:…\n! Removed cached file C:/Users/wilso/R/rb3-cache/AjustesDiarios/55ca03ce272d07db0c5ac475424add1a-parsed.rds that returns NULL.\n⠼ Fetching data points 3752/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■     93% | ETA:…\n\n\nWarning: Automatic coercion from double to character was deprecated in purrr 1.0.0.\nℹ Please use an explicit call to `as.character()` within `map_chr()` instead.\nℹ The deprecated feature was likely used in the rb3 package.\n  Please report the issue at <https://github.com/wilsonfreitas/rb3/issues>.\n\n\n⠴ Fetching data points 3931/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■    97% | ETA:…\n⠦ Fetching data points 3938/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■    97% | ETA:…\n⠧ Fetching data points 3945/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■    97% | ETA:…\n⠇ Fetching data points 3950/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■    97% | ETA:…\n⠏ Fetching data points 3956/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■    98% | ETA:…\n⠋ Fetching data points 3962/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■    98% | ETA:…\n⠙ Fetching data points 3968/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■    98% | ETA:…\n⠹ Fetching data points 3973/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■    98% | ETA:…\n⠸ Fetching data points 3979/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■    98% | ETA:…\n⠼ Fetching data points 3985/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■    98% | ETA:…\n⠴ Fetching data points 3991/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■   98% | ETA:…\n⠦ Fetching data points 3997/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■   99% | ETA:…\n⠧ Fetching data points 4003/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■   99% | ETA:…\n⠇ Fetching data points 4009/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■   99% | ETA:…\n⠏ Fetching data points 4014/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■   99% | ETA:…\n! Removed C:\\Users\\wilso\\R\\rb3-cache/AjustesDiarios/8efc8696de8165690ea4be9abff3bfe8.html - It hasn't valid content.\n⠏ Fetching data points 4014/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■   99% | ETA:…\n⠋ Fetching data points 4020/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■   99% | ETA:…\n⠙ Fetching data points 4026/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■   99% | ETA:…\n⠹ Fetching data points 4032/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■   99% | ETA:…\n⠸ Fetching data points 4037/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■  100% | ETA:…\n⠼ Fetching data points 4042/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■  100% | ETA:…\n⠴ Fetching data points 4048/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■  100% | ETA:…\n⠦ Fetching data points 4053/4054 | ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■  100% | ETA:…\n\n\nO pacote {rb3} faz extrações de dados do site da B3. Temos diversas informações disponíveis no site inclusive o histórico de diversos dados.\nUm conjunto de dados que mais utilizo são os preços de ajuste dos contratos futuros. Este histórico é um dos mais antigos disponível.\nVou baixar todo o histórico de contratos futuros desde 2007. A partir dos preços de ajuste é possível construir o histórico de curvas prefixadas. Depois vou fazer uma segmentação pelo ano da data de referência para que seja possível visualizar, para cada ano, todo o espectro de curvas no ano.\nVou começar baixando todos os dados desde 2007 até a última data disponível. Para isso vou utilizar a função rb3::futures_mget. Isso leva um bom tempo!\n\ndf <- futures_mget(\n  first_date = \"2007-01-01\",\n  last_date = preceding(Sys.Date() - 1, \"Brazil/ANBIMA\")\n)\n\nÉ necessário filtrar os contratos futuros de DI1 para construir a curva prefixada.\n\ndf_di1 <- df |> filter(commodity == \"DI1\")\n\nPara construir a curva prefixada é necessário obter as datas de vencimento dos contratos futuros. Para isso utilizo a função rb3::maturity2date que converte o código de vencimento em data. Adicionalmente faço o ajuste da data de referência criando a coluna fixing, calculo os dias úteis (coluna business_days) e a taxa de juros com base no preço de ajuste price gerando a coluna adjusted_tax.\n\ndf_di1_futures <- df_di1 |>\n  mutate(\n    maturity_date = maturity2date(maturity_code),\n    fixing = following(maturity_date, \"Brazil/ANBIMA\"),\n    business_days = bizdays(refdate, fixing, \"Brazil/ANBIMA\"),\n    adjusted_tax = implied_rate(\"discrete\", business_days / 252, 100000 / price)\n  ) |>\n  filter(business_days > 0)\n\nTermino filtrando as linhas com business_days maior que zero, pois não me interessam os futuros na data de vencimento.\nAgora vamos gerar a visualização com ggplot2.\n\ndf_di1_futures |>\n  mutate(year = as.integer(format(refdate, \"%Y\"))) |>\n  ggplot(aes(\n    x = business_days, y = adjusted_tax,\n    group = refdate\n  )) +\n  geom_line(alpha = 0.2) +\n  facet_wrap(. ~ year) +\n  labs(\n    x = \"Dias Úteis\", y = \"Taxas\",\n    title = \"16 anos de Curva Prefixada\",\n    subtitle = \"Curvas construídas a partir dos preços de ajuste dos contratos Futuros DI1\",\n    caption = \"Fonte: B3 (obtidos com \\U1F4E6 rb3) - wilsonfreitas\"\n  ) +\n  scale_y_continuous(labels = scales::percent)\n\n\n\n\nCurioso ver a mudança de shape da curva entre os anos e ao longo de cada ano. Uma coisa curiosa é observar os anos de 2016, 2017 e 2018. 2016/2017 foram os anos do impechemant da presidente Dilma. Em 2016 a parte curta da curva variou pouco e a parte longa variou muito. Em 2017 aconteceu o oposto, a parte curta da curva variou mais que a parte longa da curva. Nestes anos, as mudanças afetam diretamente o shape da curva. Em 2018, o ano da eleição e da facada do Bolsonaro, há uma grande variação na parte longa da curva, mas sem alterar o shape da curva. Ainda é possível avaliar o comportamento da curva com os demais eventos políticos e econômicos. Em 2021, por exemplo, onde ocorreu uma elevação da taxa SELIC e uma piora do cenário fiscal, temos um espectro muita amplo do shape da curva.\nÉ possível construir uma visualização equivalente utilizando dados da curva americana que podem ser obtidos com o pacote Quandl.\n\nlibrary(Quandl)\n\nyc_all <- Quandl(\"USTREASURY/YIELD\")\n\n\n\nLoading required package: xts\n\n\nLoading required package: zoo\n\n\n\nAttaching package: 'zoo'\n\n\nThe following objects are masked from 'package:base':\n\n    as.Date, as.Date.numeric\n\n\n\nAttaching package: 'xts'\n\n\nThe following objects are masked from 'package:fixedincome':\n\n    first, last\n\n\nThe following objects are masked from 'package:dplyr':\n\n    first, last\n\n\nOs dados vem no formato wide onde cada coluna representa um vértice e cada linha uma curva. Dessa maneira, faço a conversão dos dados para o formato longo com a função tidyr::pivot_longer.\n\nyc_all <- as_tibble(yc_all)\n\nyc_all_longer <- yc_all |>\n  tidyr::pivot_longer(cols = `1 MO`:`30 YR`)\n\nyc_all_longer\n\n# A tibble: 99,480 × 3\n   Date       name  value\n   <date>     <chr> <dbl>\n 1 2023-02-17 1 MO   4.64\n 2 2023-02-17 2 MO   4.81\n 3 2023-02-17 3 MO   4.84\n 4 2023-02-17 6 MO   4.99\n 5 2023-02-17 1 YR   5   \n 6 2023-02-17 2 YR   4.6 \n 7 2023-02-17 3 YR   4.33\n 8 2023-02-17 5 YR   4.03\n 9 2023-02-17 7 YR   3.95\n10 2023-02-17 10 YR  3.82\n# … with 99,470 more rows\n\n\nAqui faço o tratamento dos dados para converter os prazos em números, considerando meses de 30 dias e anos de 360 dias.\n\nlibrary(stringr)\n\nn <- str_match(yc_all_longer$name, \"\\\\d+\") |> as.numeric()\np <- str_match(yc_all_longer$name, \"(MO|YR)$\")[, 1]\nyc_all_longer$days <- ifelse(p == \"MO\", 30, 360) * n\n\nyc_all_longer\n\n# A tibble: 99,480 × 4\n   Date       name  value  days\n   <date>     <chr> <dbl> <dbl>\n 1 2023-02-17 1 MO   4.64    30\n 2 2023-02-17 2 MO   4.81    60\n 3 2023-02-17 3 MO   4.84    90\n 4 2023-02-17 6 MO   4.99   180\n 5 2023-02-17 1 YR   5      360\n 6 2023-02-17 2 YR   4.6    720\n 7 2023-02-17 3 YR   4.33  1080\n 8 2023-02-17 5 YR   4.03  1800\n 9 2023-02-17 7 YR   3.95  2520\n10 2023-02-17 10 YR  3.82  3600\n# … with 99,470 more rows\n\n\nAgora fazemos a visualização.\n\nyc_all_longer |>\n  mutate(\n    year = as.integer(format(Date, \"%Y\")),\n    value = value / 100\n  ) |>\n  filter(year >= 2007) |>\n  ggplot(aes(\n    x = days, y = value,\n    group = Date\n  )) +\n  geom_line(alpha = 0.2) +\n  facet_wrap(. ~ year) +\n  labs(\n    x = \"Dias Corridos\", y = \"Taxas\",\n    title = \"16 anos de Curva Prefixada Americana\",\n    caption = \"Fonte: US Treasury (obtidos com \\U1F4E6 Quandl) - wilsonfreitas\"\n  ) +\n  scale_y_continuous(labels = scales::percent)\n\n\n\n\nJá na curva americana, a dinâmica é muito mais bem comportada. A parte longo costuma oscilar, mas mantendo a dinâmica. Os anos 2007, 2008 e 2020, onde tivemos crise do subprime e COVID, trouxeram mais volatilidade."
  },
  {
    "objectID": "posts/2022-06-19-super-datasets-do-pacote-rb3/super-datasets-do-pacote-rb3.html",
    "href": "posts/2022-06-19-super-datasets-do-pacote-rb3/super-datasets-do-pacote-rb3.html",
    "title": "Super Datasets do Pacote rb3",
    "section": "",
    "text": "A versão 0.0.3 do pacote {rb3} trouxe funções que retornam super datasets. Estes super datasets são dataframes com dados organizados para um fim específico. Por exemplo, a função rb3::yc_get retorna um dataframe com dados da curva de juros para diversos vértices, dentre os vértices retornados alguns são referentes aos vencimentos dos contratos futuros utilizados para produzir a curva original. Para alguns problemas é interessante conhecer quais vértices são referentes aos futuros, por exemplo, na criação de fatores primitivos de risco, onde a interpolação deve ser realizada utilizando apenas os futuros. Os contratos futuros podem ser obtidos com a função rb3::futures_get. Dessa maneira, a função rb3::yc_superset junta os dados retornados pelas funções rb3::yc_get e rb3::futures_get identificando os vencimentos dos contratos futuros na curva de juros. Por isso super dataset, é um dataset mais rico!\nAtualmente o pacote apresenta as seguintes funções superset:\n\nrb3::yc_superset retorna a curva de juros de prefixados com os contratos fututos DI1 identificados.\nrb3::yc_usd_superset retorna a curva de cupom cambial com os contratos fututos DOL identificados.\nrb3::yc_ipca_superset retorna a curva de juros reais com os contratos fututos DAP identificados.\nrb3::cotahist_equity_options_superset retorna dados de opções de ações com informações de ações e taxas de juros.\n\nVou exemplificar a utilização de um super dataset com a função rb3::yc_superset. Vou criar uma curva de juros apenas com os contratos futuros de DI1. Mas antes vou responder uma pergunta que talvez tenha chegado a cabeça dos leitores: Por que criar uma curva de juros apenas com os contratos futuros se já tenho uma curva de juros cheia de vértices? Primeiramente, toda curva de juros nasce a partir de um conjunto de contratos, no caso da curva prefixada utiliza-se os contratos futuros DI1, mais a taxa DI no vértice de 1 dia útil, assim, estaria retornando a curva ao seu estado original. Logo, todos os demais vértices da curva são obtidos a partir da interpolação entre os contratos futuros. Adicionalmente, caso eu precise de um vértice que não está na curva será necessário interpolar e como interpolar se não conheço os vértices referentes aos futuros? Bem, posso interpolar nos vértices presentes, mas assim estaria interpolando sobre vértices interpolados. Não é um grande problema fazer isso, mas isso pode trazer problemas na contrução de fatores de risco para taxa de juros, por exemplo.\nDando sequência, primeiro utilizamos o {rb3} para obter os dados dos futuros e da curva para a data de referência.\n\nlibrary(rb3)\n\nrefdate <- \"2022-06-17\"\n\nfut <- futures_get(refdate)\nyc <- yc_get(refdate)\n\nDepois passo estes dados para a função yc_superset que junta os dados para indentificar os contratos futuros.\n\ndf <- yc_superset(yc, fut)\ndf |> head()\n\n# A tibble: 6 × 7\n  refdate    cur_days biz_days forward_date r_252 r_360 symbol\n  <date>        <int>    <dbl> <date>       <dbl> <dbl> <chr> \n1 2022-06-17        3        1 2022-06-20   0.132 0     <NA>  \n2 2022-06-17        7        5 2022-06-24   0.132 0.134 <NA>  \n3 2022-06-17       12        8 2022-06-29   0.132 0.125 <NA>  \n4 2022-06-17       13        9 2022-06-30   0.132 0.13  <NA>  \n5 2022-06-17       14       10 2022-07-01   0.132 0.134 DI1N22\n6 2022-06-17       21       15 2022-07-08   0.132 0.134 <NA>  \n\n\nTendo o super dataset eu filtro as linhas referentes aos futuros e a linha referente a 1 dia útil.\n\nlibrary(dplyr)\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\ndf_curve <- bind_rows(\n  df |> filter(biz_days == 1) |> select(biz_days, r_252),\n  df |> filter(!is.na(symbol)) |> select(biz_days, r_252)\n)\n\ndf_curve |> head()\n\n# A tibble: 6 × 2\n  biz_days r_252\n     <dbl> <dbl>\n1        1 0.132\n2       10 0.132\n3       31 0.132\n4       54 0.133\n5       75 0.134\n6       95 0.134\n\n\nPronto! Tenho a curva original novamente.\nApenas para ilustrar, vamos utilizar o pacote {fixedincome} para construir um objeto de curva de juros e visualizar os dados.\n\nlibrary(fixedincome)\n\n\nAttaching package: 'fixedincome'\n\n\nThe following objects are masked from 'package:dplyr':\n\n    first, last\n\ncurve <- spotratecurve(\n  df_curve$r_252, df_curve$biz_days, \"discrete\", \"business/252\", \"Brazil/ANBIMA\",\n  refdate = as.Date(refdate)\n)\n\nVisualizando a curva.\n\nggspotratecurveplot(curve)\n\n\n\n\nVisualizando para um horizonte mais curto e adicionando as taxas a termo.\n\ncurve_2y <- curve |> fixedincome::first(\"2 years\")\nggspotratecurveplot(curve_2y) +\n  ggplot2::autolayer(forwardrate(curve_2y))\n\n\n\n\nBem, os super datasets estão aí para ajudar! Entregam dados da B3 mais mastigados para as necessidades dos quants do mercado brasileiro."
  },
  {
    "objectID": "posts/2022-06-24-super-datasets-para-opcoes-de-acoes/super-datasets-para-opcoes-de-acoes.html",
    "href": "posts/2022-06-24-super-datasets-para-opcoes-de-acoes/super-datasets-para-opcoes-de-acoes.html",
    "title": "Super Datasets para Opções de Ações",
    "section": "",
    "text": "Dados de opções de ações finalmente disponíveis de forma simples e direta. Durante muito tempo busquei isso, os dados de opções são mais chatos pois precisam de outros dados para a realização dos cálculos. Ter apenas os dados de prêmio das opções (preços das opções) não permite que diversas das medidas de interesse associadas a opções, como as gregas e a volatilidade implícita, sejam calculadas. Utilizando Black & Scholes é necessário ainda ter o preço do ativo objeto (preço da ação) e as taxas de juros. Com estas informações é possível calcular a volatilidade e a partir daí todas as demais medidas de interesse podem ser calculadas.\nVou mostrar aqui como calcular a volatilidade e as gregas para opções a partir de dados obtidos com o pacote {rb3}. Para realizar os cálculos com as opções eu utilizo o pacote {oplib} que desenvolvi com diversos modelos implementados:\n\nBlack, Scholes & Merto para apreçamento das opções\nBlack para apreçamento de opções sobre futuros, utilizado em opções sobre índices de taxas de juros, como IDI\nCorrado-Su para o apreçamento de opções considerando assimetria e curtose\nentre outros\n\nEste pacote ainda é experimental, não está publicado no CRAN e a documentação ainda está em desenvolvimento.\nVamos começar carregando os pacotes\n\nlibrary(rb3)\nlibrary(bizdays)\n\n\nAttaching package: 'bizdays'\n\n\nThe following object is masked from 'package:stats':\n\n    offset\n\nlibrary(tidyverse)\n\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2\n──\n\n\n✔ ggplot2 3.4.1     ✔ purrr   1.0.1\n✔ tibble  3.1.8     ✔ dplyr   1.1.0\n✔ tidyr   1.3.0     ✔ stringr 1.5.0\n✔ readr   2.1.4     ✔ forcats 1.0.0\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n\nlibrary(oplib)\n\nVamos selecionar o último dia útil para obter os dados diários do arquivo COTAHIST disponibilizado pela B3. O arquivo COTAHIST traz diversas informações do mercado de ações e inclui as opções. Adicionalmente, precisamos das taxas de juros e utilizo a função rb3::yc_get para obter a curva de juros para a data de referência.\n\nrefdate <- preceding(\"2022-06-24\", \"Brazil/ANBIMA\")\nch <- cotahist_get(refdate, \"daily\")\nyc <- yc_get(refdate)\n\nCom os dados de ações e opções, pelo arquivo COTAHIST, e com as taxas de juros, utilizo a função rb3::cotahist_options_by_symbol_superset para obter os dados de opções para um símbolo específico. Aqui vou utilizar PETR4 que é uma das ações com maior volume de negociação na bolsa.\n\nsymbol_ <- \"PETR4\"\nop1 <- cotahist_options_by_symbol_superset(symbol_, ch, yc)\n\nNo data.frame op1 temos informações de preço da ação na data de referência, preços das opções, taxas de juros, vencimento das opções, volumes de negociação e diversas outras informações.\n\nop1\n\n# A tibble: 437 × 28\n   refdate    symbol   type  strike maturity_d…¹  open  high   low close average\n   <date>     <chr>    <fct>  <dbl> <date>       <dbl> <dbl> <dbl> <dbl>   <dbl>\n 1 2022-06-24 PETRA140 Call    1.94 2023-01-20   24.8  24.8  24.8  24.8    24.8 \n 2 2022-06-24 PETRA239 Call   50.4  2023-01-20    0.09  0.24  0.09  0.23    0.15\n 3 2022-06-24 PETRA281 Call   18.4  2023-01-20    9.6   9.6   9.6   9.6     9.6 \n 4 2022-06-24 PETRA297 Call   30.2  2023-01-20    2.7   2.7   2.7   2.7     2.7 \n 5 2022-06-24 PETRA359 Call   29.4  2023-01-20    2.87  2.87  2.87  2.87    2.87\n 6 2022-06-24 PETRA361 Call   26.4  2023-01-20    4.3   4.3   4.23  4.23    4.24\n 7 2022-06-24 PETRD450 Call   38.4  2023-04-20    1.42  1.42  1.42  1.42    1.42\n 8 2022-06-24 PETRG1   Call   13.4  2022-07-15   13.7  13.7  12.6  12.6    13.6 \n 9 2022-06-24 PETRG121 Call   19.2  2022-07-15    7.87  7.87  7.36  7.37    7.79\n10 2022-06-24 PETRG178 Call   20.2  2022-07-15    6.7   6.7   6.45  6.45    6.45\n# … with 427 more rows, 18 more variables: volume <dbl>,\n#   traded_contracts <dbl>, transactions_quantity <int>, distribution_id <int>,\n#   symbol.underlying <chr>, open.underlying <dbl>, high.underlying <dbl>,\n#   low.underlying <dbl>, close.underlying <dbl>, average.underlying <dbl>,\n#   best_bid <dbl>, best_ask <dbl>, volume.underlying <dbl>,\n#   traded_contracts.underlying <dbl>, transactions_quantity.underlying <int>,\n#   distribution_id.underlying <int>, fixing_maturity_date <date>, …\n\n\npara simplificar os cálculos vou separar duas informações úteis, os vencimentos das opções e o preço de fechamento da ação, que é único para a data de referência. Os vencimentos das opções são ordenados para que eu possa facilmente selecionar um vencimento desejado.\n\nmaturities <- unique(op1$maturity_date) |> sort()\nclose_underlying <- op1$close.underlying[1]\n\nAs opções de ações, tipicamente, possuem maior liquidez no primeiro vencimento disponível. Por isso, vou selecionar todas as opções com maturity_date == maturities[1].\n\nop_vol <- op1 |>\n  filter(maturity_date == maturities[1]) |>\n  mutate(\n    biz_days = bizdays(\n      refdate, following(maturity_date, \"Brazil/ANBIMA\"), \"Brazil/ANBIMA\"\n    ),\n    time_to_maturity = biz_days / 252,\n    rate = log(1 + r_252),\n    impvol = bsmimpvol(\n      close, type, close.underlying, strike, time_to_maturity, rate, 0\n    ),\n    delta = bsmdelta(\n      type, close.underlying, strike, time_to_maturity, rate, 0, impvol\n    )\n  ) |>\n  select(\n    symbol, volume,\n    type, close.underlying, strike, time_to_maturity, rate, impvol,\n    delta, biz_days, volume\n  )\n\nApós a seleção das opções, uma série de cálculos são realizados para obter:\n\ndias úteis até o vencimento biz_days\nprazo em anos até o vencimento time_to_maturity\ntaxas de juros em capitalização contínua rate\nvolatilidade implícita impvol com o modelo Black & Scholes\na grega delta para o modelo Black & Scholes\n\nEm seguida algumas variáveis são selecionadas para a visualizção dos dados.\nVamos visualizar o smile de volatilidade para com os preços de exercício das opções no eixo X Coloco uma linha vertical marcando o nível do preço do ativo objeto, facilitando a interpretação do que está dentro/fora do dinheiro para as opções de compra e venda (Calls e Puts). O tamanho de cada ponto é definido pelo volumen de negociação de cada opção. Interessante notar que os maiores volumes ficam nos strikes próximos do preço atual do ativo objeto. Estas são as opções ATM, no dinheiro.\n\nop_vol |>\n  filter(!is.na(impvol)) |>\n  ggplot(aes(x = strike, y = impvol, colour = type, size = volume)) +\n  geom_point() +\n  geom_vline(xintercept = close_underlying, alpha = 0.5, size = 1) +\n  facet_wrap(type ~ biz_days) +\n  theme(legend.position = \"bottom\") +\n  labs(\n    x = \"Strike\", y = \"Implied Volatility\",\n    title = str_glue(\"Equity Options Volatility - {symbol_} {format(refdate)}\")\n  )\n\nWarning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.\nℹ Please use `linewidth` instead.\n\n\n\n\n\nAbaixo temos o smile de volatilidade com o delta das opções no eixo X. Aqui fica mais fácil visualizar as opções ATM, pois estas tem delta de 0.5 (ou -0.5 no caso das Puts).\n\nop_vol |>\n  filter(!is.na(impvol)) |>\n  ggplot(aes(x = delta, y = impvol, colour = type, size = volume)) +\n  geom_point() +\n  geom_vline(xintercept = c(-0.5, 0.5), alpha = 0.5, size = 1) +\n  facet_wrap(~ biz_days, scales = \"free\") +\n  theme(legend.position = \"bottom\") +\n  labs(\n    x = \"Delta\", y = \"Implied Volatility\",\n    title = str_glue(\"Equity Options Volatility - {symbol_} {format(refdate)}\")\n  )\n\n\n\n\nO objetivo deste post é mostrar como é fácil obter dados de opções com o pacote {rb3} e com o pacote {oplib} realizar os cálculos com estes dados."
  },
  {
    "objectID": "posts/2022-08-17-movimento-da-parte-longa-da-curva-de-juros/movimento-da-parte-longa-da-curva-de-juros.html",
    "href": "posts/2022-08-17-movimento-da-parte-longa-da-curva-de-juros/movimento-da-parte-longa-da-curva-de-juros.html",
    "title": "Movimento da Parte Longa da Curva de Juros",
    "section": "",
    "text": "A reunião do COPOM de 3 de agosto trouxe uma mudança na estrutura da curva de juros, tanto para a parte curta como para a parte longa. A interpretação do comunicado por agentes de mercado é de o ciclo de alta de juros está próximo do fim.\nNa prática a dinâmica da parte longa da curva de juros foi bastante afetada. Aqui apresento uma animação onde observa-se o movimento da curva de juros nas duas primeiras semanas do mês de agosto de 2022. A reunião do COPOM aconteceu em 3 de agosto. Fica claro pela animação a mudança nas expectativas de longo prazo para a curva.\nVamos utilizar o 📦 {rb3} para obter as curvas e o 📦 {fixedincome} na construção dos gráficos da estrutura a termo de juros. A animação é construida com o 📦 {animation}.\n\nlibrary(fixedincome)\nlibrary(rb3)\nlibrary(bizdays)\n\n\nAttaching package: 'bizdays'\n\n\nThe following object is masked from 'package:stats':\n\n    offset\n\nlibrary(dplyr)\n\n\nAttaching package: 'dplyr'\n\n\nThe following objects are masked from 'package:fixedincome':\n\n    first, last\n\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n\nlibrary(ggplot2)\n\nget_di1_curve <- function(refdate) {\n  fut <- futures_get(refdate)\n  yc <- yc_get(refdate)\n  df <- yc_superset(yc, fut)\n\n  df_curve <- bind_rows(\n    df |> slice(1) |> select(biz_days, r_252),\n    df |> filter(!is.na(symbol)) |> select(biz_days, r_252)\n  ) |>\n    filter(!duplicated(biz_days))\n\n  spotratecurve(\n    df_curve$r_252, df_curve$biz_days, \"discrete\", \"business/252\", \"Brazil/ANBIMA\",\n    refdate = refdate\n  )\n}\n\nVamos obter as curvas para os dias úteis entre 2022-08-01 e 2022-08-16 e colocá-las em uma lista. Na sequência a animação será construída com cada uma das curvas da lista, sendo que a primeira curva tem a cor vermelha e a última tem cor azul, as demais curvas são em cinza. O objetivo é acompanhar a evolução das curvas tendo em destaque o começo e fim.\n\ndates <- bizseq(\"2022-08-01\", \"2022-08-16\", \"Brazil/ANBIMA\")\ncurves <- lapply(seq_along(dates), function(ix) get_di1_curve(dates[ix]))\n\nanim <- animation::saveGIF(\n  {\n    g <- autoplot(curves[[1]], curve.x.axis = \"terms\", colour = \"red\") +\n      autolayer(curves[[1]], curve.geom = \"point\", curve.x.axis = \"terms\", colour = \"red\") +\n      ylim(0.11, 0.14) +\n      theme_bw() +\n      theme(legend.position = \"none\") +\n      labs(\n        x = \"Prazos\", y = NULL, title = \"Curvas de Juros Prefixados DI1\",\n        subtitle = \"Entre as datas 2022-08-01 e 2022-08-16\",\n        caption = \"Desenvolvido por wilsonfreitas / Fonte: B3\"\n      )\n    print(g)\n\n    for(curve in curves[-c(1, length(curves))]) {\n      g <- g + autolayer(curve, curve.x.axis = \"terms\", colour = \"grey\") +\n        autolayer(curve,\n          curve.geom = \"point\", curve.x.axis = \"terms\", colour = \"grey\"\n        )\n      print(g)\n    }\n\n    g <- g + autolayer(curves[[length(curves)]], curve.x.axis = \"terms\", colour = \"blue\") +\n      autolayer(curves[[length(curves)]],\n        curve.geom = \"point\", curve.x.axis = \"terms\", colour = \"blue\"\n      )\n    print(g)\n  },\n  interval = 0.8,\n  ani.height = 400,\n  ani.width = 704\n)\n\nOutput at: animation.gif"
  },
  {
    "objectID": "posts/2022-08-29-dinamica-da-volatilidade-implicita/dinamica-da-volatilidade-implicita.html",
    "href": "posts/2022-08-29-dinamica-da-volatilidade-implicita/dinamica-da-volatilidade-implicita.html",
    "title": "Dinâmica da Volatilidade Implícita",
    "section": "",
    "text": "Há divesos estudos sobre o comportamento das opções e sobre quais fatores são mais importantes para explicar as suas mudanças de preços. Sabemos que, depois do ativo objeto, a volatilidade implícita é a variável que mais influiencia nas variações de preços das opções. Dessa forma, é importante entender como se dão as suas variações, de outra forma, é importante conhecer a sua dinâmica.\nAqui vou carregar o histórico de opções de PETR4 desde o começo de 2022, calcular a volatilidade implícita e o delta para cada uma das opções, e para cada data de referência, selecionar as opções, call e put, mais próximas da data de vencimento e com o delta mais próximo de 50%.\nAssim teremos uma opção, para cada tipo, call e put, em cada data de referência. Dessa maneira, é possível construir uma série temporal de volatilidade implícita por tipo de opção.\nAs opções mais próximas do vencimento (ou primeiro vencimento), apresentam a maior liquidez dentre as opções negociadas. Aqui estamos selecionando o primeiro vencimento até a sua expiração, entretanto, é interessante que seja realizada uma análise da liquidez das opções a medida que se aproximam do vencimento para que uma estratégia de rolagem seja definida. Pois, na medida que o primeiro vencimento se aproxima, a liquidez migra para o segundo vencimento. O desafio é identificar a dinâmica dessa migração. Aqui isso não será levado em consideração, vamos carregar as opções do primeiro vencimento até a sua expiração.\nComeçando com o carregamento de pacotes.\nAs opções são carregadas via o arquivo COTAHIST (rb3::cotahist_get) e as curvas de juro são baixadas do site da B3 na página de Taxas de Referência (rb3::yc_mget).\nVamos utilizar a função rb3::cotahist_options_by_symbol_superset para obter o super dataset para opções de PETR4. De posse do super dataset, os dados de vencimento e taxas de juros são formatados para o cálculo da volatilidade implícita e do delta para todas as opções."
  },
  {
    "objectID": "posts/2022-08-29-dinamica-da-volatilidade-implicita/dinamica-da-volatilidade-implicita.html#dinâmica-da-volatilidade-atm",
    "href": "posts/2022-08-29-dinamica-da-volatilidade-implicita/dinamica-da-volatilidade-implicita.html#dinâmica-da-volatilidade-atm",
    "title": "Dinâmica da Volatilidade Implícita",
    "section": "Dinâmica da Volatilidade ATM",
    "text": "Dinâmica da Volatilidade ATM\nComo todos os cálculos realizados vamos selecionar as opções ATM do primeiro vencimento para cada data de referência. Fazemos uma segmentação dos dados por refdate e para cada chunk selecionamos o primeiro vencimento.\n\nop1 <- op_vol |>\n  split(op_vol$refdate) |>\n  map_dfr(function(df) {\n    first_mat <- df$maturity_date[which.min(df$maturity_date)]\n    filter(df, maturity_date == first_mat)\n  })\n\nO dataframe op1 tem opções call e put, em diversos strikes, para cada data de referência. Agora precisamos selecionar as opções mais próximas do dinheiro, ou seja, as opções com delta mais próximo de 50%. Como há uma diferença de sinal entre opções call e put, vamos calcular as diferenças em valores absolutos do delta em relação ao valor 0.5 (delta = 50%).\n\nop1_atm <- split(op1, op1$refdate) |>\n  map_dfr(function(df) {\n    df_type <- filter(df, type == \"Put\")\n    df1 <- df_type[which.min(abs(abs(df_type$delta) - 0.5)), ]\n\n    df_type <- filter(df, type == \"Call\")\n    df2 <- df_type[which.min(abs(abs(df_type$delta) - 0.5)), ]\n\n    bind_rows(df1, df2)\n  })\n\nO dataframe op1_atm tem, para cada data de referência, 1 call ATM e 1 put ATM.\nVamos visualizar a série temporal de volatilidades implícitas para estas opções.\n\nop1_atm |>\n  ggplot(aes(x = refdate, y = bsm_impvol, colour = type)) +\n  geom_line() +\n  geom_point() +\n  facet_wrap(type ~ .) +\n  labs(\n    x = \"Data\", y = \"Volatilidade Implícita\",\n    title = \"Série Histórica Volatilidade Implícita (ATM) - PETR4\",\n    subtitle = \"Volatilidade implícita de opções com delta mais próximo de 50%\",\n    caption = \"Desenvolvido por wilsonfreitas / Fonte: B3\"\n  ) +\n  theme(legend.position = \"none\")\n\n\n\n\nÉ possível notar que a dinâmica da volatilidade, entre as opções call e put, é bem comportada. Há eventuais momentos de divergência, contudo, o comportamento das duas séries é bastante semelhante. As séries apresentam um forte comportamento de reversão à média, o que é característico desse tipo de variável.\nOutro ponto interessante é verificar quais os preços de exercício para as opções ATM selecionadas. Pois, uma vez que o preço do ativo objeto muda, o delta da opção muda e o preço de exercício que representa o delta também muda.\n\nop1_atm |>\n  ggplot(aes(x = refdate, y = strike, colour = type)) +\n  geom_line() +\n  geom_point(aes(shape = type), size = 3) +\n  labs(\n    x = \"Data\", y = \"Strike\",\n    title = \"Série Histórica Strikes (ATM) - PETR4\",\n    subtitle = \"Preços de exercício de opções com delta mais próximo de 50%\",\n    caption = \"Desenvolvido por wilsonfreitas / Fonte: B3\"\n  ) +\n  theme(legend.position = \"top\", legend.title = element_blank())\n\n\n\n\nAqui as séries são praticamente as mesmas, indicando que as opções ATM, calls e puts, possuem os mesmos strikes. Em poucos pontos há uma diferença nos preços de exercício. É interessante que este ponto seja melhor avaliado e talvez a liquidez das opções ajude a explicar estas diferenças.\nVamos observar os deltas das opções ATM selecionadas. Uma vez que estamos selecionando opções ATM, é interessante que os deltas estejam próximos de 50%. Mas como se dá essa seleção? No gráfico abaixo vemos que os deltas de calls e puts oscilam em torno de 50% e estão sempre próximos entre si, há poquíssimos casos em que o delta da call está acima de 50% e o delta da put está abaixo de 50%. Novamente, cabe uma melhor investigação para melhor compreender os fatores causadores da divergência.\n\nop1_atm |>\n  mutate(delta = ifelse(delta < 0, 1 + delta, delta)) |>\n  ggplot(aes(x = refdate, y = delta, colour = type)) +\n  geom_line() +\n  geom_point() +\n  labs(\n    x = \"Data\", y = \"Delta\",\n    title = \"Série Histórica Deltas (ATM) - PETR4\",\n    subtitle = \"Delta de opções com delta mais próximo de 50%\",\n    caption = \"Desenvolvido por wilsonfreitas / Fonte: B3\"\n  ) +\n  theme(legend.position = \"top\", legend.title = element_blank())\n\n\n\n\nUma vez que construímos as séries temporais para a volatilidade de opções ATM, o próximo passo é modelar essa série. Um problema interessante é comparar essa dinâmica com a volatilidade realizada, talvez separando por cada vencimento. Idealmente a volatilidade implícita deveria convergir para a volatilidade realizada. Outro ponto que ficou em aberto e a avaliação da liquidez e sua consequência na estratégia de rolagem. Aqui estamos selecionando as opções mais próximas do ATM para obter as volatilidades. Uma alternativa é fazer o ajuste de um modelo e obter a volatilidade teórica par um delta de 50%. Em geral, como a liquidez se concentra próximo à vizinhança das opções no dinheiro, há bastante informação nessa região para obter um bom modelo ajustado."
  },
  {
    "objectID": "python.html",
    "href": "python.html",
    "title": "Projetos em Python",
    "section": "",
    "text": "python-bcb é o hermitiano conjugado do rbcb. Nessa de usar R e Python o trabalho acaba sendo duplicado, mas faz parte!\n\nRepositório\nSite"
  },
  {
    "objectID": "python.html#bizdays",
    "href": "python.html#bizdays",
    "title": "Projetos em Python",
    "section": "bizdays📦",
    "text": "bizdays📦\nbizdays é um pacote para contagem de dias úteis. Foi originalmente escrito em R e depois foi portado para Python.\nHoje tem muito mais do que dias úteis:\n\ncalcula dias úteis entre duas datas, de acordo com um calendário\nverifica se as data são dias úteis\nsoma (subtrai) dias úteis a datas\nconverte de dias úteis para dias corridos\n\ne um pouquinho mais …\n\nRepositório\nSite"
  },
  {
    "objectID": "python.html#textparser",
    "href": "python.html#textparser",
    "title": "Projetos em Python",
    "section": "textparser📦",
    "text": "textparser📦\nUm simples parser de texto baseado em expressões regulares. Frequentemente preciso fazer o parsing de texto em inteiros, decimais, datas, e outros formatos. Isso levava a muita duplicação de código, de forma que criei esse pequeno módulo onde posso centralizar todos os parsers que preciso em uma estrutura que me permite, utilizando expressões regulares, criar uma hierarquia para a realização dos parsers.\n\nRepositório"
  },
  {
    "objectID": "python.html#pricing-brazilian-securities-lecture-notes",
    "href": "python.html#pricing-brazilian-securities-lecture-notes",
    "title": "Projetos em Python",
    "section": "Pricing Brazilian Securities (Lecture Notes)",
    "text": "Pricing Brazilian Securities (Lecture Notes)\nNotas de aula de um curso de pricing de ativos brasileiros totalmente em Python.\n\nJupyter Notebooks\n\nTópicos:\n\nLecture 1\n\nA bit of history\n\nInflation in Brazil\nInterest rates in Brazil\n\nCalendars\nCompounding Regimes\nDI1 Future\nDI x PRE Curve\nInterpolation\nForward Rates\nCOPOM Meetings\n\nLecture 2\n\nFlat-forward interpolation with COPOM Meetings\nTreasury Direct contracts\n\nFloating: LFT\nFixed: LTN, NTN-F\nIndexed: NTN-B, Bullet NTN-B\n\nANBIMA Data\nBootstrap\nNelson-Siegel coeficients ANBIMA\nImplied Inflation\n\nLecture 3\n\nU.S. Dollar Futures - DOL\n\nDollar curve\n\nDI x U.S. Dollar Spread Futures - DDI\n\nDirty DI x U.S. Dollar Spread curve\n\nForward Rate Agreement on DI x U.S. Dollar Spread - FRC\n\nClean DI x U.S. Dollar Spread curve\n\n\nLecture 4\n\nDI x IPCA Spread Futures - DAP\n\nDI x IPCA Spread Curve\n\nIbovespa Futures - IND\n\nDI x Ibovespa Spread Curve\n\nCommodities Futures\n\nCash Settled Live Cattle Futures - BGI\nCash Settled Corn Futures - CCM\n\nDebêntures\n\nFixed Rate\nFloating Rate: CDI+spread, %CDI\nIndexed: IPCA"
  },
  {
    "objectID": "R.html",
    "href": "R.html",
    "title": "Projetos em R",
    "section": "",
    "text": "Os arquivos disponibilizados no mercado financeiro brasileiro são da idade da pedra. Definitivamente não há um padrão, o que torna difícil o trabalho de quem faz análise de dados do mercado financeiro brasileiro. O pacote rb3, ataca este problema criando parsers para todos os arquivos divulgados pela B3. Estes arquivos contem informação de diversos contratos negociados na Bolsa, de onde é possível extrair diversos insumos para análise de negociação e gestão de risco.\n\nRepositório\nSite"
  },
  {
    "objectID": "R.html#fixedincome",
    "href": "R.html#fixedincome",
    "title": "Projetos em R",
    "section": "fixedincome📦",
    "text": "fixedincome📦\n\nfixedincome é um pacote para realizar cálculos de renda fixa. É bastante específico para quem trabalha com finanças. O objetivo é trabalhar com cálculos de envolvendo taxas de juros de forma estruturada e limpa.\n\nRepositório\nSite"
  },
  {
    "objectID": "R.html#copom",
    "href": "R.html#copom",
    "title": "Projetos em R",
    "section": "copom📦",
    "text": "copom📦\n\nNo Brasil, temos as reuniões do COPOM (Comitê de Política Monetária do Banco Central) onde os rumos da política monetária do pais são decididos. As decisões do COPOM, que determinam as taxas de juros de curto prazo, influenciam a dinâmica das curvas de juros. Dessa maneira, é possível extrair da curva de juros as expectativas de mercado das decisões do COPOM.\nAlgumas abordagens são implementadas no pacote copom.\n\nRepositório\nSite"
  },
  {
    "objectID": "R.html#oplib",
    "href": "R.html#oplib",
    "title": "Projetos em R",
    "section": "oplib📦",
    "text": "oplib📦\n\noplib implementa diversos modelos de pricing para opções e cálculo de volatilidade implícita aplicados a opções de ações, índices, moedas e taxas de juros.\n\nRepositório"
  },
  {
    "objectID": "R.html#rbcb",
    "href": "R.html#rbcb",
    "title": "Projetos em R",
    "section": "rbcb📦",
    "text": "rbcb📦\n\nrbcb é mais um pacote R na missão de estruturar os dados utilizados no mercado financeiro brasileiro, neste caso, dados publicados pelo Banco Central do Brasil (BCB) no seu portal de dados abertos. Este pacote baixa as séries divulgadas pelo BCB e disponibiliza em estruturas de dados no R.\n\nRepositório"
  },
  {
    "objectID": "R.html#bizdays",
    "href": "R.html#bizdays",
    "title": "Projetos em R",
    "section": "bizdays📦",
    "text": "bizdays📦\n\nbizdays é um pacote para contagem de dias úteis. Foi originalmente escrito em R e depois foi portado para Python.\nHoje tem muito mais do que dias úteis:\n\ncalcula dias úteis entre duas datas, de acordo com um calendário\nverifica se as data são dias úteis\nsoma (subtrai) dias úteis a datas\nconverte de dias úteis para dias corridos\n\ne um pouquinho mais …\n\nRepositório\nSite"
  },
  {
    "objectID": "R.html#numbersbr",
    "href": "R.html#numbersbr",
    "title": "Projetos em R",
    "section": "numbersBR📦",
    "text": "numbersBR📦\nnumbersBR é um pacote R para fazer validação dos diversos números de identificação existentes no Brasil, como: CPF, CNPJ, …\n\nRepositório"
  },
  {
    "objectID": "R.html#estratégias-de-trading-trading-strategies",
    "href": "R.html#estratégias-de-trading-trading-strategies",
    "title": "Projetos em R",
    "section": "Estratégias de trading (Trading Strategies)",
    "text": "Estratégias de trading (Trading Strategies)\nFui monitor do cursos de Estratégias de Trading do Mestrado Profissional de Finanças Quantitativas da Faculdade de Economia da Fundação Getúlio Vargas.\nFiz um material bem legal nesse curso com apresentações e códigos em R que podem ser encontrados aqui."
  },
  {
    "objectID": "rendafixa.html",
    "href": "rendafixa.html",
    "title": "Renda Fixa usando R",
    "section": "",
    "text": "O curso Renda Fixa usando R se divide em 9 módulos, trazendo uma visão de operações com taxas de juros e regimes de capitalização, definindo conceitos de valor do dinheiro no tempo e valor presente de fluxos de caixa.\nImplementa a construção da estrutura a termo de taxas de juros (ETTJ) e alguns métodos de interpolação de taxas.\nSão apresentadas metodologias de apreçamento de instrumentos de renda fixa pré-fixados, pós-fixados e indexados.\nA teoria será abordada sempre de forma leve e concomitante com exemplos práticos.\nDuração: 09:19:28"
  },
  {
    "objectID": "rendafixa.html#módulo-1-valor-do-dinheiro-no-tempo",
    "href": "rendafixa.html#módulo-1-valor-do-dinheiro-no-tempo",
    "title": "Renda Fixa usando R",
    "section": "Módulo 1: Valor do dinheiro no tempo",
    "text": "Módulo 1: Valor do dinheiro no tempo\nValor presente de um fluxo futuro\n\n\n\nDuração: 00:46:47\n\n\n\n\n\n#\nAula\nDuração\n\n\n\n\n1\nPor que usar R para Renda Fixa?\n20:42\n\n\n2\nOperação Financeira Elementar\n11:12\n\n\n3\nWebscraping da Taxa DI (CDI) no site da B3\n06:26\n\n\n4\nEfeito do Tempo na Capitalização da Taxa de Juros\n08:24"
  },
  {
    "objectID": "rendafixa.html#módulo-2-regimes-de-capitalização",
    "href": "rendafixa.html#módulo-2-regimes-de-capitalização",
    "title": "Renda Fixa usando R",
    "section": "Módulo 2: Regimes de capitalização",
    "text": "Módulo 2: Regimes de capitalização\nTaxas de juros simples Taxas de juros compostos Taxas de juros contínuos\n\n\n\nDuração: 00:52:52\n\n\n\n\n\n#\nAula\nDuração\n\n\n\n\n1\nRegimes de Capitalização\n23:09\n\n\n2\nRegras de Contagem de Dias\n11:00\n\n\n3\nCalendários\n10:03\n\n\n4\nEspecificação da taxa de juros\n08:38"
  },
  {
    "objectID": "rendafixa.html#módulo-3-operações-com-fluxo-de-caixa",
    "href": "rendafixa.html#módulo-3-operações-com-fluxo-de-caixa",
    "title": "Renda Fixa usando R",
    "section": "Módulo 3: Operações com Fluxo de Caixa",
    "text": "Módulo 3: Operações com Fluxo de Caixa\nExemplos de Operações com Fluxo de Caixa TIR (Taxa Interna de Retorno)\n\n\n\nDuração: 00:47:43\n\n\n\n\n\n\n\n\n\n\n#\nAula\nDuração\n\n\n\n\n1\nValor presente de um fluxo de caixa\n10:01\n\n\n2\nValor presente de um fluxo de caixa com múltiplos pagamentos\n20:10\n\n\n3\nTIR - Taxa Interna de Retorno\n17:32"
  },
  {
    "objectID": "rendafixa.html#módulo-4-precificação-de-instrumentos-de-renda-fixa-pré-fixados",
    "href": "rendafixa.html#módulo-4-precificação-de-instrumentos-de-renda-fixa-pré-fixados",
    "title": "Renda Fixa usando R",
    "section": "Módulo 4: Precificação de Instrumentos de Renda Fixa Pré-fixados",
    "text": "Módulo 4: Precificação de Instrumentos de Renda Fixa Pré-fixados\nBullet Bonds Pré-fixados: LTN, CDB Bonds Pré-fixados: NTN-F\n\n\n\nDuração: 01:19:09\n\n\n\n\n\n#\nAula\nDuração\n\n\n\n\n1\nInstrumentos de Renda Fixa disponíveis no mercado\n16:23\n\n\n2\nCDB e LC prefixados\n32:16\n\n\n3\nLTN - Tesouro Prefixado\n14:37\n\n\n4\nNTN-F - Tesouro Prefixado com Juros Semestrais\n15:52"
  },
  {
    "objectID": "rendafixa.html#módulo-5-precificação-de-instrumentos-de-renda-fixa-indexados",
    "href": "rendafixa.html#módulo-5-precificação-de-instrumentos-de-renda-fixa-indexados",
    "title": "Renda Fixa usando R",
    "section": "Módulo 5: Precificação de Instrumentos de Renda Fixa Indexados",
    "text": "Módulo 5: Precificação de Instrumentos de Renda Fixa Indexados\nBullet Bonds Indexados: NTN-B (Tesouro IPCA Principal) Bonds Indexados: NTN-B (Tesouro IPCA)\n\n\n\nDuração: 01:06:28\n\n\n\n\n\n#\nAula\nDuração\n\n\n\n\n1\nInstrumentos de Renda Fixa Indexados\n11:22\n\n\n2\nVNA - Valor Nominal Atualizado\n23:38\n\n\n3\nNTN-B Principal - Tesouro IPCA+\n20:50\n\n\n4\nNTN-B - Tesouro IPCA+ com Juros Semestrais\n10:37"
  },
  {
    "objectID": "rendafixa.html#módulo-6-curva-de-juros---estrutura-a-termo-de-taxas-de-juros-ettj",
    "href": "rendafixa.html#módulo-6-curva-de-juros---estrutura-a-termo-de-taxas-de-juros-ettj",
    "title": "Renda Fixa usando R",
    "section": "Módulo 6: Curva de Juros - Estrutura a Termo de Taxas de Juros (ETTJ)",
    "text": "Módulo 6: Curva de Juros - Estrutura a Termo de Taxas de Juros (ETTJ)\nTaxas à vista Taxas a termo\n\n\n\nDuração: 00:59:11\n\n\n\n\n\n\n\n\n\n\n#\nAula\nDuração\n\n\n\n\n1\nCurva de Juros Prefixados\n33:06\n\n\n2\nTaxas a termo na Curva de Juros Prefixados\n14:19\n\n\n3\nExtraindo expectativas do COPOM da Curva de Juros Prefixados\n11:45"
  },
  {
    "objectID": "rendafixa.html#módulo-7-interpolação-da-estrutura-a-termo-de-taxas-de-juros-ettj",
    "href": "rendafixa.html#módulo-7-interpolação-da-estrutura-a-termo-de-taxas-de-juros-ettj",
    "title": "Renda Fixa usando R",
    "section": "Módulo 7: Interpolação da Estrutura a Termo de Taxas de Juros (ETTJ)",
    "text": "Módulo 7: Interpolação da Estrutura a Termo de Taxas de Juros (ETTJ)\nInterpolação Linear Interpolação Flat-forward Interpolação Spline\n\n\n\nDuração: 00:56:23\n\n\n\n\n\n#\nAula\nDuração\n\n\n\n\n1\nInterpolação Linear\n25:23\n\n\n2\nInterpolação FlatForward\n14:10\n\n\n3\nInterpolação Spline Cúbico Natural\n08:54\n\n\n4\nComparando métodos de interpolação\n07:54"
  },
  {
    "objectID": "rendafixa.html#módulo-8-precificação-de-instrumentos-de-renda-fixa-pós-fixados",
    "href": "rendafixa.html#módulo-8-precificação-de-instrumentos-de-renda-fixa-pós-fixados",
    "title": "Renda Fixa usando R",
    "section": "Módulo 8: Precificação de Instrumentos de Renda Fixa Pós-fixados",
    "text": "Módulo 8: Precificação de Instrumentos de Renda Fixa Pós-fixados\nBullet Bonds Pós-fixados: LFT, CDB CDI + taxa, CDB %CDI\n\n\n\nDuração: 01:20:43\n\n\n\n\n\n\n\n\n\n\n#\nAula\nDuração\n\n\n\n\n1\nLFT - Tesouro SELIC\n18:06\n\n\n2\nRentabilidade da LFT\n14:29\n\n\n3\nCDB pós-fixado\n15:19\n\n\n4\nAvaliação de arbitragem entre CDBs prefixados e pós-fixados\n12:14\n\n\n5\nAvaliação de arbitragem entre CDBs e LCI/LCA\n20:33"
  },
  {
    "objectID": "rendafixa.html#módulo-9-precificação-de-instrumentos-de-renda-fixa-com-amortização-debêntures",
    "href": "rendafixa.html#módulo-9-precificação-de-instrumentos-de-renda-fixa-com-amortização-debêntures",
    "title": "Renda Fixa usando R",
    "section": "Módulo 9: Precificação de Instrumentos de Renda Fixa com Amortização (Debêntures)",
    "text": "Módulo 9: Precificação de Instrumentos de Renda Fixa com Amortização (Debêntures)\nBonds Pré-fixados Com Amortização Bonds Indexados Com Amortização Bonds Pós-fixados Com Amortização\n\n\n\nDuração: 01:10:09\n\n\n\n\n\n#\nAula\nDuração\n\n\n\n\n1\nDebêntures\n09:06\n\n\n2\nDownload de dados de Debêntures com API CALC da B3\n05:57\n\n\n3\nDebêntures Prefixadas 1\n09:42\n\n\n4\nDebêntures Prefixadas 2\n10:36\n\n\n5\nDebêntures Pós-fixadas\n10:28\n\n\n6\nDebêntures Indexadas 1\n08:51\n\n\n7\nDebêntures Indexadas 2\n15:25\n\n\n\n\n\n\n Link para o Curso"
  },
  {
    "objectID": "shinyapps.html",
    "href": "shinyapps.html",
    "title": "Shinyapps",
    "section": "",
    "text": "Shinyapp para visualização da curva de juros prefixados extraída dos contratos futuros de taxa DI (DI1).\n\nLink\n\nAvalia-se:\n\nCurva de Juros Prefixados com um horizonte de 2 anos para uma data específica\n\nTaxas de juros a termo entre os vértices da curva\n\nExpectativas de taxas de juros nas reuniões do COPOM\nComparação de Curva de Juros Prefixados em diferentes datas"
  },
  {
    "objectID": "shinyapps.html#opapp",
    "href": "shinyapps.html#opapp",
    "title": "Shinyapps",
    "section": "OpApp",
    "text": "OpApp\nShinyapp para visualização de dados de opções de ações.\n\nLink\n\nAvalia-se:\n\nDados de opções de ações, volatilidade implícita e gregas\nGráfico de Volatilidade Implícita\nAjuste do modelo de Corrado-Su para os preços de opções e visualização das volatilidades pelo modelo"
  },
  {
    "objectID": "shinyapps.html#stock-analysis",
    "href": "shinyapps.html#stock-analysis",
    "title": "Shinyapps",
    "section": "Stock Analysis",
    "text": "Stock Analysis\nShinyapp para análise de ações com informações de retornos, volatilidade e análise de risco.\n\nLink\n\nAvalia-se:\n\nRetornos de uma ação para diversas janelas de tempo\n\nDrawdown\n\nVolatilidade de uma ação com o modelo GARCH(1,1)\nAnálise de Risco"
  },
  {
    "objectID": "python.html#regexparser",
    "href": "python.html#regexparser",
    "title": "Projetos em Python",
    "section": "regexparser📦",
    "text": "regexparser📦\nUm simples parser de texto baseado em expressões regulares. Frequentemente preciso fazer o parsing de texto em inteiros, decimais, datas, e outros formatos. Isso levava a muita duplicação de código, de forma que criei esse pequeno módulo onde posso centralizar todos os parsers que preciso em uma estrutura que me permite, utilizando expressões regulares, criar uma hierarquia para a realização dos parsers.\n\nRepositório"
  }
]