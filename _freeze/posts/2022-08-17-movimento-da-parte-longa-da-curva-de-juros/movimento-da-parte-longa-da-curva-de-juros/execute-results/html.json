{
  "hash": "7d3035f53b4a9f3f1a6b60f03e25ddcb",
  "result": {
    "markdown": "---\ntitle: \"Movimento da Parte Longa da Curva de Juros\"\ndescription: |\n  A reuni√£o do COPOM no come√ßo do m√™s de agosto de 2022 trouxe um tom que\n  influenciou a din√¢mica da parte longa da curva de juros.\n  Aqui apresento uma anima√ß√£o do movimento da curva de juros nas duas primeiras semanas de agosto\n  de 2022.\nauthor:\n  - name: Wilson Freitas\n    url: {}\ndate: 2022-08-17\ncategories:\n  - R\n  - fixedincome\n  - rb3\n  - opendata\npreview: animation.gif\n---\n\n\n\n\nA reuni√£o do COPOM de 3 de agosto trouxe uma mudan√ßa na estrutura da curva de juros,\ntanto para a parte curta como para a parte longa.\nA interpreta√ß√£o do comunicado por agentes de mercado √© de o ciclo de alta de juros est√°\npr√≥ximo do fim.\n\nNa pr√°tica a din√¢mica da parte longa da curva de juros foi bastante afetada.\nAqui apresento uma anima√ß√£o onde observa-se o movimento da curva de juros nas duas primeiras\nsemanas do m√™s de agosto de 2022.\nA reuni√£o do COPOM aconteceu em 3 de agosto.\nFica claro pela anima√ß√£o a mudan√ßa nas expectativas de longo prazo para a curva.\n\nVamos utilizar o üì¶ {rb3} para obter as curvas e o üì¶ {fixedincome} na constru√ß√£o dos gr√°ficos\nda estrutura a termo de juros.\nA anima√ß√£o √© construida com o üì¶ {animation}.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(fixedincome)\nlibrary(rb3)\nlibrary(bizdays)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'bizdays'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:stats':\n\n    offset\n```\n:::\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:fixedincome':\n\n    first, last\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\nget_di1_curve <- function(refdate) {\n  fut <- futures_get(refdate)\n  yc <- yc_get(refdate)\n  df <- yc_superset(yc, fut)\n\n  df_curve <- bind_rows(\n    df |> slice(1) |> select(biz_days, r_252),\n    df |> filter(!is.na(symbol)) |> select(biz_days, r_252)\n  ) |>\n    filter(!duplicated(biz_days))\n\n  spotratecurve(\n    df_curve$r_252, df_curve$biz_days, \"discrete\", \"business/252\", \"Brazil/ANBIMA\",\n    refdate = refdate\n  )\n}\n```\n:::\n\n\nVamos obter as curvas para os dias √∫teis entre 2022-08-01 e 2022-08-16 e coloc√°-las em uma lista.\nNa sequ√™ncia a anima√ß√£o ser√° constru√≠da com cada uma das curvas da lista, sendo que a primeira curva\ntem a cor vermelha e a √∫ltima tem cor azul, as demais curvas s√£o em cinza.\nO objetivo √© acompanhar a evolu√ß√£o das curvas tendo em destaque o come√ßo e fim.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndates <- bizseq(\"2022-08-01\", \"2022-08-16\", \"Brazil/ANBIMA\")\ncurves <- lapply(seq_along(dates), function(ix) get_di1_curve(dates[ix]))\n\nanim <- animation::saveGIF(\n  {\n    g <- autoplot(curves[[1]], curve.x.axis = \"terms\", colour = \"red\") +\n      autolayer(curves[[1]], curve.geom = \"point\", curve.x.axis = \"terms\", colour = \"red\") +\n      ylim(0.11, 0.14) +\n      theme_bw() +\n      theme(legend.position = \"none\") +\n      labs(\n        x = \"Prazos\", y = NULL, title = \"Curvas de Juros Prefixados DI1\",\n        subtitle = \"Entre as datas 2022-08-01 e 2022-08-16\",\n        caption = \"Desenvolvido por wilsonfreitas / Fonte: B3\"\n      )\n    print(g)\n\n    for(curve in curves[-c(1, length(curves))]) {\n      g <- g + autolayer(curve, curve.x.axis = \"terms\", colour = \"grey\") +\n        autolayer(curve,\n          curve.geom = \"point\", curve.x.axis = \"terms\", colour = \"grey\"\n        )\n      print(g)\n    }\n\n    g <- g + autolayer(curves[[length(curves)]], curve.x.axis = \"terms\", colour = \"blue\") +\n      autolayer(curves[[length(curves)]],\n        curve.geom = \"point\", curve.x.axis = \"terms\", colour = \"blue\"\n      )\n    print(g)\n  },\n  interval = 0.8,\n  ani.height = 400,\n  ani.width = 704\n)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nOutput at: animation.gif\n```\n:::\n:::\n\n\n![](animation.gif)\n",
    "supporting": [
      "movimento-da-parte-longa-da-curva-de-juros_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}